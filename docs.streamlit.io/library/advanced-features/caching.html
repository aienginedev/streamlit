<!DOCTYPE html><html>
<!-- Mirrored from docs.streamlit.io/library/advanced-features/caching by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 29 Aug 2023 12:31:13 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Caching - Streamlit Docs</title><link rel="icon" href="../../favicon.svg"/><link rel="alternate icon" href="../../favicon32.ico"/><meta name="theme-color" content="#ffffff"/><link rel="canonical" href="caching.html"/><meta content="Caching - Streamlit Docs" property="og:title"/><meta content="Caching - Streamlit Docs" name="twitter:title"/><meta property="og:type" content="website"/><meta property="og:url" content="../../index.html"/><meta content="summary_large_image" name="twitter:card"/><meta property="og:image" content="../../sharing-image-facebook.jpg"/><meta name="twitter:image" content="../../sharing-image-twitter.jpg"/><meta name="next-head-count" content="14"/><link rel="preload" href="../../_next/static/css/99e293e1eb50d1b8.css" as="style"/><link rel="stylesheet" href="../../_next/static/css/99e293e1eb50d1b8.css" data-n-g=""/><link rel="preload" href="../../_next/static/css/dec0cac3be54a6e1.css" as="style"/><link rel="stylesheet" href="../../_next/static/css/dec0cac3be54a6e1.css" data-n-p=""/><link rel="preload" href="../../_next/static/css/4f00e8776966edc1.css" as="style"/><link rel="stylesheet" href="../../_next/static/css/4f00e8776966edc1.css" data-n-p=""/><link rel="preload" href="../../_next/static/css/afcabbb34c921b6b.css" as="style"/><link rel="stylesheet" href="../../_next/static/css/afcabbb34c921b6b.css" data-n-p=""/><link rel="preload" href="../../_next/static/css/a5f7343541dc677e.css" as="style"/><link rel="stylesheet" href="../../_next/static/css/a5f7343541dc677e.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="../../_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="../../_next/static/chunks/webpack-73a39f2f67411f76.js" defer=""></script><script src="../../_next/static/chunks/framework-f8115f7fae64930e.js" defer=""></script><script src="../../_next/static/chunks/main-478b2e98a6bc99a4.js" defer=""></script><script src="../../_next/static/chunks/pages/_app-4ab4b652597fde98.js" defer=""></script><script src="../../_next/static/chunks/fec483df-7642bc13acfc425e.js" defer=""></script><script src="../../_next/static/chunks/77821-f4b4a5ac001caeef.js" defer=""></script><script src="../../_next/static/chunks/16164-6cc9dfeb7211f6ef.js" defer=""></script><script src="../../_next/static/chunks/84755-8d2f81122b82b9a8.js" defer=""></script><script src="../../_next/static/chunks/71506-787fb062d5284a8c.js" defer=""></script><script src="../../_next/static/chunks/16465-a648ae1e17a8ab0b.js" defer=""></script><script src="../../_next/static/chunks/39258-b77ebc6c17f35d1d.js" defer=""></script><script src="../../_next/static/chunks/29582-17692493bff8457c.js" defer=""></script><script src="../../_next/static/chunks/79990-d3132ecbac9f2388.js" defer=""></script><script src="../../_next/static/chunks/pages/%5b...slug%5d-c5a90f73cd2e35b7.js" defer=""></script><script src="../../_next/static/t8wfB6M0Aybn18P6aNrje/_buildManifest.js" defer=""></script><script src="../../_next/static/t8wfB6M0Aybn18P6aNrje/_ssgManifest.js" defer=""></script><script src="../../_next/static/t8wfB6M0Aybn18P6aNrje/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><main id="root" class="dark:bg-gray-100"><header class="header_Container__FfyMX header_standardContainer__q78nH"><nav class="header_Navigation__vCS2x" id="main-header"><a class="header_LogoContainer__l57zq not-link" href="../../index.html"><img src="../../logo.svg" alt=""/><h4 class="header_LogoText__VPKlK">Documentation</h4></a><section class="header_NavigationContainer__7P86G"><section class="search_SearchBarContainer__R6lrR"><section class="group search_SearchBar__06BwO"><i class="search_SearchIcon__jQoC1" style="transform:rotateY(180deg)">search</i><p class="search_SearchText__mHmhV">Search</p></section></section></section></nav></header><div><section class="container_Container___G6N_"><section class="sideBar_Container__ihGfR sideBar_ClosedNav__1MFNg sideBar_CollapsedNav__pEYSt"><div class="sideBar_TopGradient__1IuC_"></div><nav><ul class="sideBar_NavList__U6cpU"><li class="navItem_NavItem__ApcKe" id="streamlit-library"><a href="../get-started.html" class="not-link"><section class="navItem_HeadingContainer__JBzsM"><div class="navItem_HeadingIconContainer__ABBX1 navItem_LibraryIcon__3PAjf"><i class="navItem_Icon__wRJ_K">description</i></div><p class="navItem_CategoryName__8ILNs navItem_LibraryCategory__mt7RI">Streamlit library</p></section></a><ul class="navItem_SubNav__GUy5S navItem_ExpandedSubNav__UPS5S"><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="../get-started.html"><span class="navChild_Circle__1qcbH navChild_LibraryCircle__IyC4S"></span><span class="navChild_PageName__N8Q5l">Get started</span></a><div class="navChild_Accordion__KuAkH"><i class="navChild_AccordionIcon__TMYJv open">add</i></div></span></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="../api-reference.html"><span class="navChild_Circle__1qcbH navChild_LibraryCircle__IyC4S"></span><span class="navChild_PageName__N8Q5l">API reference</span></a><div class="navChild_Accordion__KuAkH"><i class="navChild_AccordionIcon__TMYJv open">add</i></div></span></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="../advanced-features.html"><span class="navChild_Circle__1qcbH navChild_LibraryCircle__IyC4S"></span><span class="navChild_PageName__N8Q5l">Advanced features</span></a><div class="navChild_Accordion__KuAkH"><i class="navChild_AccordionIcon__TMYJv close">remove</i></div></span><ul class="navChild_List__U7Y10"><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="app-menu.html"><span class="navChild_Circle__1qcbH navChild_LibraryCircle__IyC4S"></span><span class="navChild_PageName__N8Q5l">â‹® App menu</span></a></span></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="button-behavior-and-examples.html"><span class="navChild_Circle__1qcbH navChild_LibraryCircle__IyC4S"></span><span class="navChild_PageName__N8Q5l">Button behavior and examples</span></a></span></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="caching.html"><span class="navChild_Circle__1qcbH navChild_ActiveCircle__MeXVa navChild_LibraryCircle__IyC4S"></span><span class="navChild_PageName__N8Q5l navChild_ActivePage__AifsG">Caching</span></a></span></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="cli.html"><span class="navChild_Circle__1qcbH navChild_LibraryCircle__IyC4S"></span><span class="navChild_PageName__N8Q5l">Command-line options</span></a></span></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="configuration.html"><span class="navChild_Circle__1qcbH navChild_LibraryCircle__IyC4S"></span><span class="navChild_PageName__N8Q5l">Configuration</span></a></span></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="theming.html"><span class="navChild_Circle__1qcbH navChild_LibraryCircle__IyC4S"></span><span class="navChild_PageName__N8Q5l">Theming</span></a></span></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="connecting-to-data.html"><span class="navChild_Circle__1qcbH navChild_LibraryCircle__IyC4S"></span><span class="navChild_PageName__N8Q5l">Connecting to data</span></a></span></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="dataframes.html"><span class="navChild_Circle__1qcbH navChild_LibraryCircle__IyC4S"></span><span class="navChild_PageName__N8Q5l">Dataframes</span></a></span></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="forms.html"><span class="navChild_Circle__1qcbH navChild_LibraryCircle__IyC4S"></span><span class="navChild_PageName__N8Q5l">Forms</span></a></span></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="session-state.html"><span class="navChild_Circle__1qcbH navChild_LibraryCircle__IyC4S"></span><span class="navChild_PageName__N8Q5l">Add statefulness to apps</span></a></span></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="widget-semantics.html"><span class="navChild_Circle__1qcbH navChild_LibraryCircle__IyC4S"></span><span class="navChild_PageName__N8Q5l">Widget semantics</span></a></span></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="prerelease.html"><span class="navChild_Circle__1qcbH navChild_LibraryCircle__IyC4S"></span><span class="navChild_PageName__N8Q5l">Pre-release features</span></a></span></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="timezone-handling.html"><span class="navChild_Circle__1qcbH navChild_LibraryCircle__IyC4S"></span><span class="navChild_PageName__N8Q5l">Working with timezones</span></a></span></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="static-file-serving.html"><span class="navChild_Circle__1qcbH navChild_LibraryCircle__IyC4S"></span><span class="navChild_PageName__N8Q5l">Static file serving</span></a></span></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="https-support.html"><span class="navChild_Circle__1qcbH navChild_LibraryCircle__IyC4S"></span><span class="navChild_PageName__N8Q5l">HTTPS support</span></a></span></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="secrets-management.html"><span class="navChild_Circle__1qcbH navChild_LibraryCircle__IyC4S"></span><span class="navChild_PageName__N8Q5l">Secrets management</span></a></span></li></ul></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="../components.html"><span class="navChild_Circle__1qcbH navChild_LibraryCircle__IyC4S"></span><span class="navChild_PageName__N8Q5l">Components</span></a><div class="navChild_Accordion__KuAkH"><i class="navChild_AccordionIcon__TMYJv open">add</i></div></span></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" target="_blank" href="https://roadmap.streamlit.app/"><span class="navChild_Circle__1qcbH navChild_LibraryCircle__IyC4S"></span><span class="navChild_PageName__N8Q5l">Roadmap</span><i class="navChild_ExternalIcon__T3Tns">open_in_new</i></a></span></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="../changelog.html"><span class="navChild_Circle__1qcbH navChild_LibraryCircle__IyC4S"></span><span class="navChild_PageName__N8Q5l">Changelog</span></a></span></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="../cheatsheet.html"><span class="navChild_Circle__1qcbH navChild_LibraryCircle__IyC4S"></span><span class="navChild_PageName__N8Q5l">Cheat sheet</span></a></span></li></ul></li><li class="navItem_NavItem__ApcKe" id="streamlit-community-cloud"><a class="not-link" href="../../streamlit-community-cloud.html"><section class="navItem_HeadingContainer__JBzsM"><div class="navItem_HeadingIconContainer__ABBX1 navItem_CloudIcon__DZsn_"><i class="navItem_Icon__wRJ_K">cloud</i></div><p class="navItem_CategoryName__8ILNs">Streamlit Community Cloud</p></section></a><ul class="navItem_SubNav__GUy5S navItem_ExpandedSubNav__UPS5S"><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="../../streamlit-community-cloud/get-started.html"><span class="navChild_Circle__1qcbH navChild_CloudCircle__tknZK"></span><span class="navChild_PageName__N8Q5l">Get started</span></a><div class="navChild_Accordion__KuAkH"><i class="navChild_AccordionIcon__TMYJv open">add</i></div></span></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="../../streamlit-community-cloud/deploy-your-app.html"><span class="navChild_Circle__1qcbH navChild_CloudCircle__tknZK"></span><span class="navChild_PageName__N8Q5l">Deploy your app</span></a><div class="navChild_Accordion__KuAkH"><i class="navChild_AccordionIcon__TMYJv open">add</i></div></span></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="../../streamlit-community-cloud/manage-your-app.html"><span class="navChild_Circle__1qcbH navChild_CloudCircle__tknZK"></span><span class="navChild_PageName__N8Q5l">Manage your app</span></a><div class="navChild_Accordion__KuAkH"><i class="navChild_AccordionIcon__TMYJv open">add</i></div></span></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="../../streamlit-community-cloud/share-your-app.html"><span class="navChild_Circle__1qcbH navChild_CloudCircle__tknZK"></span><span class="navChild_PageName__N8Q5l">Share your app</span></a><div class="navChild_Accordion__KuAkH"><i class="navChild_AccordionIcon__TMYJv open">add</i></div></span></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="../../streamlit-community-cloud/manage-your-account.html"><span class="navChild_Circle__1qcbH navChild_CloudCircle__tknZK"></span><span class="navChild_PageName__N8Q5l">Manage your account</span></a><div class="navChild_Accordion__KuAkH"><i class="navChild_AccordionIcon__TMYJv open">add</i></div></span></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="../../streamlit-community-cloud/troubleshooting.html"><span class="navChild_Circle__1qcbH navChild_CloudCircle__tknZK"></span><span class="navChild_PageName__N8Q5l">Troubleshooting</span></a></span></li></ul></li><li class="navItem_NavItem__ApcKe" id="knowledge-base"><a class="not-link" href="../../knowledge-base.html"><section class="navItem_HeadingContainer__JBzsM"><div class="navItem_HeadingIconContainer__ABBX1 navItem_KBIcon__BIed4"><i class="navItem_Icon__wRJ_K">school</i></div><p class="navItem_CategoryName__8ILNs">Knowledge base</p></section></a><ul class="navItem_SubNav__GUy5S navItem_ExpandedSubNav__UPS5S"><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="../../knowledge-base/tutorials.html"><span class="navChild_Circle__1qcbH navChild_KBCircle__sDGh0"></span><span class="navChild_PageName__N8Q5l">Tutorials</span></a><div class="navChild_Accordion__KuAkH"><i class="navChild_AccordionIcon__TMYJv open">add</i></div></span></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="../../knowledge-base/using-streamlit.html"><span class="navChild_Circle__1qcbH navChild_KBCircle__sDGh0"></span><span class="navChild_PageName__N8Q5l">Using Streamlit</span></a></span></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="../../knowledge-base/components.html"><span class="navChild_Circle__1qcbH navChild_KBCircle__sDGh0"></span><span class="navChild_PageName__N8Q5l">Streamlit Components</span></a></span></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="../../knowledge-base/dependencies.html"><span class="navChild_Circle__1qcbH navChild_KBCircle__sDGh0"></span><span class="navChild_PageName__N8Q5l">Installing dependencies</span></a></span></li><li class="navChild_Container__uzY5D"><span class="navChild_LinkContainer__90x_e"><a class="not-link navChild_Link__AeMWY" href="../../knowledge-base/deploy.html"><span class="navChild_Circle__1qcbH navChild_KBCircle__sDGh0"></span><span class="navChild_PageName__N8Q5l">Deployment issues</span></a></span></li></ul></li></ul></nav></section><section class="container_InnerContainer__gGy_B" id="documentation"><nav><ul class="breadCrumbs_Container__U1ZzL"><li class="breadCrumbs_InnerContainer__zgJpb"><a class="not-link breadCrumbs_Link__baMKw" href="../../index.html">Home</a><span class="breadCrumbs_Separator__RsOPw">/</span></li><li class="breadCrumbs_InnerContainer__zgJpb"><a class="not-link breadCrumbs_Link__baMKw" href="../get-started.html">Streamlit library</a><span class="breadCrumbs_Separator__RsOPw">/</span></li><li class="breadCrumbs_InnerContainer__zgJpb"><a class="not-link breadCrumbs_Link__baMKw" href="../advanced-features.html">Advanced features</a><span class="breadCrumbs_Separator__RsOPw">/</span></li><li class="breadCrumbs_InnerContainer__zgJpb"><a class="not-link breadCrumbs_ActiveLink__uZVVw breadCrumbs_Link__baMKw" href="caching.html">Caching</a></li></ul></nav><article id="content-container" class="leaf-page container_ArticleContainer__P0WuI"><div class="content container_ContentContainer__3105j"><section class="callout_Container__IU_XU note_Note__d8Rsn"><section class="iconHeader_Container__w4_WA"><i class="iconHeader_Icon__X6Kz_ iconHeader_LightBlueBackground__WINgP" style="transform:rotate(45deg)">push_pin</i><h4 class="iconHeader_Title__vFC9I iconHeader_LightBlueText__XIICP">Note</h4></section><p>Documentation for the deprecated <code>@st.cache</code> decorator can be found in <a href="st.html">Optimize performance with st.cache</a>.</p></section><a name="caching" class="headerLink_HashLink___Wih5"></a><h1 class="headerLink_HeaderContainer__68tak group"><a aria-hidden="true" tabindex="-1" href="#caching"><span class="icon icon-link"></span></a>Caching<div class="headerLink_CopyLink__Lvpqb"><svg width="14" height="17" viewBox="0 0 14 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.7548 0.0313721C10.7051 0.0194702 10.6571 0.00793457 10.609 0H9.87278C9.83686 0.0178223 9.81891 0.0356445 9.783 0.0356445C9.20842 0.124878 8.70565 0.374573 8.29268 0.784851L4.14488 4.90521C3.57029 5.47601 3.283 6.18951 3.31892 7.01001C3.33686 7.38464 3.42665 7.74133 3.60621 8.09808L4.43217 7.27759C4.46809 7.25977 4.46809 7.18842 4.46809 7.15271C4.41421 6.59979 4.57582 6.11816 4.97085 5.72577L8.54405 2.17615L9.13659 1.58752C9.76504 0.998901 10.7167 0.998901 11.3452 1.58752C12.0095 2.21179 12.0095 3.2464 11.3452 3.90637L7.25123 7.97327C6.8562 8.36566 6.38936 8.54401 5.83273 8.49054C5.77885 8.47266 5.72499 8.47272 5.68908 8.50836L4.86311 9.32886C4.95289 9.36456 5.00676 9.40021 5.06062 9.41803C6.15593 9.81049 7.17941 9.66779 8.02333 8.84729C9.45979 7.45599 10.8783 6.06464 12.2609 4.6377C13.7333 3.12152 12.9971 0.606445 10.9501 0.0713501C10.8805 0.0614624 10.8164 0.0461426 10.7548 0.0313721ZM7.34082 7.47388C7.62811 7.2063 7.9154 6.9209 8.20269 6.6355C8.18016 6.62988 8.16114 6.62427 8.14401 6.6192C8.10655 6.60822 8.07805 6.59985 8.04109 6.59985C7.03556 6.15393 5.83253 6.3501 5.04246 7.11713C3.606 8.52625 2.1875 9.93542 0.768994 11.3624C0.14053 11.9867 -0.0928837 12.7715 0.032803 13.6277C0.194409 14.7515 0.840817 15.5184 1.9002 15.8752C2.97755 16.2319 3.94717 16.0001 4.75517 15.2152C5.6766 14.3118 6.59005 13.4004 7.50616 12.4864C7.96467 12.0289 8.42384 11.5708 8.88501 11.1127C9.56733 10.4348 9.81871 9.61432 9.67506 8.66895C9.63916 8.41925 9.56733 8.16949 9.42369 7.9198C9.13639 8.2052 8.8491 8.47272 8.57975 8.75812C8.54385 8.776 8.54385 8.84735 8.54385 8.90082C8.61567 9.41809 8.47203 9.8819 8.09495 10.2565C6.71235 11.6478 5.31181 13.0391 3.91125 14.4125C3.51623 14.8228 2.99551 14.9655 2.43889 14.8406C1.81042 14.6979 1.4154 14.3234 1.23584 13.7347C1.05629 13.1282 1.19993 12.5753 1.64882 12.1294C2.34011 11.4337 3.03141 10.747 3.72271 10.0603C4.41401 9.37354 5.10531 8.68677 5.79661 7.99115C6.17369 7.59869 6.65849 7.45599 7.19717 7.50952C7.25103 7.50952 7.3049 7.50952 7.34082 7.47388Z" fill="#808495"></path></svg></div></h1><p>Streamlit runs your script from top to bottom at every user interaction or code change. This execution model makes development super easy. But it comes with two major challenges:</p><ol><li>Long-running functions run again and again, which slows down your app.</li><li>Objects get recreated again and again, which makes it hard to persist them across reruns or sessions.</li></ol><p>But don&#x27;t worry! Streamlit lets you tackle both issues with its built-in caching mechanism. Caching stores the results of slow function calls, so they only need to run once. This makes your app much faster and helps with persisting objects across reruns.</p><section class="collapse_Container__e97us"><div class="collapse_PanelHeading__udR5s"><summary class="collapse_PanelTitle__egjrE"><span class="collapse_Title__4Eeka">Table of contents</span><i class="collapse_PanelIcon__26R3K collapse_RotatedIcon__4LRPl">expand_more</i></summary><div class="collapse_PanelContent__UoTDn collapse_PanelVisible__C5HEM"><ol><li><a href="#minimal-example">Minimal example</a></li><li><a href="#basic-usage">Basic usage</a></li><li><a href="#advanced-usage">Advanced usage</a></li><li><a href="#migrating-from-stcache">Migrating from st.cache</a></li></ol></div></div></section><a name="minimal-example" class="headerLink_HashLink___Wih5"></a><h2 class="headerLink_HeaderContainer__68tak group"><a aria-hidden="true" tabindex="-1" href="#minimal-example"><span class="icon icon-link"></span></a>Minimal example<div class="headerLink_CopyLink__Lvpqb"><svg width="14" height="17" viewBox="0 0 14 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.7548 0.0313721C10.7051 0.0194702 10.6571 0.00793457 10.609 0H9.87278C9.83686 0.0178223 9.81891 0.0356445 9.783 0.0356445C9.20842 0.124878 8.70565 0.374573 8.29268 0.784851L4.14488 4.90521C3.57029 5.47601 3.283 6.18951 3.31892 7.01001C3.33686 7.38464 3.42665 7.74133 3.60621 8.09808L4.43217 7.27759C4.46809 7.25977 4.46809 7.18842 4.46809 7.15271C4.41421 6.59979 4.57582 6.11816 4.97085 5.72577L8.54405 2.17615L9.13659 1.58752C9.76504 0.998901 10.7167 0.998901 11.3452 1.58752C12.0095 2.21179 12.0095 3.2464 11.3452 3.90637L7.25123 7.97327C6.8562 8.36566 6.38936 8.54401 5.83273 8.49054C5.77885 8.47266 5.72499 8.47272 5.68908 8.50836L4.86311 9.32886C4.95289 9.36456 5.00676 9.40021 5.06062 9.41803C6.15593 9.81049 7.17941 9.66779 8.02333 8.84729C9.45979 7.45599 10.8783 6.06464 12.2609 4.6377C13.7333 3.12152 12.9971 0.606445 10.9501 0.0713501C10.8805 0.0614624 10.8164 0.0461426 10.7548 0.0313721ZM7.34082 7.47388C7.62811 7.2063 7.9154 6.9209 8.20269 6.6355C8.18016 6.62988 8.16114 6.62427 8.14401 6.6192C8.10655 6.60822 8.07805 6.59985 8.04109 6.59985C7.03556 6.15393 5.83253 6.3501 5.04246 7.11713C3.606 8.52625 2.1875 9.93542 0.768994 11.3624C0.14053 11.9867 -0.0928837 12.7715 0.032803 13.6277C0.194409 14.7515 0.840817 15.5184 1.9002 15.8752C2.97755 16.2319 3.94717 16.0001 4.75517 15.2152C5.6766 14.3118 6.59005 13.4004 7.50616 12.4864C7.96467 12.0289 8.42384 11.5708 8.88501 11.1127C9.56733 10.4348 9.81871 9.61432 9.67506 8.66895C9.63916 8.41925 9.56733 8.16949 9.42369 7.9198C9.13639 8.2052 8.8491 8.47272 8.57975 8.75812C8.54385 8.776 8.54385 8.84735 8.54385 8.90082C8.61567 9.41809 8.47203 9.8819 8.09495 10.2565C6.71235 11.6478 5.31181 13.0391 3.91125 14.4125C3.51623 14.8228 2.99551 14.9655 2.43889 14.8406C1.81042 14.6979 1.4154 14.3234 1.23584 13.7347C1.05629 13.1282 1.19993 12.5753 1.64882 12.1294C2.34011 11.4337 3.03141 10.747 3.72271 10.0603C4.41401 9.37354 5.10531 8.68677 5.79661 7.99115C6.17369 7.59869 6.65849 7.45599 7.19717 7.50952C7.25103 7.50952 7.3049 7.50952 7.34082 7.47388Z" fill="#808495"></path></svg></div></h2><p>To cache a function in Streamlit, you must decorate it with one of two decorators (<code>st.cache_data</code> or <code>st.cache_resource</code>):</p><section class="code_Container__v4rq_"><pre><code class="language-python">@st.cache_data
def long_running_function(param1, param2):
    return â€¦
</code></pre></section><p>In this example, decorating <code>long_running_function</code> with <code>@st.cache_data</code> tells Streamlit that whenever the function is called, it checks two things:</p><ol><li>The values of the input parameters (in this case, <code>param1</code> and <code>param2</code>).</li><li>The code inside the function.</li></ol><p>If this is the first time Streamlit sees these parameter values and function code, it runs the function and stores the return value in a cache. The next time the function is called with the same parameters and code (e.g., when a user interacts with the app), Streamlit will skip executing the function altogether and return the cached value instead. During development, the cache updates automatically as the function code changes, ensuring that the latest changes are reflected in the cache.</p><p>As mentioned, there are two caching decorators:</p><ul><li><code>st.cache_data</code>Â is the recommended way to cache computations that return data: loading a DataFrame from CSV, transforming a NumPy array, querying an API, or any other function that returns a serializable data object (str, int, float, DataFrame, array, list, â€¦). It creates a new copy of the data at each function call, making it safe against <a href="#mutation-and-concurrency-issues">mutations and race conditions</a>. The behavior of <code>st.cache_data</code> is what you want in most cases â€“ so if you&#x27;re unsure, start withÂ <code>st.cache_data</code>Â and see if it works!</li><li><code>st.cache_resource</code>Â is the recommended way to cache global resources like ML models or database connections â€“ unserializable objects that you don&#x27;t want to load multiple times. Using it, you can share these resources across all reruns and sessions of an app without copying or duplication. Note that any mutations to the cached return value directly mutate the object in the cache (more details below).</li></ul><section class="image_Container__T51lH"><section class="image_InnerContainer__xOYBM"><img class="has-caption image_Image__PuLQa" src="../../images/caching-high-level-diagram.png" alt="Streamlit&#x27;s two caching decorators and their use cases. Use st.cache_data for anything you&#x27;d store in a database. Use st.cache_resource for anything you can&#x27;t store in a database, like a connection to a database or a machine learning model."/><p class="image_Caption__ITLyB">Streamlit&#x27;s two caching decorators and their use cases.</p></section></section><a name="basic-usage" class="headerLink_HashLink___Wih5"></a><h2 class="headerLink_HeaderContainer__68tak group"><a aria-hidden="true" tabindex="-1" href="#basic-usage"><span class="icon icon-link"></span></a>Basic usage<div class="headerLink_CopyLink__Lvpqb"><svg width="14" height="17" viewBox="0 0 14 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.7548 0.0313721C10.7051 0.0194702 10.6571 0.00793457 10.609 0H9.87278C9.83686 0.0178223 9.81891 0.0356445 9.783 0.0356445C9.20842 0.124878 8.70565 0.374573 8.29268 0.784851L4.14488 4.90521C3.57029 5.47601 3.283 6.18951 3.31892 7.01001C3.33686 7.38464 3.42665 7.74133 3.60621 8.09808L4.43217 7.27759C4.46809 7.25977 4.46809 7.18842 4.46809 7.15271C4.41421 6.59979 4.57582 6.11816 4.97085 5.72577L8.54405 2.17615L9.13659 1.58752C9.76504 0.998901 10.7167 0.998901 11.3452 1.58752C12.0095 2.21179 12.0095 3.2464 11.3452 3.90637L7.25123 7.97327C6.8562 8.36566 6.38936 8.54401 5.83273 8.49054C5.77885 8.47266 5.72499 8.47272 5.68908 8.50836L4.86311 9.32886C4.95289 9.36456 5.00676 9.40021 5.06062 9.41803C6.15593 9.81049 7.17941 9.66779 8.02333 8.84729C9.45979 7.45599 10.8783 6.06464 12.2609 4.6377C13.7333 3.12152 12.9971 0.606445 10.9501 0.0713501C10.8805 0.0614624 10.8164 0.0461426 10.7548 0.0313721ZM7.34082 7.47388C7.62811 7.2063 7.9154 6.9209 8.20269 6.6355C8.18016 6.62988 8.16114 6.62427 8.14401 6.6192C8.10655 6.60822 8.07805 6.59985 8.04109 6.59985C7.03556 6.15393 5.83253 6.3501 5.04246 7.11713C3.606 8.52625 2.1875 9.93542 0.768994 11.3624C0.14053 11.9867 -0.0928837 12.7715 0.032803 13.6277C0.194409 14.7515 0.840817 15.5184 1.9002 15.8752C2.97755 16.2319 3.94717 16.0001 4.75517 15.2152C5.6766 14.3118 6.59005 13.4004 7.50616 12.4864C7.96467 12.0289 8.42384 11.5708 8.88501 11.1127C9.56733 10.4348 9.81871 9.61432 9.67506 8.66895C9.63916 8.41925 9.56733 8.16949 9.42369 7.9198C9.13639 8.2052 8.8491 8.47272 8.57975 8.75812C8.54385 8.776 8.54385 8.84735 8.54385 8.90082C8.61567 9.41809 8.47203 9.8819 8.09495 10.2565C6.71235 11.6478 5.31181 13.0391 3.91125 14.4125C3.51623 14.8228 2.99551 14.9655 2.43889 14.8406C1.81042 14.6979 1.4154 14.3234 1.23584 13.7347C1.05629 13.1282 1.19993 12.5753 1.64882 12.1294C2.34011 11.4337 3.03141 10.747 3.72271 10.0603C4.41401 9.37354 5.10531 8.68677 5.79661 7.99115C6.17369 7.59869 6.65849 7.45599 7.19717 7.50952C7.25103 7.50952 7.3049 7.50952 7.34082 7.47388Z" fill="#808495"></path></svg></div></h2><a name="stcache_data" class="headerLink_HashLink___Wih5"></a><h3 class="headerLink_HeaderContainer__68tak group"><a aria-hidden="true" tabindex="-1" href="#stcache_data"><span class="icon icon-link"></span></a>st.cache_data<div class="headerLink_CopyLink__Lvpqb"><svg width="14" height="17" viewBox="0 0 14 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.7548 0.0313721C10.7051 0.0194702 10.6571 0.00793457 10.609 0H9.87278C9.83686 0.0178223 9.81891 0.0356445 9.783 0.0356445C9.20842 0.124878 8.70565 0.374573 8.29268 0.784851L4.14488 4.90521C3.57029 5.47601 3.283 6.18951 3.31892 7.01001C3.33686 7.38464 3.42665 7.74133 3.60621 8.09808L4.43217 7.27759C4.46809 7.25977 4.46809 7.18842 4.46809 7.15271C4.41421 6.59979 4.57582 6.11816 4.97085 5.72577L8.54405 2.17615L9.13659 1.58752C9.76504 0.998901 10.7167 0.998901 11.3452 1.58752C12.0095 2.21179 12.0095 3.2464 11.3452 3.90637L7.25123 7.97327C6.8562 8.36566 6.38936 8.54401 5.83273 8.49054C5.77885 8.47266 5.72499 8.47272 5.68908 8.50836L4.86311 9.32886C4.95289 9.36456 5.00676 9.40021 5.06062 9.41803C6.15593 9.81049 7.17941 9.66779 8.02333 8.84729C9.45979 7.45599 10.8783 6.06464 12.2609 4.6377C13.7333 3.12152 12.9971 0.606445 10.9501 0.0713501C10.8805 0.0614624 10.8164 0.0461426 10.7548 0.0313721ZM7.34082 7.47388C7.62811 7.2063 7.9154 6.9209 8.20269 6.6355C8.18016 6.62988 8.16114 6.62427 8.14401 6.6192C8.10655 6.60822 8.07805 6.59985 8.04109 6.59985C7.03556 6.15393 5.83253 6.3501 5.04246 7.11713C3.606 8.52625 2.1875 9.93542 0.768994 11.3624C0.14053 11.9867 -0.0928837 12.7715 0.032803 13.6277C0.194409 14.7515 0.840817 15.5184 1.9002 15.8752C2.97755 16.2319 3.94717 16.0001 4.75517 15.2152C5.6766 14.3118 6.59005 13.4004 7.50616 12.4864C7.96467 12.0289 8.42384 11.5708 8.88501 11.1127C9.56733 10.4348 9.81871 9.61432 9.67506 8.66895C9.63916 8.41925 9.56733 8.16949 9.42369 7.9198C9.13639 8.2052 8.8491 8.47272 8.57975 8.75812C8.54385 8.776 8.54385 8.84735 8.54385 8.90082C8.61567 9.41809 8.47203 9.8819 8.09495 10.2565C6.71235 11.6478 5.31181 13.0391 3.91125 14.4125C3.51623 14.8228 2.99551 14.9655 2.43889 14.8406C1.81042 14.6979 1.4154 14.3234 1.23584 13.7347C1.05629 13.1282 1.19993 12.5753 1.64882 12.1294C2.34011 11.4337 3.03141 10.747 3.72271 10.0603C4.41401 9.37354 5.10531 8.68677 5.79661 7.99115C6.17369 7.59869 6.65849 7.45599 7.19717 7.50952C7.25103 7.50952 7.3049 7.50952 7.34082 7.47388Z" fill="#808495"></path></svg></div></h3><p><code>st.cache_data</code> is your go-to command for all functions that return data â€“ whether DataFrames, NumPy arrays, str, int, float, or other serializable types. It&#x27;s the right command for almost all use cases!</p><h4 id="usage"><a aria-hidden="true" tabindex="-1" href="#usage"><span class="icon icon-link"></span></a>Usage</h4><br/><p>Let&#x27;s look at an example of usingÂ <code>st.cache_data</code>. Suppose your app loads the <a href="https://github.com/plotly/datasets/blob/master/uber-rides-data1.csv">Uber ride-sharing dataset</a> â€“ a CSV file of 50 MB â€“ from the internet into a DataFrame:</p><section class="code_Container__v4rq_"><pre><code class="language-python">def load_data(url):
    df = pd.read_csv(url)  # ðŸ‘ˆ Download the data
    return df

df = load_data(&quot;https://github.com/plotly/datasets/raw/master/uber-rides-data1.csv&quot;)
st.dataframe(df)

st.button(&quot;Rerun&quot;)
</code></pre></section><p>Running the <code>load_data</code> function takes 2 to 30 seconds, depending on your internet connection. (Tip: if you are on a slow connection, use <a href="https://github.com/plotly/datasets/blob/master/26k-consumer-complaints.csv">this 5 MB dataset instead</a>). Without caching, the download is rerun each time the app is loaded or with user interaction. Try it yourself by clicking the button we added! Not a great experienceâ€¦ ðŸ˜•</p><p>Now let&#x27;s add theÂ <code>@st.cache_data</code>Â decorator on <code>load_data</code>:</p><section class="code_Container__v4rq_"><pre><code class="language-python">@st.cache_data  # ðŸ‘ˆ Add the caching decorator
def load_data(url):
    df = pd.read_csv(url)
    return df

df = load_data(&quot;https://github.com/plotly/datasets/raw/master/uber-rides-data1.csv&quot;)
st.dataframe(df)

st.button(&quot;Rerun&quot;)
</code></pre></section><p>Run the app again. You&#x27;ll notice that the slow download only happens on the first run. Every subsequent rerun should be almost instant! ðŸ’¨</p><h4 id="behavior"><a aria-hidden="true" tabindex="-1" href="#behavior"><span class="icon icon-link"></span></a>Behavior</h4><br/><p>How does this work? Let&#x27;s go through the behavior of <code>st.cache_data</code> step by step:</p><ul><li>On the first run, Streamlit recognizes that it has never called the <code>load_data</code> function with the specified parameter value (the URL of the CSV file) So it runs the function and downloads the data.</li><li>Now our caching mechanism becomes active: the returned DataFrame is serialized (converted to bytes) viaÂ <a href="https://docs.python.org/3/library/pickle.html">pickle</a>Â and stored in the cache (together with the value of the <code>url</code> parameter).</li><li>On the next run, Streamlit checks the cache for an entry of <code>load_data</code> with the specific <code>url</code>. There is one! So it retrieves the cached object, deserializes it to a DataFrame, and returns it instead of re-running the function and downloading the data again.</li></ul><p>This process of serializing and deserializing the cached object creates a copy of our original DataFrame. While this copying behavior may seem unnecessary, it&#x27;s what we want when caching data objects since it effectively prevents mutation and concurrency issues. Read the section â€œ<a href="#mutation-and-concurrency-issues">Mutation and concurrency issues</a>&quot; below to understand this in more detail.</p><h4 id="examples"><a aria-hidden="true" tabindex="-1" href="#examples"><span class="icon icon-link"></span></a>Examples</h4><br/><p><strong>DataFrame transformations</strong></p><p>In the example above, we already showed how to cache loading a DataFrame. It can also be useful to cache DataFrame transformations such as <code>df.filter</code>, <code>df.apply</code>, or <code>df.sort_values</code>. Especially with large DataFrames, these operations can be slow.</p><section class="code_Container__v4rq_"><pre><code class="language-python">@st.cache_data
def transform(df):
    df = df.filter(items=[&#x27;one&#x27;, &#x27;three&#x27;])
    df = df.apply(np.sum, axis=0)
    return df
</code></pre></section><p><strong>Array computations</strong></p><p>Similarly, it can make sense to cache computations on NumPy arrays:</p><section class="code_Container__v4rq_"><pre><code class="language-python">@st.cache_data
def add(arr1, arr2):
    return arr1 + arr2
</code></pre></section><p><strong>Database queries</strong></p><p>You usually make SQL queries to load data into your app when working with databases. Repeatedly running these queries can be slow, cost money, and degrade the performance of your database. We strongly recommend caching any database queries in your app. See also <a href="../../knowledge-base/tutorials/databases.html">our guides on connecting Streamlit to different databases</a> for in-depth examples.</p><section class="code_Container__v4rq_"><pre><code class="language-python">connection = database.connect()

@st.cache_data
def query():
    return pd.read_sql_query(&quot;SELECT * from table&quot;, connection)
</code></pre></section><section class="callout_Container__IU_XU tip_Tip__UYVQt"><section class="iconHeader_Container__w4_WA"><i class="iconHeader_Icon__X6Kz_ iconHeader_VioletBackground__xhbLp" style="transform:rotate(0deg)">star</i><h4 class="iconHeader_Title__vFC9I iconHeader_VioletText__Zclnw">Tip</h4></section><p>You should set a <code>ttl</code> (time to live) to get new results from your database. If you set <code>st.cache_data(ttl=3600)</code>, Streamlit invalidates any cached values after 1 hour (3600 seconds) and runs the cached function again. See details in <a href="#controlling-cache-size-and-duration">Controlling cache size and duration</a>.</p></section><p><strong>API calls</strong></p><p>Similarly, it makes sense to cache API calls. Doing so also avoids rate limits.</p><section class="code_Container__v4rq_"><pre><code class="language-python">@st.cache_data
def api_call():
    response = requests.get(&#x27;https://jsonplaceholder.typicode.com/posts/1&#x27;)
    return response.json()
</code></pre></section><p><strong>Running ML models (inference)</strong></p><p>Running complex machine learning models can use significant time and memory. To avoid rerunning the same computations over and over, use caching.</p><section class="code_Container__v4rq_"><pre><code class="language-python">@st.cache_data
def run_model(inputs):
    return model(inputs)
</code></pre></section><a name="stcache_resource" class="headerLink_HashLink___Wih5"></a><h3 class="headerLink_HeaderContainer__68tak group"><a aria-hidden="true" tabindex="-1" href="#stcache_resource"><span class="icon icon-link"></span></a>st.cache_resource<div class="headerLink_CopyLink__Lvpqb"><svg width="14" height="17" viewBox="0 0 14 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.7548 0.0313721C10.7051 0.0194702 10.6571 0.00793457 10.609 0H9.87278C9.83686 0.0178223 9.81891 0.0356445 9.783 0.0356445C9.20842 0.124878 8.70565 0.374573 8.29268 0.784851L4.14488 4.90521C3.57029 5.47601 3.283 6.18951 3.31892 7.01001C3.33686 7.38464 3.42665 7.74133 3.60621 8.09808L4.43217 7.27759C4.46809 7.25977 4.46809 7.18842 4.46809 7.15271C4.41421 6.59979 4.57582 6.11816 4.97085 5.72577L8.54405 2.17615L9.13659 1.58752C9.76504 0.998901 10.7167 0.998901 11.3452 1.58752C12.0095 2.21179 12.0095 3.2464 11.3452 3.90637L7.25123 7.97327C6.8562 8.36566 6.38936 8.54401 5.83273 8.49054C5.77885 8.47266 5.72499 8.47272 5.68908 8.50836L4.86311 9.32886C4.95289 9.36456 5.00676 9.40021 5.06062 9.41803C6.15593 9.81049 7.17941 9.66779 8.02333 8.84729C9.45979 7.45599 10.8783 6.06464 12.2609 4.6377C13.7333 3.12152 12.9971 0.606445 10.9501 0.0713501C10.8805 0.0614624 10.8164 0.0461426 10.7548 0.0313721ZM7.34082 7.47388C7.62811 7.2063 7.9154 6.9209 8.20269 6.6355C8.18016 6.62988 8.16114 6.62427 8.14401 6.6192C8.10655 6.60822 8.07805 6.59985 8.04109 6.59985C7.03556 6.15393 5.83253 6.3501 5.04246 7.11713C3.606 8.52625 2.1875 9.93542 0.768994 11.3624C0.14053 11.9867 -0.0928837 12.7715 0.032803 13.6277C0.194409 14.7515 0.840817 15.5184 1.9002 15.8752C2.97755 16.2319 3.94717 16.0001 4.75517 15.2152C5.6766 14.3118 6.59005 13.4004 7.50616 12.4864C7.96467 12.0289 8.42384 11.5708 8.88501 11.1127C9.56733 10.4348 9.81871 9.61432 9.67506 8.66895C9.63916 8.41925 9.56733 8.16949 9.42369 7.9198C9.13639 8.2052 8.8491 8.47272 8.57975 8.75812C8.54385 8.776 8.54385 8.84735 8.54385 8.90082C8.61567 9.41809 8.47203 9.8819 8.09495 10.2565C6.71235 11.6478 5.31181 13.0391 3.91125 14.4125C3.51623 14.8228 2.99551 14.9655 2.43889 14.8406C1.81042 14.6979 1.4154 14.3234 1.23584 13.7347C1.05629 13.1282 1.19993 12.5753 1.64882 12.1294C2.34011 11.4337 3.03141 10.747 3.72271 10.0603C4.41401 9.37354 5.10531 8.68677 5.79661 7.99115C6.17369 7.59869 6.65849 7.45599 7.19717 7.50952C7.25103 7.50952 7.3049 7.50952 7.34082 7.47388Z" fill="#808495"></path></svg></div></h3><p><code>st.cache_resource</code> is the right command to cache â€œresources&quot; that should be available globally across all users, sessions, and reruns. It has more limited use cases than <code>st.cache_data</code>, especially for caching database connections and ML models.</p><h4 id="usage-1"><a aria-hidden="true" tabindex="-1" href="#usage-1"><span class="icon icon-link"></span></a>Usage</h4><p>As an example for <code>st.cache_resource</code>, let&#x27;s look at a typical machine learning app. As a first step, we need to load an ML model. We do this with <a href="https://huggingface.co/docs/transformers/index">Hugging Face&#x27;s transformers library</a>:</p><section class="code_Container__v4rq_"><pre><code class="language-python">from transformers import pipeline
model = pipeline(&quot;sentiment-analysis&quot;)  # ðŸ‘ˆ Load the model
</code></pre></section><p>If we put this code into a Streamlit app directly, the app will load the model at each rerun or user interaction. Repeatedly loading the model poses two problems:</p><ul><li>Loading the model takes time and slows down the app.</li><li>Each session loads the model from scratch, which takes up a huge amount of memory.</li></ul><p>Instead, it would make much more sense to load the model once and use that same object across all users and sessions. That&#x27;s exactly the use case for <code>st.cache_resource</code>! Let&#x27;s add it to our app and process some text the user entered:</p><section class="code_Container__v4rq_"><pre><code class="language-python">from transformers import pipeline

@st.cache_resource  # ðŸ‘ˆ Add the caching decorator
def load_model():
    return pipeline(&quot;sentiment-analysis&quot;)

model = load_model()

query = st.text_input(&quot;Your query&quot;, value=&quot;I love Streamlit! ðŸŽˆ&quot;)
if query:
    result = model(query)[0]  # ðŸ‘ˆ Classify the query text
    st.write(result)
</code></pre></section><p>If you run this app, you&#x27;ll see that the app calls <code>load_model</code> only once â€“ right when the app starts. Subsequent runs will reuse that same model stored in the cache, saving time and memory!</p><h4 id="behavior-1"><a aria-hidden="true" tabindex="-1" href="#behavior-1"><span class="icon icon-link"></span></a>Behavior</h4><br/><p>Using <code>st.cache_resource</code> is very similar to using <code>st.cache_data</code>. But there are a few important differences in behavior:</p><ul><li><p><code>st.cache_resource</code> does <strong>not</strong> create a copy of the cached return value but instead stores the object itself in the cache. All mutations on the function&#x27;s return value directly affect the object in the cache, so you must ensure that mutations from multiple sessions do not cause problems. In short, the return value must be thread-safe.</p><section class="callout_Container__IU_XU important_Important__lWqst"><section class="iconHeader_Container__w4_WA"><i class="iconHeader_Icon__X6Kz_ iconHeader_OrangeBackground__oDs0b" style="transform:rotate(0deg)">priority_high</i><h4 class="iconHeader_Title__vFC9I iconHeader_OrangeText__UGPQU">Warning</h4></section><p>Using <code>st.cache_resource</code> on objects that are not thread-safe might lead to crashes or corrupted data. Learn more below under <a href="#mutation-and-concurrency-issues">Mutation and concurrency issues</a>.</p></section></li><li><p>Not creating a copy means there&#x27;s just one global instance of the cached return object, which saves memory, e.g. when using a large ML model. In computer science terms, we create a <a href="https://en.wikipedia.org/wiki/Singleton_pattern">singleton</a>.</p></li><li><p>Return values of functions do not need to be serializable. This behavior is great for types not serializable by nature, e.g., database connections, file handles, or threads. Caching these objects with <code>st.cache_data</code> is not possible.</p></li></ul><h4 id="examples-1"><a aria-hidden="true" tabindex="-1" href="#examples-1"><span class="icon icon-link"></span></a>Examples</h4><br/><p><strong>Database connections</strong></p><p><code>st.cache_resource</code> is useful for connecting to databases. Usually, you&#x27;re creating a connection object that you want to reuse globally for every query. Creating a new connection object at each run would be inefficient and might lead to connection errors. That&#x27;s exactly what <code>st.cache_resource</code> can do, e.g., for a Postgres database:</p><section class="code_Container__v4rq_"><pre><code class="language-python">@st.cache_resource
def init_connection():
    host = &quot;hh-pgsql-public.ebi.ac.uk&quot;
    database = &quot;pfmegrnargs&quot;
    user = &quot;reader&quot;
    password = &quot;NWDMCE5xdipIjRrp&quot;
    return psycopg2.connect(host=host, database=database, user=user, password=password)

conn = init_connection()
</code></pre></section><p>Of course, you can do the same for any other database. Have a look at <a href="../../knowledge-base/tutorials/databases.html">our guides on how to connect Streamlit to databases</a> for in-depth examples.</p><p><strong>Loading ML models</strong></p><p>Your app should always cache ML models, so they are not loaded into memory again for every new session. See the <a href="#usage-1">example</a> above for how this works with ðŸ¤—Â Hugging Face models. You can do the same thing for PyTorch, TensorFlow, etc. Here&#x27;s an example for PyTorch:</p><section class="code_Container__v4rq_"><pre><code class="language-python">@st.cache_resource
def load_model():
    model = torchvision.models.resnet50(weights=ResNet50_Weights.DEFAULT)
    model.eval()
    return model

model = load_model()
</code></pre></section><a name="deciding-which-caching-decorator-to-use" class="headerLink_HashLink___Wih5"></a><h3 class="headerLink_HeaderContainer__68tak group"><a aria-hidden="true" tabindex="-1" href="#deciding-which-caching-decorator-to-use"><span class="icon icon-link"></span></a>Deciding which caching decorator to use<div class="headerLink_CopyLink__Lvpqb"><svg width="14" height="17" viewBox="0 0 14 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.7548 0.0313721C10.7051 0.0194702 10.6571 0.00793457 10.609 0H9.87278C9.83686 0.0178223 9.81891 0.0356445 9.783 0.0356445C9.20842 0.124878 8.70565 0.374573 8.29268 0.784851L4.14488 4.90521C3.57029 5.47601 3.283 6.18951 3.31892 7.01001C3.33686 7.38464 3.42665 7.74133 3.60621 8.09808L4.43217 7.27759C4.46809 7.25977 4.46809 7.18842 4.46809 7.15271C4.41421 6.59979 4.57582 6.11816 4.97085 5.72577L8.54405 2.17615L9.13659 1.58752C9.76504 0.998901 10.7167 0.998901 11.3452 1.58752C12.0095 2.21179 12.0095 3.2464 11.3452 3.90637L7.25123 7.97327C6.8562 8.36566 6.38936 8.54401 5.83273 8.49054C5.77885 8.47266 5.72499 8.47272 5.68908 8.50836L4.86311 9.32886C4.95289 9.36456 5.00676 9.40021 5.06062 9.41803C6.15593 9.81049 7.17941 9.66779 8.02333 8.84729C9.45979 7.45599 10.8783 6.06464 12.2609 4.6377C13.7333 3.12152 12.9971 0.606445 10.9501 0.0713501C10.8805 0.0614624 10.8164 0.0461426 10.7548 0.0313721ZM7.34082 7.47388C7.62811 7.2063 7.9154 6.9209 8.20269 6.6355C8.18016 6.62988 8.16114 6.62427 8.14401 6.6192C8.10655 6.60822 8.07805 6.59985 8.04109 6.59985C7.03556 6.15393 5.83253 6.3501 5.04246 7.11713C3.606 8.52625 2.1875 9.93542 0.768994 11.3624C0.14053 11.9867 -0.0928837 12.7715 0.032803 13.6277C0.194409 14.7515 0.840817 15.5184 1.9002 15.8752C2.97755 16.2319 3.94717 16.0001 4.75517 15.2152C5.6766 14.3118 6.59005 13.4004 7.50616 12.4864C7.96467 12.0289 8.42384 11.5708 8.88501 11.1127C9.56733 10.4348 9.81871 9.61432 9.67506 8.66895C9.63916 8.41925 9.56733 8.16949 9.42369 7.9198C9.13639 8.2052 8.8491 8.47272 8.57975 8.75812C8.54385 8.776 8.54385 8.84735 8.54385 8.90082C8.61567 9.41809 8.47203 9.8819 8.09495 10.2565C6.71235 11.6478 5.31181 13.0391 3.91125 14.4125C3.51623 14.8228 2.99551 14.9655 2.43889 14.8406C1.81042 14.6979 1.4154 14.3234 1.23584 13.7347C1.05629 13.1282 1.19993 12.5753 1.64882 12.1294C2.34011 11.4337 3.03141 10.747 3.72271 10.0603C4.41401 9.37354 5.10531 8.68677 5.79661 7.99115C6.17369 7.59869 6.65849 7.45599 7.19717 7.50952C7.25103 7.50952 7.3049 7.50952 7.34082 7.47388Z" fill="#808495"></path></svg></div></h3><br/><p>The sections above showed many common examples for each caching decorator. But there are edge cases for which it&#x27;s less trivial to decide which caching decorator to use. Eventually, it all comes down to the difference between â€œdata&quot; and â€œresource&quot;:</p><ul><li>Data are serializable objects (objects that can be converted to bytes viaÂ <a href="https://docs.python.org/3/library/pickle.html">pickle</a>) that you could easily save to disk. Imagine all the types you would usually store in a database or on a file system â€“ basic types like str, int, and float, but also arrays, DataFrames, images, or combinations of these types (lists, tuples, dicts, and so on).</li><li>Resources are unserializable objects that you usually would not save to disk or a database. They are often more complex, non-permanent objects like database connections, ML models, file handles, threads, etc.</li></ul><p>From the types listed above, it should be obvious that most objects in Python are â€œdata.&quot; That&#x27;s also why <code>st.cache_data</code> is the correct command for almost all use cases. <code>st.cache_resource</code> is a more exotic command that you should only use in specific situations.</p><p>Or if you&#x27;re lazy and don&#x27;t want to think too much, look up your use case or return type in the table below ðŸ˜‰:</p><table><thead><tr><th align="left">Use case</th><th align="right">Typical return types</th><th align="right">Caching decorator</th></tr></thead><tbody><tr><td align="left">Reading a CSV file with pd.read_csv</td><td align="right">pandas.DataFrame</td><td align="right">st.cache_data</td></tr><tr><td align="left">Reading a text file</td><td align="right">str, list of str</td><td align="right">st.cache_data</td></tr><tr><td align="left">Transforming pandas dataframes</td><td align="right">pandas.DataFrame, pandas.Series</td><td align="right">st.cache_data</td></tr><tr><td align="left">Computing with numpy arrays</td><td align="right">numpy.ndarray</td><td align="right">st.cache_data</td></tr><tr><td align="left">Simple computations with basic types</td><td align="right">str, int, float, â€¦</td><td align="right">st.cache_data</td></tr><tr><td align="left">Querying a database</td><td align="right">pandas.DataFrame</td><td align="right">st.cache_data</td></tr><tr><td align="left">Querying an API</td><td align="right">pandas.DataFrame, str, dict</td><td align="right">st.cache_data</td></tr><tr><td align="left">Running an ML model (inference)</td><td align="right">pandas.DataFrame, str, int, dict, list</td><td align="right">st.cache_data</td></tr><tr><td align="left">Creating or processing images</td><td align="right">PIL.Image.Image, numpy.ndarray</td><td align="right">st.cache_data</td></tr><tr><td align="left">Creating charts</td><td align="right">matplotlib.figure.Figure, plotly.graph_objects.Figure, altair.Chart</td><td align="right">st.cache_data (but some libraries require st.cache_resource, since the chart object is not serializable â€“ make sure not to mutate the chart after creation!)</td></tr><tr><td align="left">Loading ML models</td><td align="right">transformers.Pipeline, torch.nn.Module, tensorflow.keras.Model</td><td align="right">st.cache_resource</td></tr><tr><td align="left">Initializing database connections</td><td align="right">pyodbc.Connection, sqlalchemy.engine.base.Engine, psycopg2.connection, mysql.connector.MySQLConnection, sqlite3.Connection</td><td align="right">st.cache_resource</td></tr><tr><td align="left">Opening persistent file handles</td><td align="right">_<!-- -->io.TextIOWrapper</td><td align="right">st.cache_resource</td></tr><tr><td align="left">Opening persistent threads</td><td align="right">threading.thread</td><td align="right">st.cache_resource</td></tr></tbody></table><a name="advanced-usage" class="headerLink_HashLink___Wih5"></a><h2 class="headerLink_HeaderContainer__68tak group"><a aria-hidden="true" tabindex="-1" href="#advanced-usage"><span class="icon icon-link"></span></a>Advanced usage<div class="headerLink_CopyLink__Lvpqb"><svg width="14" height="17" viewBox="0 0 14 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.7548 0.0313721C10.7051 0.0194702 10.6571 0.00793457 10.609 0H9.87278C9.83686 0.0178223 9.81891 0.0356445 9.783 0.0356445C9.20842 0.124878 8.70565 0.374573 8.29268 0.784851L4.14488 4.90521C3.57029 5.47601 3.283 6.18951 3.31892 7.01001C3.33686 7.38464 3.42665 7.74133 3.60621 8.09808L4.43217 7.27759C4.46809 7.25977 4.46809 7.18842 4.46809 7.15271C4.41421 6.59979 4.57582 6.11816 4.97085 5.72577L8.54405 2.17615L9.13659 1.58752C9.76504 0.998901 10.7167 0.998901 11.3452 1.58752C12.0095 2.21179 12.0095 3.2464 11.3452 3.90637L7.25123 7.97327C6.8562 8.36566 6.38936 8.54401 5.83273 8.49054C5.77885 8.47266 5.72499 8.47272 5.68908 8.50836L4.86311 9.32886C4.95289 9.36456 5.00676 9.40021 5.06062 9.41803C6.15593 9.81049 7.17941 9.66779 8.02333 8.84729C9.45979 7.45599 10.8783 6.06464 12.2609 4.6377C13.7333 3.12152 12.9971 0.606445 10.9501 0.0713501C10.8805 0.0614624 10.8164 0.0461426 10.7548 0.0313721ZM7.34082 7.47388C7.62811 7.2063 7.9154 6.9209 8.20269 6.6355C8.18016 6.62988 8.16114 6.62427 8.14401 6.6192C8.10655 6.60822 8.07805 6.59985 8.04109 6.59985C7.03556 6.15393 5.83253 6.3501 5.04246 7.11713C3.606 8.52625 2.1875 9.93542 0.768994 11.3624C0.14053 11.9867 -0.0928837 12.7715 0.032803 13.6277C0.194409 14.7515 0.840817 15.5184 1.9002 15.8752C2.97755 16.2319 3.94717 16.0001 4.75517 15.2152C5.6766 14.3118 6.59005 13.4004 7.50616 12.4864C7.96467 12.0289 8.42384 11.5708 8.88501 11.1127C9.56733 10.4348 9.81871 9.61432 9.67506 8.66895C9.63916 8.41925 9.56733 8.16949 9.42369 7.9198C9.13639 8.2052 8.8491 8.47272 8.57975 8.75812C8.54385 8.776 8.54385 8.84735 8.54385 8.90082C8.61567 9.41809 8.47203 9.8819 8.09495 10.2565C6.71235 11.6478 5.31181 13.0391 3.91125 14.4125C3.51623 14.8228 2.99551 14.9655 2.43889 14.8406C1.81042 14.6979 1.4154 14.3234 1.23584 13.7347C1.05629 13.1282 1.19993 12.5753 1.64882 12.1294C2.34011 11.4337 3.03141 10.747 3.72271 10.0603C4.41401 9.37354 5.10531 8.68677 5.79661 7.99115C6.17369 7.59869 6.65849 7.45599 7.19717 7.50952C7.25103 7.50952 7.3049 7.50952 7.34082 7.47388Z" fill="#808495"></path></svg></div></h2><a name="controlling-cache-size-and-duration" class="headerLink_HashLink___Wih5"></a><h3 class="headerLink_HeaderContainer__68tak group"><a aria-hidden="true" tabindex="-1" href="#controlling-cache-size-and-duration"><span class="icon icon-link"></span></a>Controlling cache size and duration<div class="headerLink_CopyLink__Lvpqb"><svg width="14" height="17" viewBox="0 0 14 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.7548 0.0313721C10.7051 0.0194702 10.6571 0.00793457 10.609 0H9.87278C9.83686 0.0178223 9.81891 0.0356445 9.783 0.0356445C9.20842 0.124878 8.70565 0.374573 8.29268 0.784851L4.14488 4.90521C3.57029 5.47601 3.283 6.18951 3.31892 7.01001C3.33686 7.38464 3.42665 7.74133 3.60621 8.09808L4.43217 7.27759C4.46809 7.25977 4.46809 7.18842 4.46809 7.15271C4.41421 6.59979 4.57582 6.11816 4.97085 5.72577L8.54405 2.17615L9.13659 1.58752C9.76504 0.998901 10.7167 0.998901 11.3452 1.58752C12.0095 2.21179 12.0095 3.2464 11.3452 3.90637L7.25123 7.97327C6.8562 8.36566 6.38936 8.54401 5.83273 8.49054C5.77885 8.47266 5.72499 8.47272 5.68908 8.50836L4.86311 9.32886C4.95289 9.36456 5.00676 9.40021 5.06062 9.41803C6.15593 9.81049 7.17941 9.66779 8.02333 8.84729C9.45979 7.45599 10.8783 6.06464 12.2609 4.6377C13.7333 3.12152 12.9971 0.606445 10.9501 0.0713501C10.8805 0.0614624 10.8164 0.0461426 10.7548 0.0313721ZM7.34082 7.47388C7.62811 7.2063 7.9154 6.9209 8.20269 6.6355C8.18016 6.62988 8.16114 6.62427 8.14401 6.6192C8.10655 6.60822 8.07805 6.59985 8.04109 6.59985C7.03556 6.15393 5.83253 6.3501 5.04246 7.11713C3.606 8.52625 2.1875 9.93542 0.768994 11.3624C0.14053 11.9867 -0.0928837 12.7715 0.032803 13.6277C0.194409 14.7515 0.840817 15.5184 1.9002 15.8752C2.97755 16.2319 3.94717 16.0001 4.75517 15.2152C5.6766 14.3118 6.59005 13.4004 7.50616 12.4864C7.96467 12.0289 8.42384 11.5708 8.88501 11.1127C9.56733 10.4348 9.81871 9.61432 9.67506 8.66895C9.63916 8.41925 9.56733 8.16949 9.42369 7.9198C9.13639 8.2052 8.8491 8.47272 8.57975 8.75812C8.54385 8.776 8.54385 8.84735 8.54385 8.90082C8.61567 9.41809 8.47203 9.8819 8.09495 10.2565C6.71235 11.6478 5.31181 13.0391 3.91125 14.4125C3.51623 14.8228 2.99551 14.9655 2.43889 14.8406C1.81042 14.6979 1.4154 14.3234 1.23584 13.7347C1.05629 13.1282 1.19993 12.5753 1.64882 12.1294C2.34011 11.4337 3.03141 10.747 3.72271 10.0603C4.41401 9.37354 5.10531 8.68677 5.79661 7.99115C6.17369 7.59869 6.65849 7.45599 7.19717 7.50952C7.25103 7.50952 7.3049 7.50952 7.34082 7.47388Z" fill="#808495"></path></svg></div></h3><p>If your app runs for a long time and constantly caches functions, you might run into two problems:</p><ol><li>The app runs out of memory because the cache is too large.</li><li>Objects in the cache become stale, e.g. because you cached old data from a database.</li></ol><p>You can combat these problems with the <code>ttl</code> and <code>max_entries</code> parameters, which are available for both caching decorators.</p><p><strong>The <code>ttl</code> (time-to-live) parameter</strong></p><p><code>ttl</code> sets a time to live on a cached function. If that time is up and you call the function again, the app will discard any old, cached values, and the function will be rerun. The newly computed value will then be stored in the cache. This behavior is useful for preventing stale data (problem 2) and the cache from growing too large (problem 1). Especially when pulling data from a database or API, you should always set a <code>ttl</code> so you are not using old data. Here&#x27;s an example:</p><section class="code_Container__v4rq_"><pre><code class="language-python">@st.cache_data(ttl=3600)  # ðŸ‘ˆ Cache data for 1 hour (=3600 seconds)
def get_api_data():
    data = api.get(...)
    return data
</code></pre></section><section class="callout_Container__IU_XU tip_Tip__UYVQt"><section class="iconHeader_Container__w4_WA"><i class="iconHeader_Icon__X6Kz_ iconHeader_VioletBackground__xhbLp" style="transform:rotate(0deg)">star</i><h4 class="iconHeader_Title__vFC9I iconHeader_VioletText__Zclnw">Tip</h4></section><p>You can also set <code>ttl</code> values using <code>timedelta</code>, e.g., <code>ttl=datetime.timedelta(hours=1)</code>.</p></section><p><strong>The <code>max_entries</code> parameter</strong></p><p><code>max_entries</code> sets the maximum number of entries in the cache. An upper bound on the number of cache entries is useful for limiting memory (problem 1), especially when caching large objects. The oldest entry will be removed when a new entry is added to a full cache. Here&#x27;s an example:</p><section class="code_Container__v4rq_"><pre><code class="language-python">@st.cache_data(max_entries=1000)  # ðŸ‘ˆ Maximum 1000 entries in the cache
def get_large_array(seed):
    np.random.seed(seed)
    arr = np.random.rand(100000)
    return arr
</code></pre></section><a name="customizing-the-spinner" class="headerLink_HashLink___Wih5"></a><h3 class="headerLink_HeaderContainer__68tak group"><a aria-hidden="true" tabindex="-1" href="#customizing-the-spinner"><span class="icon icon-link"></span></a>Customizing the spinner<div class="headerLink_CopyLink__Lvpqb"><svg width="14" height="17" viewBox="0 0 14 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.7548 0.0313721C10.7051 0.0194702 10.6571 0.00793457 10.609 0H9.87278C9.83686 0.0178223 9.81891 0.0356445 9.783 0.0356445C9.20842 0.124878 8.70565 0.374573 8.29268 0.784851L4.14488 4.90521C3.57029 5.47601 3.283 6.18951 3.31892 7.01001C3.33686 7.38464 3.42665 7.74133 3.60621 8.09808L4.43217 7.27759C4.46809 7.25977 4.46809 7.18842 4.46809 7.15271C4.41421 6.59979 4.57582 6.11816 4.97085 5.72577L8.54405 2.17615L9.13659 1.58752C9.76504 0.998901 10.7167 0.998901 11.3452 1.58752C12.0095 2.21179 12.0095 3.2464 11.3452 3.90637L7.25123 7.97327C6.8562 8.36566 6.38936 8.54401 5.83273 8.49054C5.77885 8.47266 5.72499 8.47272 5.68908 8.50836L4.86311 9.32886C4.95289 9.36456 5.00676 9.40021 5.06062 9.41803C6.15593 9.81049 7.17941 9.66779 8.02333 8.84729C9.45979 7.45599 10.8783 6.06464 12.2609 4.6377C13.7333 3.12152 12.9971 0.606445 10.9501 0.0713501C10.8805 0.0614624 10.8164 0.0461426 10.7548 0.0313721ZM7.34082 7.47388C7.62811 7.2063 7.9154 6.9209 8.20269 6.6355C8.18016 6.62988 8.16114 6.62427 8.14401 6.6192C8.10655 6.60822 8.07805 6.59985 8.04109 6.59985C7.03556 6.15393 5.83253 6.3501 5.04246 7.11713C3.606 8.52625 2.1875 9.93542 0.768994 11.3624C0.14053 11.9867 -0.0928837 12.7715 0.032803 13.6277C0.194409 14.7515 0.840817 15.5184 1.9002 15.8752C2.97755 16.2319 3.94717 16.0001 4.75517 15.2152C5.6766 14.3118 6.59005 13.4004 7.50616 12.4864C7.96467 12.0289 8.42384 11.5708 8.88501 11.1127C9.56733 10.4348 9.81871 9.61432 9.67506 8.66895C9.63916 8.41925 9.56733 8.16949 9.42369 7.9198C9.13639 8.2052 8.8491 8.47272 8.57975 8.75812C8.54385 8.776 8.54385 8.84735 8.54385 8.90082C8.61567 9.41809 8.47203 9.8819 8.09495 10.2565C6.71235 11.6478 5.31181 13.0391 3.91125 14.4125C3.51623 14.8228 2.99551 14.9655 2.43889 14.8406C1.81042 14.6979 1.4154 14.3234 1.23584 13.7347C1.05629 13.1282 1.19993 12.5753 1.64882 12.1294C2.34011 11.4337 3.03141 10.747 3.72271 10.0603C4.41401 9.37354 5.10531 8.68677 5.79661 7.99115C6.17369 7.59869 6.65849 7.45599 7.19717 7.50952C7.25103 7.50952 7.3049 7.50952 7.34082 7.47388Z" fill="#808495"></path></svg></div></h3><p>By default, Streamlit shows a small loading spinner in the app when a cached function is running. You can modify it easily with the <code>show_spinner</code> parameter, which is available for both caching decorators:</p><section class="code_Container__v4rq_"><pre><code class="language-python">@st.cache_data(show_spinner=False)  # ðŸ‘ˆ Disable the spinner
def get_api_data():
    data = api.get(...)
    return data

@st.cache_data(show_spinner=&quot;Fetching data from API...&quot;)  # ðŸ‘ˆ Use custom text for spinner
def get_api_data():
    data = api.get(...)
    return data
</code></pre></section><a name="excluding-input-parameters" class="headerLink_HashLink___Wih5"></a><h3 class="headerLink_HeaderContainer__68tak group"><a aria-hidden="true" tabindex="-1" href="#excluding-input-parameters"><span class="icon icon-link"></span></a>Excluding input parameters<div class="headerLink_CopyLink__Lvpqb"><svg width="14" height="17" viewBox="0 0 14 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.7548 0.0313721C10.7051 0.0194702 10.6571 0.00793457 10.609 0H9.87278C9.83686 0.0178223 9.81891 0.0356445 9.783 0.0356445C9.20842 0.124878 8.70565 0.374573 8.29268 0.784851L4.14488 4.90521C3.57029 5.47601 3.283 6.18951 3.31892 7.01001C3.33686 7.38464 3.42665 7.74133 3.60621 8.09808L4.43217 7.27759C4.46809 7.25977 4.46809 7.18842 4.46809 7.15271C4.41421 6.59979 4.57582 6.11816 4.97085 5.72577L8.54405 2.17615L9.13659 1.58752C9.76504 0.998901 10.7167 0.998901 11.3452 1.58752C12.0095 2.21179 12.0095 3.2464 11.3452 3.90637L7.25123 7.97327C6.8562 8.36566 6.38936 8.54401 5.83273 8.49054C5.77885 8.47266 5.72499 8.47272 5.68908 8.50836L4.86311 9.32886C4.95289 9.36456 5.00676 9.40021 5.06062 9.41803C6.15593 9.81049 7.17941 9.66779 8.02333 8.84729C9.45979 7.45599 10.8783 6.06464 12.2609 4.6377C13.7333 3.12152 12.9971 0.606445 10.9501 0.0713501C10.8805 0.0614624 10.8164 0.0461426 10.7548 0.0313721ZM7.34082 7.47388C7.62811 7.2063 7.9154 6.9209 8.20269 6.6355C8.18016 6.62988 8.16114 6.62427 8.14401 6.6192C8.10655 6.60822 8.07805 6.59985 8.04109 6.59985C7.03556 6.15393 5.83253 6.3501 5.04246 7.11713C3.606 8.52625 2.1875 9.93542 0.768994 11.3624C0.14053 11.9867 -0.0928837 12.7715 0.032803 13.6277C0.194409 14.7515 0.840817 15.5184 1.9002 15.8752C2.97755 16.2319 3.94717 16.0001 4.75517 15.2152C5.6766 14.3118 6.59005 13.4004 7.50616 12.4864C7.96467 12.0289 8.42384 11.5708 8.88501 11.1127C9.56733 10.4348 9.81871 9.61432 9.67506 8.66895C9.63916 8.41925 9.56733 8.16949 9.42369 7.9198C9.13639 8.2052 8.8491 8.47272 8.57975 8.75812C8.54385 8.776 8.54385 8.84735 8.54385 8.90082C8.61567 9.41809 8.47203 9.8819 8.09495 10.2565C6.71235 11.6478 5.31181 13.0391 3.91125 14.4125C3.51623 14.8228 2.99551 14.9655 2.43889 14.8406C1.81042 14.6979 1.4154 14.3234 1.23584 13.7347C1.05629 13.1282 1.19993 12.5753 1.64882 12.1294C2.34011 11.4337 3.03141 10.747 3.72271 10.0603C4.41401 9.37354 5.10531 8.68677 5.79661 7.99115C6.17369 7.59869 6.65849 7.45599 7.19717 7.50952C7.25103 7.50952 7.3049 7.50952 7.34082 7.47388Z" fill="#808495"></path></svg></div></h3><p>In a cached function, all input parameters must be hashable. Let&#x27;s quickly explain why and what it means. When the function is called, Streamlit looks at its parameter values to determine if it was cached before. Therefore, it needs a reliable way to compare the parameter values across function calls. Trivial for a string or int â€“ but complex for arbitrary objects! Streamlit uses <a href="https://en.wikipedia.org/wiki/Hash_function">hashing</a> to solve that. It converts the parameter to a stable key and stores that key. At the next function call, it hashes the parameter again and compares it with the stored hash key.</p><p>Unfortunately, not all parameters are hashable! E.g., you might pass an unhashable database connection or ML model to your cached function. In this case, you can exclude input parameters from caching. Simply prepend the parameter name with an underscore (e.g., <code>_param1</code>), and it will not be used for caching. Even if it changes, Streamlit will return a cached result if all the other parameters match up.</p><p>Here&#x27;s an example:</p><section class="code_Container__v4rq_"><pre><code class="language-python">@st.cache_data
def fetch_data(_db_connection, num_rows):  # ðŸ‘ˆ Don&#x27;t hash _db_connection
    data = _db_connection.fetch(num_rows)
    return data

connection = init_connection()
fetch_data(connection, 10)
</code></pre></section><p>But what if you want to cache a function that takes an unhashable parameter? For example, you might want to cache a function that takes an ML model as input and returns the layer names of that model. Since the model is the only input parameter, you cannot exclude it from caching. In this case you can use the <code>hash_funcs</code> parameter to specify a custom hashing function for the model.</p><a name="the-hash_funcs-parameter" class="headerLink_HashLink___Wih5"></a><h3 class="headerLink_HeaderContainer__68tak group"><span><a aria-hidden="true" tabindex="-1" href="#the-hash_funcs-parameter"><span class="icon icon-link"></span></a>The <code>hash_funcs</code> parameter</span><div class="headerLink_CopyLink__Lvpqb"><svg width="14" height="17" viewBox="0 0 14 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.7548 0.0313721C10.7051 0.0194702 10.6571 0.00793457 10.609 0H9.87278C9.83686 0.0178223 9.81891 0.0356445 9.783 0.0356445C9.20842 0.124878 8.70565 0.374573 8.29268 0.784851L4.14488 4.90521C3.57029 5.47601 3.283 6.18951 3.31892 7.01001C3.33686 7.38464 3.42665 7.74133 3.60621 8.09808L4.43217 7.27759C4.46809 7.25977 4.46809 7.18842 4.46809 7.15271C4.41421 6.59979 4.57582 6.11816 4.97085 5.72577L8.54405 2.17615L9.13659 1.58752C9.76504 0.998901 10.7167 0.998901 11.3452 1.58752C12.0095 2.21179 12.0095 3.2464 11.3452 3.90637L7.25123 7.97327C6.8562 8.36566 6.38936 8.54401 5.83273 8.49054C5.77885 8.47266 5.72499 8.47272 5.68908 8.50836L4.86311 9.32886C4.95289 9.36456 5.00676 9.40021 5.06062 9.41803C6.15593 9.81049 7.17941 9.66779 8.02333 8.84729C9.45979 7.45599 10.8783 6.06464 12.2609 4.6377C13.7333 3.12152 12.9971 0.606445 10.9501 0.0713501C10.8805 0.0614624 10.8164 0.0461426 10.7548 0.0313721ZM7.34082 7.47388C7.62811 7.2063 7.9154 6.9209 8.20269 6.6355C8.18016 6.62988 8.16114 6.62427 8.14401 6.6192C8.10655 6.60822 8.07805 6.59985 8.04109 6.59985C7.03556 6.15393 5.83253 6.3501 5.04246 7.11713C3.606 8.52625 2.1875 9.93542 0.768994 11.3624C0.14053 11.9867 -0.0928837 12.7715 0.032803 13.6277C0.194409 14.7515 0.840817 15.5184 1.9002 15.8752C2.97755 16.2319 3.94717 16.0001 4.75517 15.2152C5.6766 14.3118 6.59005 13.4004 7.50616 12.4864C7.96467 12.0289 8.42384 11.5708 8.88501 11.1127C9.56733 10.4348 9.81871 9.61432 9.67506 8.66895C9.63916 8.41925 9.56733 8.16949 9.42369 7.9198C9.13639 8.2052 8.8491 8.47272 8.57975 8.75812C8.54385 8.776 8.54385 8.84735 8.54385 8.90082C8.61567 9.41809 8.47203 9.8819 8.09495 10.2565C6.71235 11.6478 5.31181 13.0391 3.91125 14.4125C3.51623 14.8228 2.99551 14.9655 2.43889 14.8406C1.81042 14.6979 1.4154 14.3234 1.23584 13.7347C1.05629 13.1282 1.19993 12.5753 1.64882 12.1294C2.34011 11.4337 3.03141 10.747 3.72271 10.0603C4.41401 9.37354 5.10531 8.68677 5.79661 7.99115C6.17369 7.59869 6.65849 7.45599 7.19717 7.50952C7.25103 7.50952 7.3049 7.50952 7.34082 7.47388Z" fill="#808495"></path></svg></div></h3><p>As described above, Streamlit&#x27;s caching decorators hash the input parameters and cached function&#x27;s signature to determine whether the function has been run before and has a return value stored (&quot;cache hit&quot;) or needs to be run (&quot;cache miss&quot;). Input parameters that are not hashable by Streamlit&#x27;s hashing implementation can be ignored by prepending an underscore to their name. But there two rare cases where this is undesirable. i.e. where you want to hash the parameter that Streamlit is unable to hash:</p><ol><li>When Streamlit&#x27;s hashing mechanism fails to hash a parameter, resulting in a <code>UnhashableParamError</code> being raised.</li><li>When you want to override Streamlit&#x27;s default hashing mechanism for a parameter.</li></ol><p>Let&#x27;s discuss each of these cases in turn with examples.</p><h4 id="example-1-hashing-a-custom-class"><a aria-hidden="true" tabindex="-1" href="#example-1-hashing-a-custom-class"><span class="icon icon-link"></span></a>Example 1: Hashing a custom class</h4><p>Streamlit does not know how to hash custom classes. If you pass a custom class to a cached function, Streamlit will raise a <code>UnhashableParamError</code>. For example, let&#x27;s define a custom class <code>MyCustomClass</code> that accepts an initial integer score. Let&#x27;s also define a cached function <code>multiply_score</code> that multiplies the score by a multiplier:</p><section class="code_Container__v4rq_"><pre><code class="language-python">import streamlit as st

class MyCustomClass:
    def __init__(self, initial_score: int):
        self.my_score = initial_score

@st.cache_data
def multiply_score(obj: MyCustomClass, multiplier: int) -&gt; int:
    return obj.my_score * multiplier

initial_score = st.number_input(&quot;Enter initial score&quot;, value=15)

score = MyCustomClass(initial_score)
multiplier = 2

st.write(multiply_score(score, multiplier))
</code></pre></section><p>If you run this app, you&#x27;ll see that Streamlit raises a <code>UnhashableParamError</code> since it does not know how to hash <code>MyCustomClass</code>:</p><section class="code_Container__v4rq_"><pre><code class="language-python">UnhashableParamError: Cannot hash argument &#x27;obj&#x27; (of type __main__.MyCustomClass) in &#x27;multiply_score&#x27;.
</code></pre></section><p>To fix this, we can use the <code>hash_funcs</code> parameter to tell Streamlit how to hash <code>MyCustomClass</code>. We do this by passing a dictionary to <code>hash_funcs</code> that maps the name of the parameter to a hash function. The choice of hash function is up to the developer. In this case, let&#x27;s define a custom hash function <code>hash_func</code> that takes the custom class as input and returns the score. We want the score to be the unique identifier of the object, so we can use it to deterministically hash the object:</p><section class="code_Container__v4rq_"><pre><code class="language-python">import streamlit as st

class MyCustomClass:
    def __init__(self, initial_score: int):
        self.my_score = initial_score

def hash_func(obj: MyCustomClass) -&gt; int:
    return obj.my_score  # or any other value that uniquely identifies the object

@st.cache_data(hash_funcs={MyCustomClass: hash_func})
def multiply_score(obj: MyCustomClass, multiplier: int) -&gt; int:
    return obj.my_score * multiplier

initial_score = st.number_input(&quot;Enter initial score&quot;, value=15)

score = MyCustomClass(initial_score)
multiplier = 2

st.write(multiply_score(score, multiplier))
</code></pre></section><p>Now if you run the app, you&#x27;ll see that Streamlit no longer raises a <code>UnhashableParamError</code> and the app runs as expected.</p><p>Let&#x27;s now consider the case where <code>multiply_score</code> is an attribute of <code>MyCustomClass</code> and we want to hash the entire object:</p><section class="code_Container__v4rq_"><pre><code class="language-python">import streamlit as st

class MyCustomClass:
    def __init__(self, initial_score: int):
        self.my_score = initial_score

    @st.cache_data
    def multiply_score(self, multiplier: int) -&gt; int:
        return self.my_score * multiplier

initial_score = st.number_input(&quot;Enter initial score&quot;, value=15)

score = MyCustomClass(initial_score)
multiplier = 2

st.write(score.multiply_score(multiplier))
</code></pre></section><p>If you run this app, you&#x27;ll see that Streamlit raises a <code>UnhashableParamError</code> since it cannot hash the argument <code>&#x27;self&#x27; (of type __main__.MyCustomClass) in &#x27;multiply_score&#x27;</code>. A simple fix here could be to use Python&#x27;s <code>hash()</code> function to hash the object:</p><section class="code_Container__v4rq_"><pre><code class="language-python">import streamlit as st

class MyCustomClass:
    def __init__(self, initial_score: int):
        self.my_score = initial_score

    @st.cache_data(hash_funcs={&quot;__main__.MyCustomClass&quot;: lambda x: hash(x.my_score)})
    def multiply_score(self, multiplier: int) -&gt; int:
        return self.my_score * multiplier

initial_score = st.number_input(&quot;Enter initial score&quot;, value=15)

score = MyCustomClass(initial_score)
multiplier = 2

st.write(score.multiply_score(multiplier))
</code></pre></section><p>Above, the hash function is defined as <code>lambda x: hash(x.my_score)</code>. This creates a hash based on the <code>my_score</code> attribute of the <code>MyCustomClass</code> instance. As long as <code>my_score</code> remains the same, the hash remains the same. Thus, the result of <code>multiply_score</code> can be retrieved from the cache without recomputation.</p><p>As an astute Pythonista, you may have been tempted to use Python&#x27;s <code>id()</code> function to hash the object like so:</p><section class="code_Container__v4rq_"><pre><code class="language-python">import streamlit as st

class MyCustomClass:
    def __init__(self, initial_score: int):
        self.my_score = initial_score

    @st.cache_data(hash_funcs={&quot;__main__.MyCustomClass&quot;: id})
    def multiply_score(self, multiplier: int) -&gt; int:
        return self.my_score * multiplier

initial_score = st.number_input(&quot;Enter initial score&quot;, value=15)

score = MyCustomClass(initial_score)
multiplier = 2

st.write(score.multiply_score(multiplier))
</code></pre></section><p>If you run the app, you&#x27;ll notice that Streamlit recomputes <code>multiply_score</code> each time even if <code>my_score</code> hasn&#x27;t changed! Puzzled? In Python, <code>id()</code> returns the identity of an object, which is unique and constant for the object during its lifetime. This means that even if the <code>my_score</code> value is the same between two instances of <code>MyCustomClass</code>, <code>id()</code> will return different values for these two instances, leading to different hash values. As a result, Streamlit considers these two different instances as needing separate cached values, thus it recomputes the <code>multiply_score</code> each time even if <code>my_score</code> hasn&#x27;t changed.</p><p>This is why we discourage using it as hash func, and instead encourage functions that return deterministic, true hash values. That said, if you know what you&#x27;re doing, you can use <code>id()</code> as a hash function. Just be aware of the consequences. For example, <code>id</code> is often the <em>correct</em> hash func when you&#x27;re passing the result of an <code>@st.cache_resource</code> function as the input param to another cached function. There&#x27;s a whole class of object types that arenâ€™t otherwise hashable.</p><h4 id="example-2-hashing-a-pydantic-model"><a aria-hidden="true" tabindex="-1" href="#example-2-hashing-a-pydantic-model"><span class="icon icon-link"></span></a>Example 2: Hashing a Pydantic model</h4><p>Let&#x27;s consider another example where we want to hash a Pydantic model:</p><section class="code_Container__v4rq_"><pre><code class="language-python">import streamlit as st
from pydantic import BaseModel

class Person(BaseModel):
    name: str

@st.cache_data
def identity(person: Person):
    return person

person = identity(Person(name=&quot;Lee&quot;))
st.write(f&quot;The person is {person.name}&quot;)
</code></pre></section><p>Above, we define a custom class <code>Person</code> using Pydantic&#x27;s <code>BaseModel</code> with a single attribute name. We also define an <code>identity</code> function which accepts an instance of <code>Person</code> as an arg and returns it without modification. This function is intended to cache the result, therefore, if called multiple times with the same <code>Person</code> instance, it won&#x27;t recompute but return the cached instance.</p><p>If you run the app, however, you&#x27;ll run into a <code>UnhashableParamError: Cannot hash argument &#x27;person&#x27; (of type __main__.Person) in &#x27;identity&#x27;.</code> error. This is because Streamlit does not know how to hash the <code>Person</code> class. To fix this, we can use the <code>hash_funcs</code> kwarg to tell Streamlit how to hash <code>Person</code>.</p><p>In the version below, we define a custom hash function <code>hash_func</code> that takes the <code>Person</code> instance as input and returns the name attribute. We want the name to be the unique identifier of the object, so we can use it to deterministically hash the object:</p><section class="code_Container__v4rq_"><pre><code class="language-python">import streamlit as st
from pydantic import BaseModel

class Person(BaseModel):
    name: str

@st.cache_data(hash_funcs={Person: lambda p: p.name})
def identity(person: Person):
    return person

person = identity(Person(name=&quot;Lee&quot;))
st.write(f&quot;The person is {person.name}&quot;)
</code></pre></section><h4 id="example-3-hashing-a-ml-model"><a aria-hidden="true" tabindex="-1" href="#example-3-hashing-a-ml-model"><span class="icon icon-link"></span></a>Example 3: Hashing a ML model</h4><p>There may be cases where you want to pass your favorite machine learning model to a cached function. For example, let&#x27;s say you want to pass a TensorFlow model to a cached function, based on what model the user selects in the app. You might try something like this:</p><section class="code_Container__v4rq_"><pre><code class="language-python">import streamlit as st
import tensorflow as tf

@st.cache_resource
def load_base_model(option):
    if option == 1:
        return tf.keras.applications.ResNet50(include_top=False, weights=&quot;imagenet&quot;)
    else:
        return tf.keras.applications.MobileNetV2(include_top=False, weights=&quot;imagenet&quot;)

@st.cache_resource
def load_layers(base_model):
    return [layer.name for layer in base_model.layers]

option = st.radio(&quot;Model 1 or 2&quot;, [1, 2])

base_model = load_base_model(option)

layers = load_layers(base_model)

st.write(layers)
</code></pre></section><p>In the above app, the user can select one of two models. Based on the selection, the app loads the corresponding model and passes it to <code>load_layers</code>. This function then returns the names of the layers in the model. If you run the app, you&#x27;ll see that Streamlit raises a <code>UnhashableParamError</code> since it cannot hash the argument <code>&#x27;base_model&#x27; (of type keras.engine.functional.Functional) in &#x27;load_layers&#x27;</code>.</p><p>If you disable hashing for <code>base_model</code> by prepending an underscore to its name, you&#x27;ll observe that regardless of which base model is chosen, the layers displayed are same. This subtle bug is due to the fact that the <code>load_layers</code> function is not re-run when the base model changes. This is because Streamlit does not hash the <code>base_model</code> argument, so it does not know that the function needs to be re-run when the base model changes.</p><p>To fix this, we can use the <code>hash_funcs</code> kwarg to tell Streamlit how to hash the <code>base_model</code> argument. In the version below, we define a custom hash function <code>hash_func</code>: <code>Functional: lambda x: x.name</code>. Our choice of hash func is informed by our knowledge that the <code>name</code> attribute of a <code>Functional</code> object or model uniquely identifies it. As long as the <code>name</code> attribute remains the same, the hash remains the same. Thus, the result of <code>load_layers</code> can be retrieved from the cache without recomputation.</p><section class="code_Container__v4rq_"><pre><code class="language-python">import streamlit as st
import tensorflow as tf
from keras.engine.functional import Functional

@st.cache_resource
def load_base_model(option):
    if option == 1:
        return tf.keras.applications.ResNet50(include_top=False, weights=&quot;imagenet&quot;)
    else:
        return tf.keras.applications.MobileNetV2(include_top=False, weights=&quot;imagenet&quot;)

@st.cache_resource(hash_funcs={Functional: lambda x: x.name})
def load_layers(base_model):
    return [layer.name for layer in base_model.layers]

option = st.radio(&quot;Model 1 or 2&quot;, [1, 2])

base_model = load_base_model(option)

layers = load_layers(base_model)

st.write(layers)
</code></pre></section><p>In the above case, we could also have used <code>hash_funcs={Functional: id}</code> as the hash function. This is because <code>id</code> is often the <em>correct</em> hash func when you&#x27;re passing the result of an <code>@st.cache_resource</code> function as the input param to another cached function.</p><h4 id="example-4-overriding-streamlits-default-hashing-mechanism"><a aria-hidden="true" tabindex="-1" href="#example-4-overriding-streamlits-default-hashing-mechanism"><span class="icon icon-link"></span></a>Example 4: Overriding Streamlit&#x27;s default hashing mechanism</h4><p>Let&#x27;s consider another example where we want to override Streamlit&#x27;s default hashing mechanism for a pytz-localized datetime object:</p><section class="code_Container__v4rq_"><pre><code class="language-python">from datetime import datetime
import pytz
import streamlit as st

tz = pytz.timezone(&quot;Europe/Berlin&quot;)

@st.cache_data
def load_data(dt):
    return dt

now = datetime.now()
st.text(load_data(dt=now))

now_tz = tz.localize(datetime.now())
st.text(load_data(dt=now_tz))
</code></pre></section><p>It may be surprising to see that although <code>now</code> and <code>now_tz</code> are of the same <code>&lt;class &#x27;datetime.datetime&#x27;&gt;</code> type, Streamlit does not how to hash <code>now_tz</code> and raises a <code>UnhashableParamError</code>. In this case, we can override Streamlit&#x27;s default hashing mechanism for <code>datetime</code> objects by passing a custom hash function to the <code>hash_funcs</code> kwarg:</p><section class="code_Container__v4rq_"><pre><code class="language-python">from datetime import datetime

import pytz
import streamlit as st

tz = pytz.timezone(&quot;Europe/Berlin&quot;)

@st.cache_data(hash_funcs={datetime: lambda x: x.strftime(&quot;%a %d %b %Y, %I:%M%p&quot;)})
def load_data(dt):
    return dt

now = datetime.now()
st.text(load_data(dt=now))

now_tz = tz.localize(datetime.now())
st.text(load_data(dt=now_tz))
</code></pre></section><p>Let&#x27;s now consider a case where we want to override Streamlit&#x27;s default hashing mechanism for NumPy arrays. While Streamlit natively hashes Pandas and NumPy objects, there may be cases where you want to override Streamlit&#x27;s default hashing mechanism for these objects.</p><p>For example, let&#x27;s say we create a cache-decorated <code>show_data</code> function that accepts a NumPy array and returns it without modification. In the bellow app, <code>data = df[&quot;str&quot;].unique()</code> (which is a NumPy array) is passed to the <code>show_data</code> function.</p><section class="code_Container__v4rq_"><pre><code class="language-python">import time
import numpy as np
import pandas as pd
import streamlit as st

@st.cache_data
def get_data():
    df = pd.DataFrame({&quot;num&quot;: [112, 112, 2, 3], &quot;str&quot;: [&quot;be&quot;, &quot;a&quot;, &quot;be&quot;, &quot;c&quot;]})
    return df

@st.cache_data
def show_data(data):
    time.sleep(2)  # This makes the function take 2s to run
    return data

df = get_data()
data = df[&quot;str&quot;].unique()

st.dataframe(show_data(data))
st.button(&quot;Re-run&quot;)
</code></pre></section><p>Since <code>data</code> is always the same, we expect the <code>show_data</code> function to return the cached value. However, if you run the app, and click the <code>Re-run</code> button, you&#x27;ll notice that the <code>show_data</code> function is re-run each time. We can assume this behavior is a consequence of Streamlit&#x27;s default hashing mechanism for NumPy arrays.</p><p>To work around this, let&#x27;s define a custom hash function <code>hash_func</code> that takes a NumPy array as input and returns a string representation of the array:</p><section class="code_Container__v4rq_"><pre><code class="language-python">import time
import numpy as np
import pandas as pd
import streamlit as st

@st.cache_data
def get_data():
    df = pd.DataFrame({&quot;num&quot;: [112, 112, 2, 3], &quot;str&quot;: [&quot;be&quot;, &quot;a&quot;, &quot;be&quot;, &quot;c&quot;]})
    return df

@st.cache_data(hash_funcs={np.ndarray: str})
def show_data(data):
    time.sleep(2)  # This makes the function take 2s to run
    return data

df = get_data()
data = df[&quot;str&quot;].unique()

st.dataframe(show_data(data))
st.button(&quot;Re-run&quot;)
</code></pre></section><p>Now if you run the app, and click the <code>Re-run</code> button, you&#x27;ll notice that the <code>show_data</code> function is no longer re-run each time. It&#x27;s important to note here that our choice of hash function was very naive and not necessarily the best choice. For example, if the NumPy array is large, converting it to a string representation may be expensive. In such cases, it is up to you as the developer to define what a good hash function is for your use case.</p><h4 id="static-elements"><a aria-hidden="true" tabindex="-1" href="#static-elements"><span class="icon icon-link"></span></a>Static elements</h4><p>Since version 1.16.0, cached functions can contain Streamlit commands! For example, you can do this:</p><section class="code_Container__v4rq_"><pre><code class="language-python">@st.cache_data
def get_api_data():
    data = api.get(...)
    st.success(&quot;Fetched data from API!&quot;)  # ðŸ‘ˆ Show a success message
    return data
</code></pre></section><p>As we know, Streamlit only runs this function if it hasn&#x27;t been cached before. On this first run, the <code>st.success</code> message will appear in the app. But what happens on subsequent runs? It still shows up! Streamlit realizes that there is an <code>st.</code> command inside the cached function, saves it during the first run, and replays it on subsequent runs. Replaying static elements works for both caching decorators.</p><p>You can also use this functionality to cache entire parts of your UI:</p><section class="code_Container__v4rq_"><pre><code class="language-python">@st.cache_data
def show_data():
    st.header(&quot;Data analysis&quot;)
    data = api.get(...)
    st.success(&quot;Fetched data from API!&quot;)
    st.write(&quot;Here is a plot of the data:&quot;)
    st.line_chart(data)
    st.write(&quot;And here is the raw data:&quot;)
    st.dataframe(data)
</code></pre></section><h4 id="input-widgets"><a aria-hidden="true" tabindex="-1" href="#input-widgets"><span class="icon icon-link"></span></a>Input widgets</h4><p>You can also use <a href="../api-reference/widgets.html">interactive input widgets</a> like <code>st.slider</code> or <code>st.text_input</code> in cached functions. Widget replay is an experimental feature at the moment. To enable it, you need to set the <code>experimental_allow_widgets</code> parameter:</p><section class="code_Container__v4rq_"><pre><code class="language-python">@st.cache_data(experimental_allow_widgets=True)  # ðŸ‘ˆ Set the parameter
def get_data():
    num_rows = st.slider(&quot;Number of rows to get&quot;)  # ðŸ‘ˆ Add a slider
    data = api.get(..., num_rows)
    return data
</code></pre></section><p>Streamlit treats the slider like an additional input parameter to the cached function. If you change the slider position, Streamlit will see if it has already cached the function for this slider value. If yes, it will return the cached value. If not, it will rerun the function using the new slider value.</p><p>Using widgets in cached functions is extremely powerful because it lets you cache entire parts of your app. But it can be dangerous! Since Streamlit treats the widget value as an additional input parameter, it can easily lead to excessive memory usage. Imagine your cached function has five sliders and returns a 100 MB DataFrame. Then we&#x27;ll add 100 MB to the cache for <em>every permutation</em> of these five slider values â€“ even if the sliders do not influence the returned data! These additions can make your cache explode very quickly. Please be aware of this limitation if you use widgets in cached functions. We recommend using this feature only for isolated parts of your UI where the widgets directly influence the cached return value.</p><section class="callout_Container__IU_XU important_Important__lWqst"><section class="iconHeader_Container__w4_WA"><i class="iconHeader_Icon__X6Kz_ iconHeader_OrangeBackground__oDs0b" style="transform:rotate(0deg)">priority_high</i><h4 class="iconHeader_Title__vFC9I iconHeader_OrangeText__UGPQU">Warning</h4></section><p>Support for widgets in cached functions is experimental. We may change or remove it anytime without warning. Please use it with care!</p></section><section class="callout_Container__IU_XU note_Note__d8Rsn"><section class="iconHeader_Container__w4_WA"><i class="iconHeader_Icon__X6Kz_ iconHeader_LightBlueBackground__WINgP" style="transform:rotate(45deg)">push_pin</i><h4 class="iconHeader_Title__vFC9I iconHeader_LightBlueText__XIICP">Note</h4></section><p>Two widgets are currently not supported in cached functions: <code>st.file_uploader</code> and <code>st.camera_input</code>. We may support them in the future. Feel free to <a href="https://github.com/streamlit/streamlit/issues">open a GitHub issue</a> if you need them!</p></section><a name="dealing-with-large-data" class="headerLink_HashLink___Wih5"></a><h3 class="headerLink_HeaderContainer__68tak group"><a aria-hidden="true" tabindex="-1" href="#dealing-with-large-data"><span class="icon icon-link"></span></a>Dealing with large data<div class="headerLink_CopyLink__Lvpqb"><svg width="14" height="17" viewBox="0 0 14 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.7548 0.0313721C10.7051 0.0194702 10.6571 0.00793457 10.609 0H9.87278C9.83686 0.0178223 9.81891 0.0356445 9.783 0.0356445C9.20842 0.124878 8.70565 0.374573 8.29268 0.784851L4.14488 4.90521C3.57029 5.47601 3.283 6.18951 3.31892 7.01001C3.33686 7.38464 3.42665 7.74133 3.60621 8.09808L4.43217 7.27759C4.46809 7.25977 4.46809 7.18842 4.46809 7.15271C4.41421 6.59979 4.57582 6.11816 4.97085 5.72577L8.54405 2.17615L9.13659 1.58752C9.76504 0.998901 10.7167 0.998901 11.3452 1.58752C12.0095 2.21179 12.0095 3.2464 11.3452 3.90637L7.25123 7.97327C6.8562 8.36566 6.38936 8.54401 5.83273 8.49054C5.77885 8.47266 5.72499 8.47272 5.68908 8.50836L4.86311 9.32886C4.95289 9.36456 5.00676 9.40021 5.06062 9.41803C6.15593 9.81049 7.17941 9.66779 8.02333 8.84729C9.45979 7.45599 10.8783 6.06464 12.2609 4.6377C13.7333 3.12152 12.9971 0.606445 10.9501 0.0713501C10.8805 0.0614624 10.8164 0.0461426 10.7548 0.0313721ZM7.34082 7.47388C7.62811 7.2063 7.9154 6.9209 8.20269 6.6355C8.18016 6.62988 8.16114 6.62427 8.14401 6.6192C8.10655 6.60822 8.07805 6.59985 8.04109 6.59985C7.03556 6.15393 5.83253 6.3501 5.04246 7.11713C3.606 8.52625 2.1875 9.93542 0.768994 11.3624C0.14053 11.9867 -0.0928837 12.7715 0.032803 13.6277C0.194409 14.7515 0.840817 15.5184 1.9002 15.8752C2.97755 16.2319 3.94717 16.0001 4.75517 15.2152C5.6766 14.3118 6.59005 13.4004 7.50616 12.4864C7.96467 12.0289 8.42384 11.5708 8.88501 11.1127C9.56733 10.4348 9.81871 9.61432 9.67506 8.66895C9.63916 8.41925 9.56733 8.16949 9.42369 7.9198C9.13639 8.2052 8.8491 8.47272 8.57975 8.75812C8.54385 8.776 8.54385 8.84735 8.54385 8.90082C8.61567 9.41809 8.47203 9.8819 8.09495 10.2565C6.71235 11.6478 5.31181 13.0391 3.91125 14.4125C3.51623 14.8228 2.99551 14.9655 2.43889 14.8406C1.81042 14.6979 1.4154 14.3234 1.23584 13.7347C1.05629 13.1282 1.19993 12.5753 1.64882 12.1294C2.34011 11.4337 3.03141 10.747 3.72271 10.0603C4.41401 9.37354 5.10531 8.68677 5.79661 7.99115C6.17369 7.59869 6.65849 7.45599 7.19717 7.50952C7.25103 7.50952 7.3049 7.50952 7.34082 7.47388Z" fill="#808495"></path></svg></div></h3><p>As we explained, you should cache data objects with <code>st.cache_data</code>. But this can be slow for extremely large data, e.g., DataFrames or arrays with &gt;100 million rows. That&#x27;s because of the <a href="#copying-behavior">copying behavior</a> of <code>st.cache_data</code>: on the first run, it serializes the return value to bytes and deserializes it on subsequent runs. Both operations take time.</p><p>If you&#x27;re dealing with extremely large data, it can make sense to use <code>st.cache_resource</code> instead. It does not create a copy of the return value via serialization/deserialization and is almost instant. But watch out: any mutation to the function&#x27;s return value (such as dropping a column from a DataFrame or setting a value in an array) directly manipulates the object in the cache. You must ensure this doesn&#x27;t corrupt your data or lead to crashes. See the section on <a href="#mutation-and-concurrency-issues">Mutation and concurrency issues</a> below.</p><p>When benchmarking <code>st.cache_data</code> on pandas DataFrames with four columns, we found that it becomes slow when going beyond 100 million rows. The table shows runtimes for both caching decorators at different numbers of rows (all with four columns):</p><table><thead><tr><th></th><th></th><th align="center">10M rows</th><th align="center">50M rows</th><th align="center">100M rows</th><th align="center">200M rows</th></tr></thead><tbody><tr><td>st.cache_data</td><td>First run<!-- -->*</td><td align="center">0.4 s</td><td align="center">3 s</td><td align="center">14 s</td><td align="center">28 s</td></tr><tr><td></td><td>Subsequent runs</td><td align="center">0.2 s</td><td align="center">1 s</td><td align="center">2 s</td><td align="center">7 s</td></tr><tr><td>st.cache_resource</td><td>First run<!-- -->*</td><td align="center">0.01 s</td><td align="center">0.1 s</td><td align="center">0.2 s</td><td align="center">1 s</td></tr><tr><td></td><td>Subsequent runs</td><td align="center">0 s</td><td align="center">0 s</td><td align="center">0 s</td><td align="center">0 s</td></tr></tbody></table><table><thead><tr><th align="left"></th></tr></thead><tbody><tr><td align="left"><em>*<!-- -->For the first run, the table only shows the overhead time of using the caching decorator. It does not include the runtime of the cached function itself.</em></td></tr></tbody></table><a name="mutation-and-concurrency-issues" class="headerLink_HashLink___Wih5"></a><h3 class="headerLink_HeaderContainer__68tak group"><a aria-hidden="true" tabindex="-1" href="#mutation-and-concurrency-issues"><span class="icon icon-link"></span></a>Mutation and concurrency issues<div class="headerLink_CopyLink__Lvpqb"><svg width="14" height="17" viewBox="0 0 14 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.7548 0.0313721C10.7051 0.0194702 10.6571 0.00793457 10.609 0H9.87278C9.83686 0.0178223 9.81891 0.0356445 9.783 0.0356445C9.20842 0.124878 8.70565 0.374573 8.29268 0.784851L4.14488 4.90521C3.57029 5.47601 3.283 6.18951 3.31892 7.01001C3.33686 7.38464 3.42665 7.74133 3.60621 8.09808L4.43217 7.27759C4.46809 7.25977 4.46809 7.18842 4.46809 7.15271C4.41421 6.59979 4.57582 6.11816 4.97085 5.72577L8.54405 2.17615L9.13659 1.58752C9.76504 0.998901 10.7167 0.998901 11.3452 1.58752C12.0095 2.21179 12.0095 3.2464 11.3452 3.90637L7.25123 7.97327C6.8562 8.36566 6.38936 8.54401 5.83273 8.49054C5.77885 8.47266 5.72499 8.47272 5.68908 8.50836L4.86311 9.32886C4.95289 9.36456 5.00676 9.40021 5.06062 9.41803C6.15593 9.81049 7.17941 9.66779 8.02333 8.84729C9.45979 7.45599 10.8783 6.06464 12.2609 4.6377C13.7333 3.12152 12.9971 0.606445 10.9501 0.0713501C10.8805 0.0614624 10.8164 0.0461426 10.7548 0.0313721ZM7.34082 7.47388C7.62811 7.2063 7.9154 6.9209 8.20269 6.6355C8.18016 6.62988 8.16114 6.62427 8.14401 6.6192C8.10655 6.60822 8.07805 6.59985 8.04109 6.59985C7.03556 6.15393 5.83253 6.3501 5.04246 7.11713C3.606 8.52625 2.1875 9.93542 0.768994 11.3624C0.14053 11.9867 -0.0928837 12.7715 0.032803 13.6277C0.194409 14.7515 0.840817 15.5184 1.9002 15.8752C2.97755 16.2319 3.94717 16.0001 4.75517 15.2152C5.6766 14.3118 6.59005 13.4004 7.50616 12.4864C7.96467 12.0289 8.42384 11.5708 8.88501 11.1127C9.56733 10.4348 9.81871 9.61432 9.67506 8.66895C9.63916 8.41925 9.56733 8.16949 9.42369 7.9198C9.13639 8.2052 8.8491 8.47272 8.57975 8.75812C8.54385 8.776 8.54385 8.84735 8.54385 8.90082C8.61567 9.41809 8.47203 9.8819 8.09495 10.2565C6.71235 11.6478 5.31181 13.0391 3.91125 14.4125C3.51623 14.8228 2.99551 14.9655 2.43889 14.8406C1.81042 14.6979 1.4154 14.3234 1.23584 13.7347C1.05629 13.1282 1.19993 12.5753 1.64882 12.1294C2.34011 11.4337 3.03141 10.747 3.72271 10.0603C4.41401 9.37354 5.10531 8.68677 5.79661 7.99115C6.17369 7.59869 6.65849 7.45599 7.19717 7.50952C7.25103 7.50952 7.3049 7.50952 7.34082 7.47388Z" fill="#808495"></path></svg></div></h3><p>In the sections above, we talked a lot about issues when mutating return objects of cached functions. This topic is complicated! But it&#x27;s central to understanding the behavior differences between <code>st.cache_data</code> and <code>st.cache_resource</code>. So let&#x27;s dive in a bit deeper.</p><p>First, we should clearly define what we mean by mutations and concurrency:</p><ul><li><p>By <strong>mutations</strong>, we mean any changes made to a cached function&#x27;s return value <em>after</em> that function has been called. I.e. something like this:</p><section class="code_Container__v4rq_"><pre><code class="language-python">@st.cache_data
def create_list():
    l = [1, 2, 3]

l = create_list()  # ðŸ‘ˆ Call the function
l[0] = 2  # ðŸ‘ˆ Mutate its return value
</code></pre></section></li><li><p>By <strong>concurrency</strong>, we mean that multiple sessions can cause these mutations at the same time. Streamlit is a web framework that needs to handle many users and sessions connecting to an app. If two people view an app at the same time, they will both cause the Python script to rerun, which may manipulate cached return objects at the same time â€“ concurrently.</p></li></ul><p>Mutating cached return objects can be dangerous. It can lead to exceptions in your app and even corrupt your data (which can be worse than a crashed app!). Below, we&#x27;ll first explain the copying behavior of <code>st.cache_data</code> and show how it can avoid mutation issues. Then, we&#x27;ll show how concurrent mutations can lead to data corruption and how to prevent it.</p><h4 id="copying-behavior"><a aria-hidden="true" tabindex="-1" href="#copying-behavior"><span class="icon icon-link"></span></a>Copying behavior</h4><p><code>st.cache_data</code> creates a copy of the cached return value each time the function is called. This avoids most mutations and concurrency issues. To understand it in detail, let&#x27;s go back to the <a href="#usage">Uber ridesharing example</a> from the section on <code>st.cache_data</code> above. We are making two modifications to it:</p><ol><li>We are using <code>st.cache_resource</code> instead of <code>st.cache_data</code>. <code>st.cache_resource</code> does <strong>not</strong> create a copy of the cached object, so we can see what happens without the copying behavior.</li><li>After loading the data, we manipulate the returned DataFrame (in place!) by dropping the column <code>&quot;Lat&quot;</code>.</li></ol><p>Here&#x27;s the code:</p><section class="code_Container__v4rq_"><pre><code class="language-python">@st.cache_resource   # ðŸ‘ˆ Turn off copying behavior
def load_data(url):
    df = pd.read_csv(url)
    return df

df = load_data(&quot;https://raw.githubusercontent.com/plotly/datasets/master/uber-rides-data1.csv&quot;)
st.dataframe(df)

df.drop(columns=[&#x27;Lat&#x27;], inplace=True)  # ðŸ‘ˆ Mutate the dataframe inplace

st.button(&quot;Rerun&quot;)
</code></pre></section><p>Let&#x27;s run it and see what happens! The first run should work fine. But in the second run, you see an exception: <code>KeyError: &quot;[&#x27;Lat&#x27;] not found in axis&quot;</code>. Why is that happening? Let&#x27;s go step by step:</p><ul><li>On the first run, Streamlit runs <code>load_data</code> and stores the resulting DataFrame in the cache. Since we&#x27;re using <code>st.cache_resource</code>, it does <strong>not</strong> create a copy but stores the original DataFrame.</li><li>Then we drop the column <code>&quot;Lat&quot;</code> from the DataFrame. Note that this is dropping the column from the <em>original</em> DataFrame stored in the cache. We are manipulating it!</li><li>On the second run, Streamlit returns that exact same manipulated DataFrame from the cache. It does not have the column <code>&quot;Lat&quot;</code> anymore! So our call to <code>df.drop</code> results in an exception. Pandas cannot drop a column that doesn&#x27;t exist.</li></ul><p>The copying behavior of <code>st.cache_data</code> prevents this kind of mutation error. Mutations can only affect a specific copy and not the underlying object in the cache. The next rerun will get its own, unmutated copy of the DataFrame. You can try it yourself, just replace <code>st.cache_resource</code> with <code>st.cache_data</code> above, and you&#x27;ll see that everything works.</p><p>Because of this copying behavior,Â <code>st.cache_data</code>Â is the recommended way to cache data transforms and computations â€“ anything that returns a serializable object.</p><h4 id="concurrency-issues"><a aria-hidden="true" tabindex="-1" href="#concurrency-issues"><span class="icon icon-link"></span></a>Concurrency issues</h4><p>Now let&#x27;s look at what can happen when multiple users concurrently mutate an object in the cache. Let&#x27;s say you have a function that returns a list. Again, we are using <code>st.cache_resource</code> to cache it so that we are not creating a copy:</p><section class="code_Container__v4rq_"><pre><code class="language-python">@st.cache_resource
def create_list():
    l = [1, 2, 3]
    return l

l = create_list()
first_list_value = l[0]
l[0] = first_list_value + 1

st.write(&quot;l[0] is:&quot;, l[0])
</code></pre></section><p>Let&#x27;s say user A runs the app. They will see the following output:</p><section class="code_Container__v4rq_"><pre><code class="language-python">l[0] is: 2
</code></pre></section><p>Let&#x27;s say another user, B, visits the app right after. In contrast to user A, they will see the following output:</p><section class="code_Container__v4rq_"><pre><code class="language-python">l[0] is: 3
</code></pre></section><p>Now, user A reruns the app immediately after user B. They will see the following output:</p><section class="code_Container__v4rq_"><pre><code class="language-python">l[0] is: 4
</code></pre></section><p>What is happening here? Why are all outputs different?</p><ul><li>When user A visits the app,Â <code>create_list()</code>Â is called, and the listÂ <code>[1, 2, 3]</code>Â is stored in the cache. This list is then returned to user A. The first value of the list, <code>1</code>, is assigned to <code>first_list_value</code> , and <code>l[0]</code>Â is changed to <code>2</code>.</li><li>When user B visits the app,Â <code>create_list()</code>Â returns the mutated list from the cache:Â <code>[2, 2, 3]</code>. The first value of the list, <code>2</code>, is assigned to <code>first_list_value</code> and <code>l[0]</code>Â is changed to <code>3</code>.</li><li>When user A reruns the app,Â <code>create_list()</code>Â returns the mutated list again:Â <code>[3, 2, 3]</code>. The first value of the list, <code>3</code>, is assigned to <code>first_list_value,</code> and <code>l[0]</code>Â is changed to 4.</li></ul><p>If you think about it, this makes sense. Users A and B use the same list object (the one stored in the cache). And since the list object is mutated, user A&#x27;s change to the list object is also reflected in user B&#x27;s app.</p><p>This is why you must be careful about mutating objects cached with <code>st.cache_resource</code>, especially when multiple users access the app concurrently. If we had usedÂ <code>st.cache_data</code>Â instead ofÂ <code>st.cache_resource</code>, the app would have copied the list object for each user, and the above example would have worked as expected â€“ users A and B would have both seen:</p><section class="code_Container__v4rq_"><pre><code class="language-python">l[0] is: 2
</code></pre></section><section class="callout_Container__IU_XU note_Note__d8Rsn"><section class="iconHeader_Container__w4_WA"><i class="iconHeader_Icon__X6Kz_ iconHeader_LightBlueBackground__WINgP" style="transform:rotate(45deg)">push_pin</i><h4 class="iconHeader_Title__vFC9I iconHeader_LightBlueText__XIICP">Note</h4></section><p>This toy example might seem benign. But data corruption can be extremely dangerous! Imagine we had worked with the financial records of a large bank here. You surely don&#x27;t want to wake up with less money on your account just because someone used the wrong caching decorator ðŸ˜‰</p></section><a name="migrating-from-stcache" class="headerLink_HashLink___Wih5"></a><h2 class="headerLink_HeaderContainer__68tak group"><a aria-hidden="true" tabindex="-1" href="#migrating-from-stcache"><span class="icon icon-link"></span></a>Migrating from st.cache<div class="headerLink_CopyLink__Lvpqb"><svg width="14" height="17" viewBox="0 0 14 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.7548 0.0313721C10.7051 0.0194702 10.6571 0.00793457 10.609 0H9.87278C9.83686 0.0178223 9.81891 0.0356445 9.783 0.0356445C9.20842 0.124878 8.70565 0.374573 8.29268 0.784851L4.14488 4.90521C3.57029 5.47601 3.283 6.18951 3.31892 7.01001C3.33686 7.38464 3.42665 7.74133 3.60621 8.09808L4.43217 7.27759C4.46809 7.25977 4.46809 7.18842 4.46809 7.15271C4.41421 6.59979 4.57582 6.11816 4.97085 5.72577L8.54405 2.17615L9.13659 1.58752C9.76504 0.998901 10.7167 0.998901 11.3452 1.58752C12.0095 2.21179 12.0095 3.2464 11.3452 3.90637L7.25123 7.97327C6.8562 8.36566 6.38936 8.54401 5.83273 8.49054C5.77885 8.47266 5.72499 8.47272 5.68908 8.50836L4.86311 9.32886C4.95289 9.36456 5.00676 9.40021 5.06062 9.41803C6.15593 9.81049 7.17941 9.66779 8.02333 8.84729C9.45979 7.45599 10.8783 6.06464 12.2609 4.6377C13.7333 3.12152 12.9971 0.606445 10.9501 0.0713501C10.8805 0.0614624 10.8164 0.0461426 10.7548 0.0313721ZM7.34082 7.47388C7.62811 7.2063 7.9154 6.9209 8.20269 6.6355C8.18016 6.62988 8.16114 6.62427 8.14401 6.6192C8.10655 6.60822 8.07805 6.59985 8.04109 6.59985C7.03556 6.15393 5.83253 6.3501 5.04246 7.11713C3.606 8.52625 2.1875 9.93542 0.768994 11.3624C0.14053 11.9867 -0.0928837 12.7715 0.032803 13.6277C0.194409 14.7515 0.840817 15.5184 1.9002 15.8752C2.97755 16.2319 3.94717 16.0001 4.75517 15.2152C5.6766 14.3118 6.59005 13.4004 7.50616 12.4864C7.96467 12.0289 8.42384 11.5708 8.88501 11.1127C9.56733 10.4348 9.81871 9.61432 9.67506 8.66895C9.63916 8.41925 9.56733 8.16949 9.42369 7.9198C9.13639 8.2052 8.8491 8.47272 8.57975 8.75812C8.54385 8.776 8.54385 8.84735 8.54385 8.90082C8.61567 9.41809 8.47203 9.8819 8.09495 10.2565C6.71235 11.6478 5.31181 13.0391 3.91125 14.4125C3.51623 14.8228 2.99551 14.9655 2.43889 14.8406C1.81042 14.6979 1.4154 14.3234 1.23584 13.7347C1.05629 13.1282 1.19993 12.5753 1.64882 12.1294C2.34011 11.4337 3.03141 10.747 3.72271 10.0603C4.41401 9.37354 5.10531 8.68677 5.79661 7.99115C6.17369 7.59869 6.65849 7.45599 7.19717 7.50952C7.25103 7.50952 7.3049 7.50952 7.34082 7.47388Z" fill="#808495"></path></svg></div></h2><p>We introduced the caching commands described above in Streamlit 1.18.0. Before that, we had one catch-all command <code>st.cache</code>. Using it was often confusing, resulted in weird exceptions, and was slow. That&#x27;s why we replaced <code>st.cache</code> with the new commands in 1.18.0 (read more in this <a href="https://blog.streamlit.io/introducing-two-new-caching-commands-to-replace-st-cache/">blog post</a>). The new commands provide a more intuitive and efficient way to cache your data and resources and are intended to replace <code>st.cache</code> in all new development.</p><p>If your app is still using <code>st.cache</code>, don&#x27;t despair! Here are a few notes on migrating:</p><ul><li><code>st.cache</code> is deprecated. â€¢ New versions of Streamlit will show a deprecation warning if your app uses it.</li><li>We will not remove <code>st.cache</code> soon, so you don&#x27;t need to worry about your 2-year-old app breaking. But we encourage you to try the new commands going forward â€“ they will be way less annoying!</li><li>Switching code to the new commands should be easy in most cases. To decide whether to use <code>st.cache_data</code> or <code>st.cache_resource</code>, read <a href="#deciding-which-caching-decorator-to-use">Deciding which caching decorator to use</a>. Streamlit will also recognize common use cases and show hints right in the deprecation warnings.</li><li>Most parameters from <code>st.cache</code> are also present in the new commands, with a few exceptions:<ul><li><code>allow_output_mutation</code> does not exist anymore. You can safely delete it. Just make sure you use the right caching command for your use case.</li><li><code>suppress_st_warning</code> does not exist anymore. You can safely delete it. Cached functions can now contain Streamlit commands and will replay them. If you want to use widgets inside cached functions, set <code>experimental_allow_widgets=True</code>. See <a href="#using-streamlit-commands-in-cached-functions">here</a>.</li><li><code>hash_funcs</code> does not exist anymore. You can exclude parameters from caching (and being hashed) by prepending them with an underscore: <code>_excluded_param</code>. See <a href="#excluding-input-parameters">here</a>.</li></ul></li></ul><p>If you have any questions or issues during the migration process, please contact us on the <a href="https://discuss.streamlit.io/">forum</a>, and we will be happy to assist you. ðŸŽˆ</p><section class="arrowLink_Container__GdJWF"><a class="
              not-link
              group
              arrowLink_Link___7KkL
              undefined
            " target="_self" href="button-behavior-and-examples.html"><svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg" class="
                arrowLink_Icon__zebOf
                arrowLink_BackIcon__iFkCG
              "><path d="M7.22017 13.7159L8.70312 12.2393L4.81037 8.35298H13.9318V6.19247H4.81037L8.70312 2.29972L7.22017 0.829545L0.776989 7.27273L7.22017 13.7159Z"></path></svg><span class="arrowLink_Text__MzY9g">Previous: </span><span class="arrowLink_Truncate__7zF2m">Button behavior and examples</span></a><a class="
              not-link
              group
              arrowLink_Link___7KkL
              arrowLink_NextLink__NTH96
            " target="_self" href="cli.html"><span class="arrowLink_Text__MzY9g">Next: </span><span class="arrowLink_Truncate__7zF2m">Command-line options</span><svg width="14" height="14" viewBox="0 0 14 14" fill="text-gray-90 dark:text-white" xmlns="http://www.w3.org/2000/svg" class="
                arrowLink_Icon__zebOf
                arrowLink_NextIcon__rbDKF
              "><path d="M6.96165 13.7159L13.4048 7.27273L6.96165 0.829545L5.47869 2.30611L9.37145 6.19247H0.25V8.35298H9.37145L5.47869 12.2457L6.96165 13.7159Z"></path></svg></a></section><section class="psa_Container___KGYF"><i class="psa_Icon__NFpgx">forum</i><article><h3 class="psa_Title__uL_3j">Still have questions?</h3><p class="psa_Text__4UiPe">Our<!-- --> <a href="https://discuss.streamlit.io/" target="_blank" class="psa_Link__UF5EL">forums</a> <!-- -->are full of helpful information and Streamlit experts.</p></article></section><section class="helpful_FormContainer__aXrIB"><form class='helpful_Form__O7ORb' method='POST' name='helpful'><input type="hidden" name="form-name" value="helpful"/><input type="hidden" name="url" value="/library/advanced-features/caching"/><input type="hidden" name="was_helpful" value="true"/><input type="hidden" name="improvements" value=""/><input type="hidden" name="notes" value=""/><section class="helpful_Container__V1dv8"><p class="helpful_Title__lQBy3">Was this page helpful?</p><section class="helpful_CtaContainer__8FIxs"><button class="helpful_Button__Xv_VK"><i class="helpful_Icon___MVCB">thumb_up</i>Yes</button><button class="helpful_Button__Xv_VK"> <i class="helpful_Icon___MVCB">thumb_down</i>No</button></section></section></form><section><section class="suggestEdits_Container__eBMj0"><i class="suggestEdits_Icon__MtLji">edit</i><a class="suggestEdits_Link__JC0oe" href="https://github.com/streamlit/docs/tree/main/content/library/advanced-features/caching.md" target="_blank" rel="noopener noreferrer">Suggest edits</a></section></section></section></div></article></section><footer class="footer_Container__Qk___"><section class="footer_InnerContainer__FxrDR"><hr class="footer_Separator__wp8v6"/><nav class="footer_Navigation__gJ5KF"><a class="
                not-link
                footer_Link__hkVMK
              " href="../../index.html">Home</a><a class="
                not-link
                footer_Link__hkVMK
              " href="mailto:hello@streamlit.io?subject=Contact%20from%20documentation%20">Contact Us</a><a class="
              not-link
              footer_Link__hkVMK
            " href="https://discuss.streamlit.io/" target="_blank" rel="noopener noreferrer">Community</a></nav><section class="footer_SocialNetworks__l6y2_"><a class="
              group
              not-link
              footer_IconLink__m3oxh
            " href="https://github.com/streamlit" target="_blank" title="GitHub"><i class="footer_IconContainer__LHkRV"><svg width="22" height="20" viewBox="0 0 22 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="
                  footer_Icon__t1GVg
                  footer_GitHubIcon__O9rZh
                "><path d="M12.8513 14.5613C13.2388 14.4967 13.56 14.4506 13.8718 14.3768C16.168 13.8508 17.3491 12.4668 17.4908 10.1508C17.5664 8.98815 17.368 7.91781 16.5837 6.99511C16.5081 6.90283 16.5081 6.70907 16.5459 6.57989C16.716 5.8694 16.6688 5.17737 16.4609 4.48534C16.3759 4.20853 16.2152 4.07013 15.9601 4.1624C15.242 4.42075 14.5427 4.71602 13.8246 4.97438C13.5978 5.05742 13.3238 5.13124 13.0876 5.0851C11.6135 4.78984 10.1489 4.79906 8.6843 5.09433C8.46697 5.14047 8.21184 5.06665 7.99451 4.98361C7.32363 4.72525 6.67164 4.42075 6.00075 4.18085C5.62279 4.04244 5.33932 4.20853 5.32042 4.62375C5.29207 5.27887 5.30152 5.92477 5.28262 6.57989C5.28262 6.73675 5.28262 6.92129 5.19758 7.04124C3.00539 10.1323 4.70623 13.9246 8.56146 14.5059C8.6654 14.5244 8.77879 14.5336 8.86383 14.5428C8.70319 14.9581 8.55201 15.3733 8.37248 15.77C8.32523 15.8715 8.17405 15.9638 8.05121 16.0007C7.01181 16.3698 6.0858 16.0653 5.44326 15.1887C5.19758 14.8566 4.92356 14.5152 4.58339 14.2937C4.31882 14.1184 3.94085 14.0999 3.61013 14.0446C3.52509 14.0261 3.37391 14.1092 3.34556 14.1738C3.31721 14.2384 3.37391 14.4044 3.44005 14.4506C4.28102 14.9304 4.60229 15.7793 5.07474 16.5451C5.55665 17.3386 6.41651 17.4401 7.27638 17.4401C7.6071 17.4401 7.92837 17.394 8.32523 17.3571C8.32523 18.003 8.34413 18.612 8.31578 19.221C8.29688 19.6177 7.94727 19.8023 7.50316 19.6085C6.69054 19.2579 5.84957 18.9165 5.11254 18.4367C1.58803 16.1484 -0.112807 11.9408 0.803755 7.90858C1.71087 3.88558 5.07474 0.776064 9.23234 0.130169C14.4671 -0.69104 19.5319 2.51075 20.8642 7.49337C22.2059 12.4944 19.4563 17.717 14.5522 19.5162C13.7018 19.83 13.4655 19.6639 13.4655 18.7781C13.475 18.1783 13.475 17.5785 13.4844 16.9788C13.5033 16.1299 13.5033 15.2902 12.8513 14.5613Z"></path></svg></i></a><a class="
              group
              not-link
              footer_IconLink__m3oxh
            " href="https://www.reddit.com/r/StreamlitOfficial/" target="_blank" title="Reddit"><i class="footer_IconContainer__LHkRV"><svg width="113.8" height="101.6" viewBox="0 0 113.8 101.6" xmlns="http://www.w3.org/2000/svg" class="
                  footer_Icon__t1GVg
                  footer_RedditIcon__8bj3d
                "><path d="m 113.8,51.7 c 0,-6.9 -5.6,-12.5 -12.5,-12.5 -3.4,0 -6.4,1.3 -8.6,3.5 C 84.2,36.6 72.4,32.6 59.4,32.1 L 65.1,5.4 83.6,9.3 c 0.2,4.7 4.1,8.5 8.9,8.5 4.9,0 8.9,-4 8.9,-8.9 C 101.4,4 97.4,0 92.5,0 89,0 86,2 84.6,5 L 63.9,0.6 c -0.6,-0.1 -1.2,0 -1.7,0.3 -0.5,0.3 -0.8,0.8 -1,1.4 L 54.9,32.1 C 41.6,32.5 29.7,36.4 21.1,42.7 18.9,40.6 15.8,39.2 12.5,39.2 5.6,39.2 0,44.8 0,51.7 c 0,5.1 3,9.4 7.4,11.4 -0.2,1.2 -0.3,2.5 -0.3,3.8 0,19.2 22.3,34.7 49.9,34.7 27.6,0 49.9,-15.5 49.9,-34.7 0,-1.3 -0.1,-2.5 -0.3,-3.7 4.1,-2 7.2,-6.4 7.2,-11.5 z"></path></svg></i></a><a class="
              group
              not-link
              footer_IconLink__m3oxh
            " href="https://discord.gg/bTz5EDYh9Z" target="_blank" title="Discord"><i class="footer_IconContainer__LHkRV"><svg width="71" height="55" viewBox="0 0 71 55" xmlns="http://www.w3.org/2000/svg" class="
                  footer_Icon__t1GVg
                  footer_DiscordIcon__95Qe9
                "><path d="M60.1045 4.8978C55.5792 2.8214 50.7265 1.2916 45.6527 0.41542C45.5603 0.39851 45.468 0.440769 45.4204 0.525289C44.7963 1.6353 44.105 3.0834 43.6209 4.2216C38.1637 3.4046 32.7345 3.4046 27.3892 4.2216C26.905 3.0581 26.1886 1.6353 25.5617 0.525289C25.5141 0.443589 25.4218 0.40133 25.3294 0.41542C20.2584 1.2888 15.4057 2.8186 10.8776 4.8978C10.8384 4.9147 10.8048 4.9429 10.7825 4.9795C1.57795 18.7309 -0.943561 32.1443 0.293408 45.3914C0.299005 45.4562 0.335386 45.5182 0.385761 45.5576C6.45866 50.0174 12.3413 52.7249 18.1147 54.5195C18.2071 54.5477 18.305 54.5139 18.3638 54.4378C19.7295 52.5728 20.9469 50.6063 21.9907 48.5383C22.0523 48.4172 21.9935 48.2735 21.8676 48.2256C19.9366 47.4931 18.0979 46.6 16.3292 45.5858C16.1893 45.5041 16.1781 45.304 16.3068 45.2082C16.679 44.9293 17.0513 44.6391 17.4067 44.3461C17.471 44.2926 17.5606 44.2813 17.6362 44.3151C29.2558 49.6202 41.8354 49.6202 53.3179 44.3151C53.3935 44.2785 53.4831 44.2898 53.5502 44.3433C53.9057 44.6363 54.2779 44.9293 54.6529 45.2082C54.7816 45.304 54.7732 45.5041 54.6333 45.5858C52.8646 46.6197 51.0259 47.4931 49.0921 48.2228C48.9662 48.2707 48.9102 48.4172 48.9718 48.5383C50.038 50.6034 51.2554 52.5699 52.5959 54.435C52.6519 54.5139 52.7526 54.5477 52.845 54.5195C58.6464 52.7249 64.529 50.0174 70.6019 45.5576C70.6551 45.5182 70.6887 45.459 70.6943 45.3942C72.1747 30.0791 68.2147 16.7757 60.1968 4.9823C60.1772 4.9429 60.1437 4.9147 60.1045 4.8978ZM23.7259 37.3253C20.2276 37.3253 17.3451 34.1136 17.3451 30.1693C17.3451 26.225 20.1717 23.0133 23.7259 23.0133C27.308 23.0133 30.1626 26.2532 30.1066 30.1693C30.1066 34.1136 27.28 37.3253 23.7259 37.3253ZM47.3178 37.3253C43.8196 37.3253 40.9371 34.1136 40.9371 30.1693C40.9371 26.225 43.7636 23.0133 47.3178 23.0133C50.9 23.0133 53.7545 26.2532 53.6986 30.1693C53.6986 34.1136 50.9 37.3253 47.3178 37.3253Z"></path></svg></i></a><a class="
              group
              not-link
              footer_IconLink__m3oxh
            " href="https://www.youtube.com/channel/UC3LD42rjj-Owtxsa6PwGU5Q" target="_blank" title="YouTube"><i class="footer_IconContainer__LHkRV"><svg width="26" height="18" viewBox="0 0 26 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="
                  footer_Icon__t1GVg
                  footer_YouTubeIcon__6k_nz
                "><path d="M12.8276 17.8757C11.0323 17.845 9.2319 17.845 7.43665 17.7734C6.06686 17.7172 4.69189 17.6251 3.33767 17.4308C1.63581 17.1853 0.546208 16.0449 0.333476 14.3471C0.17263 13.0227 0.058481 11.6879 0.0221609 10.3532C-0.0193478 8.93159 0.0117837 7.50995 0.0792353 6.0883C0.125933 5.13713 0.271213 4.19107 0.411305 3.25012C0.634414 1.74666 2.0509 0.723891 3.25984 0.57559C4.56736 0.417061 5.89045 0.284101 7.20835 0.253418C10.1555 0.186939 13.1026 0.156256 16.0445 0.181825C17.8398 0.197166 19.635 0.325012 21.4251 0.422175C21.8972 0.447744 22.3694 0.514224 22.8364 0.606273C24.284 0.892648 25.1609 1.77223 25.4722 3.18364C25.7627 4.49279 25.8406 5.8275 25.908 7.16221C26.017 9.37138 25.9495 11.5703 25.6745 13.7642C25.5863 14.4443 25.5085 15.1449 25.1401 15.7483C24.5123 16.7711 23.568 17.3592 22.3746 17.4666C20.8024 17.6098 19.2251 17.7274 17.6478 17.7785C16.0445 17.8297 14.4309 17.7888 12.8276 17.7888C12.8276 17.8245 12.8276 17.8501 12.8276 17.8757ZM10.4875 12.9511C12.6667 11.6266 14.8096 10.3277 16.994 9.00319C14.7993 7.67359 12.6564 6.37468 10.4875 5.05531C10.4875 7.70427 10.4875 10.3021 10.4875 12.9511Z"></path></svg></i></a><a class="
              group
              not-link
              footer_IconLink__m3oxh
            " href="https://medium.com/streamlit" target="_blank" title="Medium"><i class="footer_IconContainer__LHkRV"><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="
                  footer_Icon__t1GVg
                  footer_MediumIcon__KmA6e
                "><path d="M13.537 11.828c0 3.77-3.03 6.827-6.768 6.827S0 15.598 0 11.828 3.03 5 6.769 5c3.738 0 6.768 3.057 6.768 6.828ZM20.964 11.828c0 3.55-1.515 6.428-3.384 6.428-1.87 0-3.385-2.879-3.385-6.428 0-3.55 1.515-6.428 3.384-6.428 1.87 0 3.385 2.878 3.385 6.428M24.002 11.829c0 3.179-.533 5.758-1.19 5.758-.658 0-1.19-2.578-1.19-5.758s.532-5.759 1.19-5.759c.656 0 1.19 2.578 1.19 5.759Z"></path></svg></i></a><a class="
              group
              not-link
              footer_IconLink__m3oxh
            " href="https://twitter.com/streamlit" target="_blank" title="Twitter"><i class="footer_IconContainer__LHkRV"><svg width="24" height="18" viewBox="0 0 24 18" xmlns="http://www.w3.org/2000/svg" class="
                  footer_Icon__t1GVg
                  footer_TwitterIcon__7AYpE
                "><path d="M22.9683 0.526535C22.5928 1.56402 21.8955 2.36683 20.9031 2.95968C21.368 2.91851 21.8239 2.83205 22.271 2.71678C22.7225 2.60562 23.1561 2.45741 23.5986 2.28449C23.5986 2.32566 23.5763 2.34625 23.5629 2.36683C22.946 3.19435 22.1994 3.91071 21.3233 4.51179C21.2428 4.56943 21.207 4.61883 21.2115 4.71764C21.2651 6.1133 21.0595 7.47603 20.6214 8.81405C20.1029 10.3867 19.3072 11.8277 18.2119 13.1287C16.9334 14.6478 15.3554 15.8376 13.469 16.6693C12.3156 17.1798 11.1042 17.5174 9.8391 17.7068C9.10597 17.8138 8.37284 17.8673 7.63078 17.8797C5.98571 17.9044 4.38982 17.6656 2.83863 17.1674C1.87305 16.8545 0.952171 16.4428 0.0804651 15.9365C0.0536434 15.92 0.0178811 15.9118 0 15.8788C2.633 16.1217 5.00672 15.5206 7.11669 14.0426C5.87395 13.9809 4.79662 13.5774 3.89362 12.787C3.29907 12.2682 2.87886 11.6465 2.62406 10.9178C3.34824 11.0372 4.05902 11.0208 4.79215 10.8478C3.3393 10.5308 2.24408 9.7939 1.52437 8.61232C1.10863 7.93301 0.920879 7.19607 0.925349 6.40149C1.60483 6.7432 2.32008 6.92847 3.10238 6.9614C2.93698 6.84201 2.78052 6.7432 2.64194 6.62793C1.82835 5.96921 1.29638 5.15404 1.07287 4.18243C0.822532 3.09554 0.992403 2.06218 1.5646 1.08645C1.61824 0.991756 1.62271 0.995873 1.69424 1.0741C2.70452 2.19392 3.88468 3.13259 5.23917 3.88189C6.67413 4.67647 8.22085 5.20756 9.87039 5.4834C10.4113 5.57398 10.9567 5.63161 11.5065 5.66043C11.5914 5.66455 11.6183 5.66043 11.6004 5.56574C11.3053 4.10009 11.6674 2.79088 12.7403 1.67106C13.5271 0.843544 14.5284 0.357738 15.7131 0.221878C17.1167 0.0571976 18.3729 0.398908 19.4726 1.23054C19.6022 1.32935 19.7184 1.43227 19.8347 1.54343C19.8749 1.58049 19.9106 1.58872 19.9732 1.58049C21.0059 1.38699 21.9714 1.04116 22.8834 0.559471C22.9057 0.543003 22.9236 0.522418 22.9683 0.526535Z"></path></svg></i></a><a class="
              group
              not-link
              footer_IconLink__m3oxh
            " href="https://www.linkedin.com/company/streamlit" target="_blank" title="LinkedIn"><i class="footer_IconContainer__LHkRV"><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="
                  footer_Icon__t1GVg
                  footer_LinkedInIcon__YRWUz
                "><path d="M22.228 0H1.772A1.772 1.772 0 0 0 0 1.772v20.456A1.772 1.772 0 0 0 1.772 24h20.456A1.772 1.772 0 0 0 24 22.228V1.772A1.772 1.772 0 0 0 22.228 0ZM7.153 20.445H3.545V8.983h3.608v11.462ZM5.347 7.395a2.072 2.072 0 1 1 2.083-2.07 2.042 2.042 0 0 1-2.083 2.07Zm15.106 13.06h-3.606v-6.262c0-1.846-.785-2.416-1.799-2.416-1.07 0-2.12.806-2.12 2.463v6.215H9.32V8.992h3.47v1.588h.047c.348-.705 1.568-1.91 3.43-1.91 2.013 0 4.188 1.195 4.188 4.695l-.002 7.09Z"></path></svg></i></a><a class="
              group
              not-link
              footer_IconLink__m3oxh
            " href="https://www.instagram.com/streamlit.io" target="_blank" title="Instagram"><i class="footer_IconContainer__LHkRV"><svg width="19" height="20" viewBox="0 0 19 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="
                  footer_Icon__t1GVg
                  footer_InstagramIcon__tx0CK
                "><defs><linearGradient id="instagram-gradient" gradientTransform="rotate(90)"><stop offset="0%" stop-color="#f09433"></stop><stop offset="25%" stop-color="#e6683c"></stop><stop offset="50%" stop-color="#dc2743"></stop><stop offset="75%" stop-color="#cc2366"></stop><stop offset="100%" stop-color="#bc1888"></stop></linearGradient></defs><path fill-rule="evenodd" clip-rule="evenodd" d="M8.82611 19.637C8.68561 19.6375 8.54507 19.6381 8.40451 19.6388C7.73077 19.6419 7.05655 19.6449 6.38357 19.6332C5.57165 19.619 4.75702 19.5933 3.96127 19.3885C2.58287 19.0358 1.50659 18.2478 0.791761 16.9477C0.411421 16.2535 0.206419 15.494 0.1201 14.7002C0.00283629 13.6378 0.00233275 12.5687 0.00182921 11.5008C0.00176817 11.3648 0.00170714 11.2289 0.00140196 11.093C-0.00128358 9.77016 -0.00128358 8.44729 0.0121899 7.12441C0.0202923 6.28237 0.0337811 5.43746 0.168654 4.60104C0.419508 3.07626 1.09927 1.8359 2.3428 0.979575C3.05491 0.490257 3.85068 0.205772 4.69227 0.137534C5.67685 0.0578835 6.66681 0.0237038 7.65408 0.00948261C9.09183 -0.00760724 10.5323 0.000937685 11.97 0.0151589C12.7927 0.0237038 13.6154 0.0407936 14.4274 0.211448C15.9218 0.524436 17.0952 1.32949 17.8558 2.74056C18.2658 3.50008 18.4682 4.33651 18.5383 5.20418C18.6354 6.39468 18.6342 7.58987 18.6329 8.78548L18.6327 9.1841C18.6327 10.413 18.6327 11.6392 18.6138 12.8682C18.6003 13.7188 18.5841 14.5751 18.3926 15.4115C17.9206 17.474 16.7229 18.8025 14.7754 19.3601C14.0902 19.5564 13.3862 19.6048 12.6794 19.619C12.2525 19.6276 11.8257 19.6351 11.3989 19.6419C10.9863 19.6485 10.5737 19.6546 10.1615 19.6605C9.88211 19.6646 9.60287 19.6687 9.32379 19.673V19.636C9.15796 19.636 8.99206 19.6364 8.82611 19.637ZM9.29681 17.9007V17.8637C9.45953 17.8637 9.62225 17.864 9.78497 17.8645L10.1925 17.8659C10.865 17.8683 11.5375 17.8707 12.2101 17.8609C12.8817 17.8523 13.5588 17.841 14.2197 17.6816C15.5711 17.3545 16.4208 16.4896 16.7472 15.0615C16.9225 14.2914 16.9303 13.5025 16.938 12.7182L16.9387 12.6463C16.9576 11.0332 16.9522 9.42306 16.9495 7.81002L16.9492 7.70217V7.70144C16.9468 6.78152 16.9444 5.85946 16.8146 4.94527C16.5907 3.355 15.6547 2.30245 14.1684 1.96676C13.4849 1.81283 12.7868 1.80239 12.0925 1.79201L11.9808 1.79037C10.9145 1.77407 9.84643 1.77492 8.77951 1.77578C8.54278 1.77596 8.30609 1.77615 8.06949 1.77615L7.83148 1.77602C6.84225 1.77523 5.85129 1.77444 4.86491 1.89559C4.27417 1.96676 3.7104 2.14315 3.21138 2.49874C2.448 3.04494 2.02449 3.82156 1.84917 4.76321C1.71429 5.48012 1.6981 6.20553 1.6954 6.92812C1.68732 9.00771 1.6981 11.0902 1.70889 13.1726C1.71159 13.7842 1.74127 14.3958 1.87074 14.9961C2.1324 16.2223 2.78787 17.0956 3.92351 17.5365C4.51425 17.7641 5.13196 17.8267 5.75238 17.8438C6.35205 17.8539 6.95312 17.8633 7.55453 17.8727L8.397 17.8859C8.69702 17.8907 8.99701 17.8956 9.29681 17.9007ZM14.0991 9.82156C14.1018 12.5868 11.9654 14.8541 9.37317 14.8769C6.71078 14.8996 4.52855 12.6266 4.53125 9.83297C4.53665 7.05355 6.66495 4.78902 9.28146 4.78615C11.9546 4.77767 14.0964 7.01937 14.0991 9.82156ZM9.31653 13.0988C11.024 13.1159 12.451 11.6081 12.424 9.75899C12.3997 8.00368 11.0024 6.55001 9.29495 6.55282C7.57937 6.55569 6.20907 8.02932 6.21176 9.87276C6.21716 11.6451 7.61984 13.1045 9.31653 13.0988ZM14.2928 3.39846C13.6859 3.39565 13.176 3.93044 13.1733 4.57052C13.1733 5.22201 13.6697 5.75686 14.2739 5.75686C14.9105 5.75967 15.4095 5.23336 15.4068 4.55917C15.4068 3.93044 14.8997 3.40133 14.2928 3.39846Z"></path></svg></i></a><a class="
              group
              not-link
              footer_IconLink__m3oxh
            " href="https://share.hsforms.com/1WGycc-S0R8qfyL2iIw_70w3wudj" target="_blank" title="Newsletter"><i class="footer_IconContainer__LHkRV"><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="
                  footer_Icon__t1GVg
                  footer_NewsletterIcon__TkRKT
                "><path d="M21.75 6.75v10.5a1.5 1.5 0 0 1-1.5 1.5H3.75a1.5 1.5 0 0 1-1.5-1.5V6.75m19.5 0a1.5 1.5 0 0 0-1.5-1.5H3.75a1.5 1.5 0 0 0-1.5 1.5m19.5 0-8.896 6.159a1.5 1.5 0 0 1-1.708 0L2.25 6.75" stroke="#a3a8b8" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none"></path></svg></i></a></section><p class="footer_Copyright__KEJ05">Copyright Â© <!-- -->2023<!-- -->, Streamlit Inc.</p></section></footer></section></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"streamlit":{},"versions":["1.11.0","1.12.0","1.13.0","1.14.0","1.15.0","1.16.0","1.17.0","1.18.0","1.19.0","1.20.0","1.21.0","1.22.0","1.23.0","1.24.0","1.25.0","1.26.0"],"versionFromStaticLoad":null,"menu":[{"menu_key":"streamlit-library","name":"Streamlit library","depth":"0","children":[{"menu_key":"get-started","name":"Get started","depth":"1","children":[{"menu_key":"installation","name":"Installation","depth":"2","children":[],"category":"Streamlit library / Get started / Installation","url":"/library/get-started/installation"},{"menu_key":"main-concepts","name":"Main concepts","depth":"2","children":[],"category":"Streamlit library / Get started / Main concepts","url":"/library/get-started/main-concepts"},{"menu_key":"create-an-app","name":"Create an app","depth":"2","children":[],"category":"Streamlit library / Get started / Create an app","url":"/library/get-started/create-an-app"},{"menu_key":"multipage-apps","name":"Multipage apps","depth":"2","children":[{"menu_key":"create-a-multipage-app","name":"Create a multipage app","depth":"3","children":[],"category":"Streamlit library / Get started / Multipage apps / Create a multipage app","url":"/library/get-started/multipage-apps/create-a-multipage-app"}],"category":"Streamlit library / Get started / Multipage apps","url":"/library/get-started/multipage-apps"}],"category":"Streamlit library / Get started","url":"/library/get-started"},{"menu_key":"api-reference","name":"API reference","depth":"1","children":[{"menu_key":"write-and-magic","name":"Write and magic","depth":"2","children":[{"menu_key":"st.write","name":"st.write","depth":"3","children":[],"category":"Streamlit library / API reference / Write and magic / st.write","url":"/library/api-reference/write-magic/st.write","isVersioned":true},{"menu_key":"magic","name":"magic","depth":"3","children":[],"category":"Streamlit library / API reference / Write and magic / magic","url":"/library/api-reference/write-magic/magic"}],"category":"Streamlit library / API reference / Write and magic","url":"/library/api-reference/write-magic"},{"menu_key":"text-elements","name":"Text elements","depth":"2","children":[{"menu_key":"st.markdown","name":"st.markdown","depth":"3","children":[],"category":"Streamlit library / API reference / Text elements / st.markdown","url":"/library/api-reference/text/st.markdown","isVersioned":true},{"menu_key":"st.title","name":"st.title","depth":"3","children":[],"category":"Streamlit library / API reference / Text elements / st.title","url":"/library/api-reference/text/st.title","isVersioned":true},{"menu_key":"st.header","name":"st.header","depth":"3","children":[],"category":"Streamlit library / API reference / Text elements / st.header","url":"/library/api-reference/text/st.header","isVersioned":true},{"menu_key":"st.subheader","name":"st.subheader","depth":"3","children":[],"category":"Streamlit library / API reference / Text elements / st.subheader","url":"/library/api-reference/text/st.subheader","isVersioned":true},{"menu_key":"st.caption","name":"st.caption","depth":"3","children":[],"category":"Streamlit library / API reference / Text elements / st.caption","url":"/library/api-reference/text/st.caption","isVersioned":true},{"menu_key":"st.code","name":"st.code","depth":"3","children":[],"category":"Streamlit library / API reference / Text elements / st.code","url":"/library/api-reference/text/st.code","isVersioned":true},{"menu_key":"st.text","name":"st.text","depth":"3","children":[],"category":"Streamlit library / API reference / Text elements / st.text","url":"/library/api-reference/text/st.text","isVersioned":true},{"menu_key":"st.latex","name":"st.latex","depth":"3","children":[],"category":"Streamlit library / API reference / Text elements / st.latex","url":"/library/api-reference/text/st.latex","isVersioned":true},{"menu_key":"st.divider","name":"st.divider","depth":"3","children":[],"category":"Streamlit library / API reference / Text elements / st.divider","url":"/library/api-reference/text/st.divider","isVersioned":true}],"category":"Streamlit library / API reference / Text elements","url":"/library/api-reference/text"},{"menu_key":"data-elements","name":"Data elements","depth":"2","children":[{"menu_key":"st.dataframe","name":"st.dataframe","depth":"3","children":[],"category":"Streamlit library / API reference / Data elements / st.dataframe","url":"/library/api-reference/data/st.dataframe","isVersioned":true},{"menu_key":"st.data_editor","name":"st.data_editor","depth":"3","children":[],"category":"Streamlit library / API reference / Data elements / st.data_editor","url":"/library/api-reference/data/st.data_editor","isVersioned":true},{"menu_key":"st.column_config","name":"st.column_config","depth":"3","children":[{"menu_key":"column","name":"Column","depth":"4","children":[],"category":"Streamlit library / API reference / Data elements / st.column_config / Column","url":"/library/api-reference/data/st.column_config/st.column_config.column","isVersioned":true},{"menu_key":"text-column","name":"Text column","depth":"4","children":[],"category":"Streamlit library / API reference / Data elements / st.column_config / Text column","url":"/library/api-reference/data/st.column_config/st.column_config.textcolumn","isVersioned":true},{"menu_key":"number-column","name":"Number column","depth":"4","children":[],"category":"Streamlit library / API reference / Data elements / st.column_config / Number column","url":"/library/api-reference/data/st.column_config/st.column_config.numbercolumn","isVersioned":true},{"menu_key":"checkbox-column","name":"Checkbox column","depth":"4","children":[],"category":"Streamlit library / API reference / Data elements / st.column_config / Checkbox column","url":"/library/api-reference/data/st.column_config/st.column_config.checkboxcolumn","isVersioned":true},{"menu_key":"selectbox-column","name":"Selectbox column","depth":"4","children":[],"category":"Streamlit library / API reference / Data elements / st.column_config / Selectbox column","url":"/library/api-reference/data/st.column_config/st.column_config.selectboxcolumn","isVersioned":true},{"menu_key":"datetime-column","name":"Datetime column","depth":"4","children":[],"category":"Streamlit library / API reference / Data elements / st.column_config / Datetime column","url":"/library/api-reference/data/st.column_config/st.column_config.datetimecolumn","isVersioned":true},{"menu_key":"date-column","name":"Date column","depth":"4","children":[],"category":"Streamlit library / API reference / Data elements / st.column_config / Date column","url":"/library/api-reference/data/st.column_config/st.column_config.datecolumn","isVersioned":true},{"menu_key":"time-column","name":"Time column","depth":"4","children":[],"category":"Streamlit library / API reference / Data elements / st.column_config / Time column","url":"/library/api-reference/data/st.column_config/st.column_config.timecolumn","isVersioned":true},{"menu_key":"list-column","name":"List column","depth":"4","children":[],"category":"Streamlit library / API reference / Data elements / st.column_config / List column","url":"/library/api-reference/data/st.column_config/st.column_config.listcolumn","isVersioned":true},{"menu_key":"link-column","name":"Link column","depth":"4","children":[],"category":"Streamlit library / API reference / Data elements / st.column_config / Link column","url":"/library/api-reference/data/st.column_config/st.column_config.linkcolumn","isVersioned":true},{"menu_key":"image-column","name":"Image column","depth":"4","children":[],"category":"Streamlit library / API reference / Data elements / st.column_config / Image column","url":"/library/api-reference/data/st.column_config/st.column_config.imagecolumn","isVersioned":true},{"menu_key":"line-chart-column","name":"Line chart column","depth":"4","children":[],"category":"Streamlit library / API reference / Data elements / st.column_config / Line chart column","url":"/library/api-reference/data/st.column_config/st.column_config.linechartcolumn","isVersioned":true},{"menu_key":"bar-chart-column","name":"Bar chart column","depth":"4","children":[],"category":"Streamlit library / API reference / Data elements / st.column_config / Bar chart column","url":"/library/api-reference/data/st.column_config/st.column_config.barchartcolumn","isVersioned":true},{"menu_key":"progress-column","name":"Progress column","depth":"4","children":[],"category":"Streamlit library / API reference / Data elements / st.column_config / Progress column","url":"/library/api-reference/data/st.column_config/st.column_config.progresscolumn","isVersioned":true}],"category":"Streamlit library / API reference / Data elements / st.column_config","url":"/library/api-reference/data/st.column_config","isVersioned":true},{"menu_key":"st.table","name":"st.table","depth":"3","children":[],"category":"Streamlit library / API reference / Data elements / st.table","url":"/library/api-reference/data/st.table","isVersioned":true},{"menu_key":"st.metric","name":"st.metric","depth":"3","children":[],"category":"Streamlit library / API reference / Data elements / st.metric","url":"/library/api-reference/data/st.metric","isVersioned":true},{"menu_key":"st.json","name":"st.json","depth":"3","children":[],"category":"Streamlit library / API reference / Data elements / st.json","url":"/library/api-reference/data/st.json","isVersioned":true}],"category":"Streamlit library / API reference / Data elements","url":"/library/api-reference/data"},{"menu_key":"chart-elements","name":"Chart elements","depth":"2","children":[{"menu_key":"st.line_chart","name":"st.line_chart","depth":"3","children":[],"category":"Streamlit library / API reference / Chart elements / st.line_chart","url":"/library/api-reference/charts/st.line_chart","isVersioned":true},{"menu_key":"st.area_chart","name":"st.area_chart","depth":"3","children":[],"category":"Streamlit library / API reference / Chart elements / st.area_chart","url":"/library/api-reference/charts/st.area_chart","isVersioned":true},{"menu_key":"st.bar_chart","name":"st.bar_chart","depth":"3","children":[],"category":"Streamlit library / API reference / Chart elements / st.bar_chart","url":"/library/api-reference/charts/st.bar_chart","isVersioned":true},{"menu_key":"st.pyplot","name":"st.pyplot","depth":"3","children":[],"category":"Streamlit library / API reference / Chart elements / st.pyplot","url":"/library/api-reference/charts/st.pyplot","isVersioned":true},{"menu_key":"st.altair_chart","name":"st.altair_chart","depth":"3","children":[],"category":"Streamlit library / API reference / Chart elements / st.altair_chart","url":"/library/api-reference/charts/st.altair_chart","isVersioned":true},{"menu_key":"st.vega_lite_chart","name":"st.vega_lite_chart","depth":"3","children":[],"category":"Streamlit library / API reference / Chart elements / st.vega_lite_chart","url":"/library/api-reference/charts/st.vega_lite_chart","isVersioned":true},{"menu_key":"st.plotly_chart","name":"st.plotly_chart","depth":"3","children":[],"category":"Streamlit library / API reference / Chart elements / st.plotly_chart","url":"/library/api-reference/charts/st.plotly_chart","isVersioned":true},{"menu_key":"st.bokeh_chart","name":"st.bokeh_chart","depth":"3","children":[],"category":"Streamlit library / API reference / Chart elements / st.bokeh_chart","url":"/library/api-reference/charts/st.bokeh_chart","isVersioned":true},{"menu_key":"st.pydeck_chart","name":"st.pydeck_chart","depth":"3","children":[],"category":"Streamlit library / API reference / Chart elements / st.pydeck_chart","url":"/library/api-reference/charts/st.pydeck_chart","isVersioned":true},{"menu_key":"st.graphviz_chart","name":"st.graphviz_chart","depth":"3","children":[],"category":"Streamlit library / API reference / Chart elements / st.graphviz_chart","url":"/library/api-reference/charts/st.graphviz_chart","isVersioned":true},{"menu_key":"st.map","name":"st.map","depth":"3","children":[],"category":"Streamlit library / API reference / Chart elements / st.map","url":"/library/api-reference/charts/st.map","isVersioned":true}],"category":"Streamlit library / API reference / Chart elements","url":"/library/api-reference/charts"},{"menu_key":"input-widgets","name":"Input widgets","depth":"2","children":[{"menu_key":"st.button","name":"st.button","depth":"3","children":[],"category":"Streamlit library / API reference / Input widgets / st.button","url":"/library/api-reference/widgets/st.button","isVersioned":true},{"menu_key":"st.download_button","name":"st.download_button","depth":"3","children":[],"category":"Streamlit library / API reference / Input widgets / st.download_button","url":"/library/api-reference/widgets/st.download_button","isVersioned":true},{"menu_key":"st.checkbox","name":"st.checkbox","depth":"3","children":[],"category":"Streamlit library / API reference / Input widgets / st.checkbox","url":"/library/api-reference/widgets/st.checkbox","isVersioned":true},{"menu_key":"st.toggle","name":"st.toggle","depth":"3","children":[],"category":"Streamlit library / API reference / Input widgets / st.toggle","url":"/library/api-reference/widgets/st.toggle","isVersioned":true},{"menu_key":"st.radio","name":"st.radio","depth":"3","children":[],"category":"Streamlit library / API reference / Input widgets / st.radio","url":"/library/api-reference/widgets/st.radio","isVersioned":true},{"menu_key":"st.selectbox","name":"st.selectbox","depth":"3","children":[],"category":"Streamlit library / API reference / Input widgets / st.selectbox","url":"/library/api-reference/widgets/st.selectbox","isVersioned":true},{"menu_key":"st.multiselect","name":"st.multiselect","depth":"3","children":[],"category":"Streamlit library / API reference / Input widgets / st.multiselect","url":"/library/api-reference/widgets/st.multiselect","isVersioned":true},{"menu_key":"st.slider","name":"st.slider","depth":"3","children":[],"category":"Streamlit library / API reference / Input widgets / st.slider","url":"/library/api-reference/widgets/st.slider","isVersioned":true},{"menu_key":"st.select_slider","name":"st.select_slider","depth":"3","children":[],"category":"Streamlit library / API reference / Input widgets / st.select_slider","url":"/library/api-reference/widgets/st.select_slider","isVersioned":true},{"menu_key":"st.text_input","name":"st.text_input","depth":"3","children":[],"category":"Streamlit library / API reference / Input widgets / st.text_input","url":"/library/api-reference/widgets/st.text_input","isVersioned":true},{"menu_key":"st.number_input","name":"st.number_input","depth":"3","children":[],"category":"Streamlit library / API reference / Input widgets / st.number_input","url":"/library/api-reference/widgets/st.number_input","isVersioned":true},{"menu_key":"st.text_area","name":"st.text_area","depth":"3","children":[],"category":"Streamlit library / API reference / Input widgets / st.text_area","url":"/library/api-reference/widgets/st.text_area","isVersioned":true},{"menu_key":"st.date_input","name":"st.date_input","depth":"3","children":[],"category":"Streamlit library / API reference / Input widgets / st.date_input","url":"/library/api-reference/widgets/st.date_input","isVersioned":true},{"menu_key":"st.time_input","name":"st.time_input","depth":"3","children":[],"category":"Streamlit library / API reference / Input widgets / st.time_input","url":"/library/api-reference/widgets/st.time_input","isVersioned":true},{"menu_key":"st.file_uploader","name":"st.file_uploader","depth":"3","children":[],"category":"Streamlit library / API reference / Input widgets / st.file_uploader","url":"/library/api-reference/widgets/st.file_uploader","isVersioned":true},{"menu_key":"st.camera_input","name":"st.camera_input","depth":"3","children":[],"category":"Streamlit library / API reference / Input widgets / st.camera_input","url":"/library/api-reference/widgets/st.camera_input","isVersioned":true},{"menu_key":"st.color_picker","name":"st.color_picker","depth":"3","children":[],"category":"Streamlit library / API reference / Input widgets / st.color_picker","url":"/library/api-reference/widgets/st.color_picker","isVersioned":true}],"category":"Streamlit library / API reference / Input widgets","url":"/library/api-reference/widgets"},{"menu_key":"media-elements","name":"Media elements","depth":"2","children":[{"menu_key":"st.image","name":"st.image","depth":"3","children":[],"category":"Streamlit library / API reference / Media elements / st.image","url":"/library/api-reference/media/st.image","isVersioned":true},{"menu_key":"st.audio","name":"st.audio","depth":"3","children":[],"category":"Streamlit library / API reference / Media elements / st.audio","url":"/library/api-reference/media/st.audio","isVersioned":true},{"menu_key":"st.video","name":"st.video","depth":"3","children":[],"category":"Streamlit library / API reference / Media elements / st.video","url":"/library/api-reference/media/st.video","isVersioned":true}],"category":"Streamlit library / API reference / Media elements","url":"/library/api-reference/media"},{"menu_key":"layouts-and-containers","name":"Layouts and containers","depth":"2","children":[{"menu_key":"st.sidebar","name":"st.sidebar","depth":"3","children":[],"category":"Streamlit library / API reference / Layouts and containers / st.sidebar","url":"/library/api-reference/layout/st.sidebar","isVersioned":true},{"menu_key":"st.columns","name":"st.columns","depth":"3","children":[],"category":"Streamlit library / API reference / Layouts and containers / st.columns","url":"/library/api-reference/layout/st.columns","isVersioned":true},{"menu_key":"st.tabs","name":"st.tabs","depth":"3","children":[],"category":"Streamlit library / API reference / Layouts and containers / st.tabs","url":"/library/api-reference/layout/st.tabs","isVersioned":true},{"menu_key":"st.expander","name":"st.expander","depth":"3","children":[],"category":"Streamlit library / API reference / Layouts and containers / st.expander","url":"/library/api-reference/layout/st.expander","isVersioned":true},{"menu_key":"st.container","name":"st.container","depth":"3","children":[],"category":"Streamlit library / API reference / Layouts and containers / st.container","url":"/library/api-reference/layout/st.container","isVersioned":true},{"menu_key":"st.empty","name":"st.empty","depth":"3","children":[],"category":"Streamlit library / API reference / Layouts and containers / st.empty","url":"/library/api-reference/layout/st.empty","isVersioned":true}],"category":"Streamlit library / API reference / Layouts and containers","url":"/library/api-reference/layout"},{"menu_key":"chat-elements","name":"Chat elements","depth":"2","children":[{"menu_key":"st.chat_message","name":"st.chat_message","depth":"3","children":[],"category":"Streamlit library / API reference / Chat elements / st.chat_message","url":"/library/api-reference/chat/st.chat_message","isVersioned":true},{"menu_key":"st.chat_input","name":"st.chat_input","depth":"3","children":[],"category":"Streamlit library / API reference / Chat elements / st.chat_input","url":"/library/api-reference/chat/st.chat_input","isVersioned":true}],"category":"Streamlit library / API reference / Chat elements","url":"/library/api-reference/chat"},{"menu_key":"status-elements","name":"Status elements","depth":"2","children":[{"menu_key":"st.progress","name":"st.progress","depth":"3","children":[],"category":"Streamlit library / API reference / Status elements / st.progress","url":"/library/api-reference/status/st.progress","isVersioned":true},{"menu_key":"st.spinner","name":"st.spinner","depth":"3","children":[],"category":"Streamlit library / API reference / Status elements / st.spinner","url":"/library/api-reference/status/st.spinner","isVersioned":true},{"menu_key":"st.status","name":"st.status","depth":"3","children":[],"category":"Streamlit library / API reference / Status elements / st.status","url":"/library/api-reference/status/st.status","isVersioned":true},{"menu_key":"st.toast","name":"st.toast","depth":"3","children":[],"category":"Streamlit library / API reference / Status elements / st.toast","url":"/library/api-reference/status/st.toast","isVersioned":true},{"menu_key":"st.balloons","name":"st.balloons","depth":"3","children":[],"category":"Streamlit library / API reference / Status elements / st.balloons","url":"/library/api-reference/status/st.balloons","isVersioned":true},{"menu_key":"st.snow","name":"st.snow","depth":"3","children":[],"category":"Streamlit library / API reference / Status elements / st.snow","url":"/library/api-reference/status/st.snow","isVersioned":true},{"menu_key":"st.error","name":"st.error","depth":"3","children":[],"category":"Streamlit library / API reference / Status elements / st.error","url":"/library/api-reference/status/st.error","isVersioned":true},{"menu_key":"st.warning","name":"st.warning","depth":"3","children":[],"category":"Streamlit library / API reference / Status elements / st.warning","url":"/library/api-reference/status/st.warning","isVersioned":true},{"menu_key":"st.info","name":"st.info","depth":"3","children":[],"category":"Streamlit library / API reference / Status elements / st.info","url":"/library/api-reference/status/st.info","isVersioned":true},{"menu_key":"st.success","name":"st.success","depth":"3","children":[],"category":"Streamlit library / API reference / Status elements / st.success","url":"/library/api-reference/status/st.success","isVersioned":true},{"menu_key":"st.exception","name":"st.exception","depth":"3","children":[],"category":"Streamlit library / API reference / Status elements / st.exception","url":"/library/api-reference/status/st.exception","isVersioned":true}],"category":"Streamlit library / API reference / Status elements","url":"/library/api-reference/status"},{"menu_key":"control-flow","name":"Control flow","depth":"2","children":[{"menu_key":"st.stop","name":"st.stop","depth":"3","children":[],"category":"Streamlit library / API reference / Control flow / st.stop","url":"/library/api-reference/control-flow/st.stop","isVersioned":true},{"menu_key":"st.form","name":"st.form","depth":"3","children":[],"category":"Streamlit library / API reference / Control flow / st.form","url":"/library/api-reference/control-flow/st.form","isVersioned":true},{"menu_key":"st.form_submit_button","name":"st.form_submit_button","depth":"3","children":[],"category":"Streamlit library / API reference / Control flow / st.form_submit_button","url":"/library/api-reference/control-flow/st.form_submit_button","isVersioned":true},{"menu_key":"st.experimental_rerun","name":"st.experimental_rerun","depth":"3","children":[],"category":"Streamlit library / API reference / Control flow / st.experimental_rerun","url":"/library/api-reference/control-flow/st.experimental_rerun","isVersioned":true}],"category":"Streamlit library / API reference / Control flow","url":"/library/api-reference/control-flow"},{"menu_key":"utilities","name":"Utilities","depth":"2","children":[{"menu_key":"st.set_page_config","name":"st.set_page_config","depth":"3","children":[],"category":"Streamlit library / API reference / Utilities / st.set_page_config","url":"/library/api-reference/utilities/st.set_page_config","isVersioned":true},{"menu_key":"st.echo","name":"st.echo","depth":"3","children":[],"category":"Streamlit library / API reference / Utilities / st.echo","url":"/library/api-reference/utilities/st.echo","isVersioned":true},{"menu_key":"st.help","name":"st.help","depth":"3","children":[],"category":"Streamlit library / API reference / Utilities / st.help","url":"/library/api-reference/utilities/st.help","isVersioned":true},{"menu_key":"st.experimental_get_query_params","name":"st.experimental_get_query_params","depth":"3","children":[],"category":"Streamlit library / API reference / Utilities / st.experimental_get_query_params","url":"/library/api-reference/utilities/st.experimental_get_query_params","isVersioned":true},{"menu_key":"st.experimental_set_query_params","name":"st.experimental_set_query_params","depth":"3","children":[],"category":"Streamlit library / API reference / Utilities / st.experimental_set_query_params","url":"/library/api-reference/utilities/st.experimental_set_query_params","isVersioned":true}],"category":"Streamlit library / API reference / Utilities","url":"/library/api-reference/utilities"},{"menu_key":"mutate-charts","name":"Mutate charts","depth":"2","children":[],"category":"Streamlit library / API reference / Mutate charts","url":"/library/api-reference/mutate"},{"menu_key":"state-management","name":"State management","depth":"2","children":[],"category":"Streamlit library / API reference / State management","url":"/library/api-reference/session-state"},{"menu_key":"performance","name":"Performance","depth":"2","children":[{"menu_key":"st.cache_data","name":"st.cache_data","depth":"3","children":[],"category":"Streamlit library / API reference / Performance / st.cache_data","url":"/library/api-reference/performance/st.cache_data","isVersioned":true},{"menu_key":"clear-cached-data","name":"Clear cached data","depth":"3","children":[],"category":"Streamlit library / API reference / Performance / Clear cached data","url":"/library/api-reference/performance/st.cache_data.clear","isVersioned":true},{"menu_key":"st.cache_resource","name":"st.cache_resource","depth":"3","children":[],"category":"Streamlit library / API reference / Performance / st.cache_resource","url":"/library/api-reference/performance/st.cache_resource","isVersioned":true},{"menu_key":"clear-cached-resources","name":"Clear cached resources","depth":"3","children":[],"category":"Streamlit library / API reference / Performance / Clear cached resources","url":"/library/api-reference/performance/st.cache_resource.clear","isVersioned":true},{"menu_key":"st.cache","name":"st.cache","depth":"3","children":[],"category":"Streamlit library / API reference / Performance / st.cache","url":"/library/api-reference/performance/st.cache","isVersioned":true,"isDeprecated":true},{"menu_key":"st.experimental_memo","name":"st.experimental_memo","depth":"3","children":[],"category":"Streamlit library / API reference / Performance / st.experimental_memo","url":"/library/api-reference/performance/st.experimental_memo","isVersioned":true,"isDeprecated":true},{"menu_key":"clear-memo","name":"Clear memo","depth":"3","children":[],"category":"Streamlit library / API reference / Performance / Clear memo","url":"/library/api-reference/performance/st.experimental_memo.clear","isVersioned":true,"isDeprecated":true},{"menu_key":"st.experimental_singleton","name":"st.experimental_singleton","depth":"3","children":[],"category":"Streamlit library / API reference / Performance / st.experimental_singleton","url":"/library/api-reference/performance/st.experimental_singleton","isVersioned":true,"isDeprecated":true},{"menu_key":"clear-singleton","name":"Clear singleton","depth":"3","children":[],"category":"Streamlit library / API reference / Performance / Clear singleton","url":"/library/api-reference/performance/st.experimental_singleton.clear","isVersioned":true,"isDeprecated":true}],"category":"Streamlit library / API reference / Performance","url":"/library/api-reference/performance"},{"menu_key":"personalization","name":"Personalization","depth":"2","children":[{"menu_key":"st.experimental_user","name":"st.experimental_user","depth":"3","children":[],"category":"Streamlit library / API reference / Personalization / st.experimental_user","url":"/library/api-reference/personalization/st.experimental_user","isVersioned":false}],"category":"Streamlit library / API reference / Personalization","url":"/library/api-reference/personalization","isVersioned":false},{"menu_key":"connections-and-databases","name":"Connections and databases","depth":"2","children":[{"menu_key":"st.experimental_connection","name":"st.experimental_connection","depth":"3","children":[],"category":"Streamlit library / API reference / Connections and databases / st.experimental_connection","url":"/library/api-reference/connections/st.experimental_connection","isVersioned":true},{"menu_key":"sqlconnection","name":"SQLConnection","depth":"3","children":[],"category":"Streamlit library / API reference / Connections and databases / SQLConnection","url":"/library/api-reference/connections/st.connections.sqlconnection","isVersioned":true},{"menu_key":"snowparkconnection","name":"SnowparkConnection","depth":"3","children":[],"category":"Streamlit library / API reference / Connections and databases / SnowparkConnection","url":"/library/api-reference/connections/st.connections.snowparkconnection","isVersioned":true},{"menu_key":"connection-base-class","name":"Connection base class","depth":"3","children":[],"category":"Streamlit library / API reference / Connections and databases / Connection base class","url":"/library/api-reference/connections/st.connections.experimentalbaseconnection","isVersioned":true}],"category":"Streamlit library / API reference / Connections and databases","url":"/library/api-reference/connections"}],"category":"Streamlit library / API reference","url":"/library/api-reference"},{"menu_key":"advanced-features","name":"Advanced features","depth":"1","children":[{"menu_key":"app-menu","name":"â‹® App menu","depth":"2","children":[],"category":"Streamlit library / Advanced features / â‹® App menu","url":"/library/advanced-features/app-menu"},{"menu_key":"button-behavior-and-examples","name":"Button behavior and examples","depth":"2","children":[],"category":"Streamlit library / Advanced features/ Button behavior and examples","url":"/library/advanced-features/button-behavior-and-examples"},{"menu_key":"caching","name":"Caching","depth":"2","children":[],"category":"Streamlit library / Advanced features/ Caching","url":"/library/advanced-features/caching"},{"menu_key":"command-line-options","name":"Command-line options","depth":"2","children":[],"category":"Streamlit library / Advanced features/ Command-line options","url":"/library/advanced-features/cli"},{"menu_key":"configuration","name":"Configuration","depth":"2","children":[],"category":"Streamlit library / Advanced features/ Configuration","url":"/library/advanced-features/configuration"},{"menu_key":"theming","name":"Theming","depth":"2","children":[],"category":"Streamlit library / Advanced features / Theming","url":"/library/advanced-features/theming"},{"menu_key":"connecting-to-data","name":"Connecting to data","depth":"2","children":[],"category":"Streamlit library / Advanced features/ Connecting to data","url":"/library/advanced-features/connecting-to-data"},{"menu_key":"dataframes","name":"Dataframes","depth":"2","children":[],"category":"Streamlit library / Advanced features/ Dataframes","url":"/library/advanced-features/dataframes"},{"menu_key":"forms","name":"Forms","depth":"2","children":[],"category":"Streamlit library / Advanced features/ Forms","url":"/library/advanced-features/forms"},{"menu_key":"optimize-performance-with-st.cache","name":"Optimize performance with st.cache","depth":"2","children":[],"category":"Streamlit library / Advanced features/ Optimize performance with st.cache","url":"/library/advanced-features/st.cache","visible":false},{"menu_key":"experimental-cache-primitives","name":"Experimental cache primitives","depth":"2","children":[],"category":"Streamlit library / Advanced features/ Experimental cache primitives","url":"/library/advanced-features/experimental-cache-primitives","visible":false},{"menu_key":"add-statefulness-to-apps","name":"Add statefulness to apps","depth":"2","children":[],"category":"Streamlit library / Advanced features/ Add statefulness to apps","url":"/library/advanced-features/session-state"},{"menu_key":"widget-semantics","name":"Widget semantics","depth":"2","children":[],"category":"Streamlit library / Advanced features/ Widget semantics","url":"/library/advanced-features/widget-semantics"},{"menu_key":"pre-release-features","name":"Pre-release features","depth":"2","children":[],"category":"Streamlit library / Advanced features/ Pre-release features","url":"/library/advanced-features/prerelease"},{"menu_key":"working-with-timezones","name":"Working with timezones","depth":"2","children":[],"category":"Streamlit library / Advanced features/ Working with timezones","url":"/library/advanced-features/timezone-handling"},{"menu_key":"static-file-serving","name":"Static file serving","depth":"2","children":[],"category":"Streamlit library / Advanced features/ Static file serving","url":"/library/advanced-features/static-file-serving"},{"menu_key":"https-support","name":"HTTPS support","depth":"2","children":[],"category":"Streamlit library / Advanced features/ HTTPS support","url":"/library/advanced-features/https-support"},{"menu_key":"secrets-management","name":"Secrets management","depth":"2","children":[],"category":"Streamlit library / Advanced features/ Secrets management","url":"/library/advanced-features/secrets-management"}],"category":"Streamlit library / Advanced features","url":"/library/advanced-features"},{"menu_key":"components","name":"Components","depth":"1","children":[{"menu_key":"components-api","name":"Components API","depth":"2","children":[],"category":"Streamlit library / Components / Components API","url":"/library/components/components-api"},{"menu_key":"create-a-component","name":"Create a Component","depth":"2","children":[],"category":"Streamlit library / Components / Create a Component","url":"/library/components/create"},{"menu_key":"publish-a-component","name":"Publish a Component","depth":"2","children":[],"category":"Streamlit library / Components / Publish a Component","url":"/library/components/publish"},{"menu_key":"component-gallery","name":"Component gallery","depth":"2","children":[],"category":"Streamlit library / Components / Component gallery","url":"https://streamlit.io/components"}],"category":"Streamlit library / Components","url":"/library/components"},{"menu_key":"roadmap","name":"Roadmap","depth":"1","children":[],"category":"Streamlit library / Roadmap","url":"https://roadmap.streamlit.app"},{"menu_key":"changelog","name":"Changelog","depth":"1","children":[],"category":"Streamlit library / Changelog","url":"/library/changelog"},{"menu_key":"cheat-sheet","name":"Cheat sheet","depth":"1","children":[],"category":"Streamlit library / Cheat sheet","url":"/library/cheatsheet"}],"category":"Streamlit library","url":"/library","color":"violet-70","icon":"description"},{"menu_key":"streamlit-community-cloud","name":"Streamlit Community Cloud","depth":"0","children":[{"menu_key":"get-started","name":"Get started","depth":"1","children":[{"menu_key":"quickstart","name":"Quickstart","depth":"2","children":[],"category":"Streamlit Community Cloud / Get started / Quickstart","url":"/streamlit-community-cloud/get-started/quickstart"},{"menu_key":"create-your-account","name":"Create your account","depth":"2","children":[],"category":"Streamlit Community Cloud / Get started / Create your account","url":"/streamlit-community-cloud/get-started/create-your-account"},{"menu_key":"connect-your-github-account","name":"Connect your GitHub account","depth":"2","children":[],"category":"Streamlit Community Cloud / Get started / Connect your GitHub account","url":"/streamlit-community-cloud/get-started/connect-your-github-account"},{"menu_key":"explore-your-workspace","name":"Explore your workspace","depth":"2","children":[],"category":"Streamlit Community Cloud / Get started / Explore your workspace","url":"/streamlit-community-cloud/get-started/explore-your-workspace"},{"menu_key":"trust-and-security","name":"Trust and Security","depth":"2","children":[],"category":"Streamlit Community Cloud / Get started / Trust and Security","url":"/streamlit-community-cloud/get-started/trust-and-security"}],"category":"Streamlit Community Cloud / Get started","url":"/streamlit-community-cloud/get-started"},{"menu_key":"deploy-your-app","name":"Deploy your app","depth":"1","children":[{"menu_key":"app-dependencies","name":"App dependencies","depth":"2","children":[],"category":"Streamlit Community Cloud / Deploy your app / App dependencies","url":"/streamlit-community-cloud/deploy-your-app/app-dependencies"},{"menu_key":"secrets-management","name":"Secrets management","depth":"2","children":[],"category":"Streamlit Community Cloud / Deploy your app / Secrets management","url":"/streamlit-community-cloud/deploy-your-app/secrets-management"}],"category":"Streamlit Community Cloud / Deploy your app","url":"/streamlit-community-cloud/deploy-your-app"},{"menu_key":"manage-your-app","name":"Manage your app","depth":"1","children":[{"menu_key":"app-analytics","name":"App analytics","depth":"2","children":[],"category":"Streamlit Community Cloud / Manage your app / App analytics","url":"/streamlit-community-cloud/manage-your-app/app-analytics"},{"menu_key":"app-settings","name":"App settings","depth":"2","children":[],"category":"Streamlit Community Cloud / Manage your app / App settings","url":"/streamlit-community-cloud/manage-your-app/app-settings"},{"menu_key":"delete-your-app","name":"Delete your app","depth":"2","children":[],"category":"Streamlit Community Cloud / Manage your app / Delete your app","url":"/streamlit-community-cloud/manage-your-app/delete-your-app"},{"menu_key":"favorite-your-app","name":"Favorite your app","depth":"2","children":[],"category":"Streamlit Community Cloud / Manage your app / Favorite your app","url":"/streamlit-community-cloud/manage-your-app/favorite-your-app"},{"menu_key":"reboot-your-app","name":"Reboot your app","depth":"2","children":[],"category":"Streamlit Community Cloud / Manage your app / Reboot your app","url":"/streamlit-community-cloud/manage-your-app/reboot-your-app"}],"category":"Streamlit Community Cloud / Manage your app","url":"/streamlit-community-cloud/manage-your-app"},{"menu_key":"share-your-app","name":"Share your app","depth":"1","children":[{"menu_key":"embed-your-app","name":"Embed your app","depth":"2","children":[],"category":"Streamlit Community Cloud / Share your app / Embed your app","url":"/streamlit-community-cloud/share-your-app/embed-your-app"},{"menu_key":"search-indexability","name":"Search indexability","depth":"2","children":[],"category":"Streamlit Community Cloud / Share your app / Search indexability","url":"/streamlit-community-cloud/share-your-app/indexability"},{"menu_key":"share-previews","name":"Share previews","depth":"2","children":[],"category":"Streamlit Community Cloud / Share your app / Share previews","url":"/streamlit-community-cloud/share-your-app/share-previews"}],"category":"Streamlit Community Cloud / Share your app","url":"/streamlit-community-cloud/share-your-app"},{"menu_key":"manage-your-account","name":"Manage your account","depth":"1","children":[{"menu_key":"sign-in-and-sign-out","name":"Sign in \u0026 sign out","depth":"2","children":[],"category":"Streamlit Community Cloud / Manage your account / Sign in \u0026 sign out","url":"/streamlit-community-cloud/manage-your-account/sign-in-sign-out"},{"menu_key":"workspace-settings","name":"Workspace settings","depth":"2","children":[],"category":"Streamlit Community Cloud / Manage your account / Workspace settings","url":"/streamlit-community-cloud/manage-your-account/workspace-settings"},{"menu_key":"manage-your-github-connection","name":"Manage your GitHub connection","depth":"2","children":[],"category":"Streamlit Community Cloud / Manage your account / Manage your GitHub connection","url":"/streamlit-community-cloud/manage-your-account/manage-your-github-connection"},{"menu_key":"update-your-email","name":"Update your email","depth":"2","children":[],"category":"Streamlit Community Cloud / Manage your account / Update your email","url":"/streamlit-community-cloud/manage-your-account/update-your-email"},{"menu_key":"delete-your-account","name":"Delete your account","depth":"2","children":[],"category":"Streamlit Community Cloud / Manage your account / Delete your account","url":"/streamlit-community-cloud/manage-your-account/delete-your-account"}],"category":"Streamlit Community Cloud / Manage your account","url":"/streamlit-community-cloud/manage-your-account"},{"menu_key":"troubleshooting","name":"Troubleshooting","depth":"1","children":[],"category":"Streamlit Community Cloud / Troubleshooting","url":"/streamlit-community-cloud/troubleshooting"}],"category":"Streamlit Community Cloud","url":"/streamlit-community-cloud","color":"l-blue-70","icon":"cloud"},{"menu_key":"knowledge-base","name":"Knowledge base","depth":"0","children":[{"menu_key":"tutorials","name":"Tutorials","depth":"1","children":[{"menu_key":"connect-to-data-sources","name":"Connect to data sources","depth":"2","children":[{"menu_key":"aws-s3","name":"AWS S3","depth":"3","children":[],"category":"Knowledge base / Tutorials / Connect to data sources / AWS S3","url":"/knowledge-base/tutorials/databases/aws-s3"},{"menu_key":"bigquery","name":"BigQuery","depth":"3","children":[],"category":"Knowledge base / Tutorials / Connect to data sources / BigQuery","url":"/knowledge-base/tutorials/databases/bigquery"},{"menu_key":"deta-base","name":"Deta Base","depth":"3","children":[],"category":"Knowledge base / Tutorials / Connect to data sources / Deta Base","url":"/knowledge-base/tutorials/databases/deta-base"},{"menu_key":"firestore","name":"Firestore","depth":"3","children":[],"category":"Knowledge base / Tutorials / Connect to data sources / Firestore","url":"https://blog.streamlit.io/streamlit-firestore/"},{"menu_key":"google-cloud-storage","name":"Google Cloud Storage","depth":"3","children":[],"category":"Knowledge base / Tutorials / Connect to data sources / Google Cloud Storage","url":"/knowledge-base/tutorials/databases/gcs"},{"menu_key":"microsoft-sql-server","name":"Microsoft SQL Server","depth":"3","children":[],"category":"Knowledge base / Tutorials / Connect to data sources / Microsoft SQL Server","url":"/knowledge-base/tutorials/databases/mssql"},{"menu_key":"mongodb","name":"MongoDB","depth":"3","children":[],"category":"Knowledge base / Tutorials / Connect to data sources / MongoDB","url":"/knowledge-base/tutorials/databases/mongodb"},{"menu_key":"mysql","name":"MySQL","depth":"3","children":[],"category":"Knowledge base / Tutorials / Connect to data sources / MySQL","url":"/knowledge-base/tutorials/databases/mysql"},{"menu_key":"postgresql","name":"PostgreSQL","depth":"3","children":[],"category":"Knowledge base / Tutorials / Connect to data sources / PostgreSQL","url":"/knowledge-base/tutorials/databases/postgresql"},{"menu_key":"private-google-sheet","name":"Private Google Sheet","depth":"3","children":[],"category":"Knowledge base / Tutorials / Connect to data sources / Private Google Sheet","url":"/knowledge-base/tutorials/databases/private-gsheet"},{"menu_key":"public-google-sheet","name":"Public Google Sheet","depth":"3","children":[],"category":"Knowledge base / Tutorials / Connect to data sources / Public Google Sheet","url":"/knowledge-base/tutorials/databases/public-gsheet"},{"menu_key":"snowflake","name":"Snowflake","depth":"3","children":[],"category":"Knowledge base / Tutorials / Connect to data sources / Snowflake","url":"/knowledge-base/tutorials/databases/snowflake"},{"menu_key":"supabase","name":"Supabase","depth":"3","children":[],"category":"Knowledge base / Tutorials / Connect to data sources / Supabase","url":"/knowledge-base/tutorials/databases/supabase"},{"menu_key":"tableau","name":"Tableau","depth":"3","children":[],"category":"Knowledge base / Tutorials / Connect to data sources / Tableau","url":"/knowledge-base/tutorials/databases/tableau"},{"menu_key":"tidb","name":"TiDB","depth":"3","children":[],"category":"Knowledge base / Tutorials / Connect to data sources / TiDB","url":"/knowledge-base/tutorials/databases/tidb"},{"menu_key":"tigergraph","name":"TigerGraph","depth":"3","children":[],"category":"Knowledge base / Tutorials / Connect to data sources / TigerGraph","url":"/knowledge-base/tutorials/databases/tigergraph"}],"category":"Knowledge base / Tutorials / Connect to data sources","url":"/knowledge-base/tutorials/databases"},{"menu_key":"deploy-streamlit-apps","name":"Deploy Streamlit apps","depth":"2","children":[{"menu_key":"docker","name":"Docker","depth":"3","children":[],"category":"Knowledge base / Tutorials / Deploy Streamlit apps / Docker","url":"/knowledge-base/tutorials/deploy/docker"},{"menu_key":"kubernetes","name":"Kubernetes","depth":"3","children":[],"category":"Knowledge base / Tutorials / Deploy Streamlit apps / Kubernetes","url":"/knowledge-base/tutorials/deploy/kubernetes"}],"category":"Knowledge base / Tutorials / Deploy Streamlit apps","url":"/knowledge-base/tutorials/deploy"},{"menu_key":"session-state-basics","name":"Session State basics","depth":"2","children":[],"category":"Knowledge base / Tutorials / Session State basics","url":"/knowledge-base/tutorials/session-state"},{"menu_key":"build-conversational-apps","name":"Build conversational apps","depth":"2","children":[],"category":"Knowledge base / Tutorials / Build conversational apps","url":"/knowledge-base/tutorials/build-conversational-apps"},{"menu_key":"llm-quickstart","name":"LLM quickstart","depth":"2","children":[],"category":"Knowledge base / Tutorials / LLM quickstart","url":"/knowledge-base/tutorials/llm-quickstart"}],"category":"Knowledge base / Tutorials","url":"/knowledge-base/tutorials"},{"menu_key":"using-streamlit","name":"Using Streamlit","depth":"1","children":[{"menu_key":"how-to-animate-elements","name":"How to animate elements?","depth":"2","children":[],"category":"Knowledge base / Using Streamlit / How to animate elements?","url":"/knowledge-base/using-streamlit/animate-elements","visible":false},{"menu_key":"append-data-to-a-table-or-chart","name":"Append data to a table or chart","depth":"2","children":[],"category":"Knowledge base / Using Streamlit / Append data to a table or chart","url":"/knowledge-base/using-streamlit/append-data-table-chart","visible":false},{"menu_key":"batch-elements-and-input-widgets-with-st.form","name":"Batch elements and input widgets with st.form","depth":"2","children":[],"category":"Knowledge base / Using Streamlit / Batch elements and input widgets with st.form","url":"/knowledge-base/using-streamlit/batch-elements-input-widgets-form","visible":false},{"menu_key":"how-do-i-create-an-anchor-link","name":"How do I create an anchor link?","depth":"2","children":[],"category":"Knowledge base / Using Streamlit / How do I create an anchor link?","url":"/knowledge-base/using-streamlit/create-anchor-link","visible":false},{"menu_key":"enabling-camera-access-in-your-browser","name":"Enabling camera access in your browser","depth":"2","children":[],"category":"Knowledge base / Using Streamlit / Enabling camera access in your browser","url":"/knowledge-base/using-streamlit/enable-camera","visible":false},{"menu_key":"how-do-i-run-my-streamlit-script","name":"How do I run my Streamlit script?","depth":"2","children":[],"category":"Knowledge base / Using Streamlit / How do I run my Streamlit script?","url":"/knowledge-base/using-streamlit/how-do-i-run-my-streamlit-script","visible":false},{"menu_key":"how-to-download-a-file-in-streamlit","name":"How to download a file in Streamlit?","depth":"2","children":[],"category":"Knowledge base / Using Streamlit / How to download a file in Streamlit?","url":"/knowledge-base/using-streamlit/how-download-file-streamlit","visible":false},{"menu_key":"how-to-download-a-pandas-dataframe-as-a-csv","name":"How to download a Pandas DataFrame as a CSV?","depth":"2","children":[],"category":"Knowledge base / Using Streamlit / How to download a Pandas DataFrame as a CSV?","url":"/knowledge-base/using-streamlit/how-download-pandas-dataframe-csv","visible":false},{"menu_key":"how-do-i-get-dataframe-row-selections-from-a-user","name":"How do I get dataframe row-selections from a user?","depth":"2","children":[],"category":"Knowledge base / Using Streamlit / How do I get dataframe row-selections from a user?","url":"/knowledge-base/using-streamlit/how-to-get-row-selections","visible":false},{"menu_key":"how-do-i-upgrade-to-the-latest-version-of-streamlit","name":"How do I upgrade to the latest version of Streamlit?","depth":"2","children":[],"category":"Knowledge base / Using Streamlit / How do I upgrade to the latest version of Streamlit?","url":"/knowledge-base/using-streamlit/how-upgrade-latest-version-streamlit","visible":false},{"menu_key":"how-to-insert-elements-out-of-order","name":"How to insert elements out of order?","depth":"2","children":[],"category":"Knowledge base / Using Streamlit / How to insert elements out of order?","url":"/knowledge-base/using-streamlit/insert-elements-out-of-order","visible":false},{"menu_key":"what-is-the-path-of-streamlit's-config.toml-file","name":"What is the path of Streamlitâ€™s config.toml file?","depth":"2","children":[],"category":"Knowledge base / Using Streamlit / What is the path of Streamlitâ€™s config.toml file?","url":"/knowledge-base/using-streamlit/path-streamlit-config-toml","visible":false},{"menu_key":"how-can-i-make-st.pydeck_chart-use-custom-mapbox-styles","name":"How can I make st.pydeck_chart use custom Mapbox styles?","depth":"2","children":[],"category":"Knowledge base / Using Streamlit / How can I make st.pydeck_chart use custom Mapbox styles?","url":"/knowledge-base/using-streamlit/pydeck-chart-custom-mapbox-styles","visible":false},{"menu_key":"how-to-remove-\"-streamlit\"-from-the-app-title","name":"How to remove \"Â· Streamlit\" from the app title?","depth":"2","children":[],"category":"Knowledge base / Using Streamlit / How to remove \"Â· Streamlit\" from the app title?","url":"/knowledge-base/using-streamlit/remove-streamlit-app-title","visible":false},{"menu_key":"how-do-you-retrieve-the-filename-of-a-file-uploaded-with-st.file_uploader","name":"How do you retrieve the filename of a file uploaded with st.file_uploader?","depth":"2","children":[],"category":"Knowledge base / Using Streamlit / How do you retrieve the filename of a file uploaded with st.file_uploader?","url":"/knowledge-base/using-streamlit/retrieve-filename-uploaded","visible":false},{"menu_key":"sanity-checks","name":"Sanity checks","depth":"2","children":[],"category":"Knowledge base / Using Streamlit / Sanity checks","url":"/knowledge-base/using-streamlit/sanity-checks","visible":false},{"menu_key":"how-can-i-make-streamlit-watch-for-changes-in-other-modules-i'm-importing-in-my-app","name":"How can I make Streamlit watch for changes in other modules I'm importing in my app?","depth":"2","children":[],"category":"Knowledge base / Using Streamlit / How can I make Streamlit watch for changes in other modules I'm importing in my app?","url":"/knowledge-base/using-streamlit/streamlit-watch-changes-other-modules-importing-app","visible":false},{"menu_key":"what-browsers-does-streamlit-support","name":"What browsers does Streamlit support?","depth":"2","children":[],"category":"Knowledge base / Using Streamlit / What browsers does Streamlit support?","url":"/knowledge-base/using-streamlit/supported-browsers","visible":false},{"menu_key":"where-does-st.file_uploader-store-uploaded-files-and-when-do-they-get-deleted","name":"Where does st.file_uploader store uploaded files and when do they get deleted?","depth":"2","children":[],"category":"Knowledge base / Using Streamlit / Where does st.file_uploader store uploaded files and when do they get deleted?","url":"/knowledge-base/using-streamlit/where-file-uploader-store-when-deleted","visible":false},{"menu_key":"widget-updating-for-every-second-input-when-using-session-state","name":"Widget updating for every second input when using session state","depth":"2","children":[],"category":"Knowledge base / Using Streamlit / Widget updating for every second input when using session state","url":"/knowledge-base/using-streamlit/widget-updating-session-state","visible":false},{"menu_key":"why-does-streamlit-restrict-nested-st.columns","name":"Why does Streamlit restrict nested st.columns?","depth":"2","children":[],"category":"Knowledge base / Using Streamlit / Why does Streamlit restrict nested st.columns?","url":"/knowledge-base/using-streamlit/why-streamlit-restrict-nested-columns","visible":false},{"menu_key":"how-to-host-static-files-in-streamlit","name":"How to host static files in Streamlit?","depth":"2","children":[],"category":"Knowledge base / Using Streamlit / How to host static files in Streamlit?","url":"/knowledge-base/using-streamlit/how-host-static-files","visible":false},{"menu_key":"what-is-serializable-session-state","name":"What is serializable session state?","depth":"2","children":[],"category":"Knowledge base / Using Streamlit / What is serializable session state?","url":"/knowledge-base/using-streamlit/serializable-session-state","visible":false}],"category":"Knowledge base / Using Streamlit","url":"/knowledge-base/using-streamlit"},{"menu_key":"streamlit-components","name":"Streamlit Components","depth":"1","children":[{"menu_key":"how-do-i-add-a-component-to-the-sidebar","name":"How do I add a Component to the sidebar?","depth":"2","children":[],"category":"Knowledge base / Streamlit Components / How do I add a Component to the sidebar?","url":"/knowledge-base/components/add-component-sidebar","visible":false},{"menu_key":"my-component-seems-to-be-stuttering...how-do-i-fix-that","name":"My Component seems to be stuttering...how do I fix that?","depth":"2","children":[],"category":"Knowledge base / Streamlit Components / My Component seems to be stuttering...how do I fix that?","url":"/knowledge-base/components/component-blinking-stuttering-fix","visible":false},{"menu_key":"how-do-streamlit-components-differ-from-functionality-provided-in-the-base-streamlit-package","name":"How do Streamlit Components differ from functionality provided in the base Streamlit package?","depth":"2","children":[],"category":"Knowledge base / Streamlit Components / How do Streamlit Components differ from functionality provided in the base Streamlit package?","url":"/knowledge-base/components/how-streamlit-components-differ-base-package","visible":false},{"menu_key":"what-types-of-things-aren't-possible-with-streamlit-components","name":"What types of things aren't possible with Streamlit Components?","depth":"2","children":[],"category":"Knowledge base / Streamlit Components / What types of things aren't possible with Streamlit Components?","url":"/knowledge-base/components/not-possibe-streamlit-components","visible":false}],"category":"Knowledge base / Streamlit Components","url":"/knowledge-base/components"},{"menu_key":"installing-dependencies","name":"Installing dependencies","depth":"1","children":[{"menu_key":"how-to-install-a-package-not-on-pypi-or-conda-but-available-on-github","name":"How to install a package not on PyPI or Conda but available on GitHub","depth":"2","children":[],"category":"Knowledge base / Installing dependencies / How to install a package not on PyPI or Conda but available on GitHub","url":"/knowledge-base/dependencies/install-package-not-pypi-conda-available-github","visible":false},{"menu_key":"importerror-libgl.so.1-cannot-open-shared-object-file-no-such-file-or-directory","name":"ImportError libGL.so.1 cannot open shared object file No such file or directory","depth":"2","children":[],"category":"Knowledge base / Installing dependencies / ImportError libGL.so.1 cannot open shared object file No such file or directory","url":"/knowledge-base/dependencies/libgl","visible":false},{"menu_key":"modulenotfounderror-no-module-named","name":"ModuleNotFoundError No module named","depth":"2","children":[],"category":"Knowledge base / Installing dependencies / ModuleNotFoundError No module named","url":"/knowledge-base/dependencies/module-not-found-error","visible":false},{"menu_key":"error-no-matching-distribution-found-for","name":"ERROR No matching distribution found for","depth":"2","children":[],"category":"Knowledge base / Installing dependencies / ERROR No matching distribution found for","url":"/knowledge-base/dependencies/no-matching-distribution","visible":false},{"menu_key":"install-the-snowflake-connector-for-python-on-streamlit-community-cloud","name":"Install the Snowflake Connector for Python on Streamlit Community Cloud","depth":"2","children":[],"category":"Knowledge base / Installing dependencies / Install the Snowflake Connector for Python on Streamlit Community Cloud","url":"/knowledge-base/dependencies/snowflake-connector-python-streamlit-cloud","visible":false}],"category":"Knowledge base / Installing dependencies","url":"/knowledge-base/dependencies"},{"menu_key":"deployment-issues","name":"Deployment issues","depth":"1","children":[{"menu_key":"authentication-without-sso","name":"Authentication without SSO","depth":"2","children":[],"category":"Knowledge base / Deployment issues / Authentication without SSO","url":"/knowledge-base/deploy/authentication-without-sso","visible":false},{"menu_key":"how-can-i-deploy-multiple-streamlit-apps-on-different-subdomains","name":"How can I deploy multiple Streamlit apps on different subdomains?","depth":"2","children":[],"category":"Knowledge base / Deployment issues / How can I deploy multiple Streamlit apps on different subdomains?","url":"/knowledge-base/deploy/deploy-multiple-streamlit-apps-different-subdomains","visible":false},{"menu_key":"how-do-i-deploy-streamlit-on-a-domain-so-it-appears-to-run-on-a-regular-port-(i.e.-port-80)","name":"How do I deploy Streamlit on a domain so it appears to run on a regular port (i.e. port 80)?","depth":"2","children":[],"category":"Knowledge base / Deployment issues / How do I deploy Streamlit on a domain so it appears to run on a regular port (i.e. port 80)?","url":"/knowledge-base/deploy/deploy-streamlit-domain-port-80","visible":false},{"menu_key":"how-do-i-deploy-streamlit-on-heroku-aws-google-cloud-etc...","name":"How do I deploy Streamlit on Heroku, AWS, Google Cloud, etc...?","depth":"2","children":[],"category":"Knowledge base / Deployment issues / How do I deploy Streamlit on Heroku, AWS, Google Cloud, etc...?","url":"/knowledge-base/deploy/deploy-streamlit-heroku-aws-google-cloud","visible":false},{"menu_key":"does-streamlit-support-the-wsgi-protocol-(aka-can-i-deploy-streamlit-with-gunicorn)","name":"Does Streamlit support the WSGI Protocol? (aka Can I deploy Streamlit with gunicorn?)","depth":"2","children":[],"category":"Knowledge base / Deployment issues / Does Streamlit support the WSGI Protocol? (aka Can I deploy Streamlit with gunicorn?)","url":"/knowledge-base/deploy/does-streamlit-support-wsgi-protocol","visible":false},{"menu_key":"how-do-i-increase-the-upload-limit-of-st.file_uploader-on-streamlit-community-cloud","name":"How do I increase the upload limit of st.file_uploader on Streamlit Community Cloud?","depth":"2","children":[],"category":"Knowledge base / Deployment issues / How do I increase the upload limit of st.file_uploader on Streamlit Community Cloud?","url":"/knowledge-base/deploy/increase-file-uploader-limit-streamlit-cloud","visible":false},{"menu_key":"invoking-a-python-subprocess-in-a-deployed-streamlit-app","name":"Invoking a Python subprocess in a deployed Streamlit app","depth":"2","children":[],"category":"Knowledge base / Deployment issues / Invoking a Python subprocess in a deployed Streamlit app","url":"/knowledge-base/deploy/invoking-python-subprocess-deployed-streamlit-app","visible":false},{"menu_key":"organizing-your-apps-with-workspaces-on-streamlit-community-cloud","name":"Organizing your apps with workspaces on Streamlit Community Cloud","depth":"2","children":[],"category":"Knowledge base / Deployment issues / Organizing your apps with workspaces on Streamlit Community Cloud","url":"/knowledge-base/deploy/organizing-apps-workspaces-streamlit-cloud","visible":false},{"menu_key":"app-is-not-loading-when-running-remotely","name":"App is not loading when running remotely","depth":"2","children":[],"category":"Knowledge base / Deployment issues / App is not loading when running remotely","url":"/knowledge-base/deploy/remote-start","visible":false},{"menu_key":"argh.-this-app-has-gone-over-its-resource-limits","name":"Argh. This app has gone over its resource limits","depth":"2","children":[],"category":"Knowledge base / Deployment issues / Argh. This app has gone over its resource limits","url":"/knowledge-base/deploy/resource-limits","visible":false},{"menu_key":"how-do-i-share-apps-with-viewers-outside-my-organization","name":"How do I share apps with viewers outside my organization?","depth":"2","children":[],"category":"Knowledge base / Deployment issues / How do I share apps with viewers outside my organization?","url":"/knowledge-base/deploy/share-apps-with-viewers-outside-organization","visible":false},{"menu_key":"i-don't-have-sso.-how-do-i-sign-in-to-streamlit-community-cloud","name":"I don't have SSO. How do I sign in to Streamlit Community Cloud?","depth":"2","children":[],"category":"Knowledge base / Deployment issues / I don't have SSO. How do I sign in to Streamlit Community Cloud?","url":"/knowledge-base/deploy/sign-in-without-sso","visible":false},{"menu_key":"upgrade-the-streamlit-version-of-your-app-on-streamlit-community-cloud","name":"Upgrade the Streamlit version of your app on Streamlit Community Cloud","depth":"2","children":[],"category":"Knowledge base / Deployment issues / Upgrade the Streamlit version of your app on Streamlit Community Cloud","url":"/knowledge-base/deploy/upgrade-streamlit-version-on-streamlit-cloud","visible":false},{"menu_key":"custom-subdomains","name":"Custom subdomains","depth":"2","children":[],"category":"Knowledge base / Deployment issues / Custom subdomains","url":"/knowledge-base/deploy/custom-subdomains","visible":false},{"menu_key":"how-to-update-account-admin-settings-on-streamlit-community-cloud","name":"How to update account admin settings on Streamlit Community Cloud?","depth":"2","children":[],"category":"Knowledge base / Deployment issues / How to update account admin settings on Streamlit Community Cloud?","url":"/knowledge-base/deploy/how-to-update-account-admin-settings-on-streamlit-community-cloud","visible":false},{"menu_key":"unable-to-edit-or-delete-apps-in-streamlit-community-cloud-after-modifying-github-username","name":"Unable to edit or delete apps in Streamlit Community Cloud after modifying GitHub username","depth":"2","children":[],"category":"Knowledge base / Deployment issues / Unable to edit or delete apps in Streamlit Community Cloud after modifying GitHub username","url":"/knowledge-base/deploy/unable-to-edit-or-delete-apps-in-streamlit-community-cloud-after-modifying-github-username","visible":false},{"menu_key":"huh.-this-is-isn't-supposed-to-happen-message-after-trying-to-log-in","name":"Huh. This is isn't supposed to happen message after trying to log in","depth":"2","children":[],"category":"Knowledge base / Deployment issues / Huh. This is isn't supposed to happen message after trying to log in","url":"/knowledge-base/deploy/huh-this-isnt-supposed-to-happen-message-after-trying-to-log-in","visible":false},{"menu_key":"huh.-this-isn't-supposed-to-happen.-no-valid-sso-connection-for-domain","name":"Huh. This isn't supposed to happen. No valid SSO connection for domain","depth":"2","children":[],"category":"Knowledge base / Deployment issues / Huh. This isn't supposed to happen. No valid SSO connection for domain","url":"/knowledge-base/deploy/huh-this-isnt-supposed-to-happen-no-valid-sso-connection-for-domain","visible":false},{"menu_key":"view-only-access-to-app-after-changing-github-username-or-repository-name","name":"View-only access to app after changing GitHub username or repository name","depth":"2","children":[],"category":"Knowledge base / Deployment issues / View-only access to app after changing GitHub username or repository name","url":"/knowledge-base/deploy/view-only-access-to-app-after-changing-github-username-or-repository-name","visible":false},{"menu_key":"login-attempt-to-streamlit-community-cloud-fails-with-error-403","name":"Login attempt to Streamlit Community Cloud fails with error 403","depth":"2","children":[],"category":"Knowledge base / Deployment issues / Login attempt to Streamlit Community Cloud fails with error 403","url":"/knowledge-base/deploy/login-attempt-to-streamlit-community-cloud-fails-with-error-403","visible":false},{"menu_key":"how-to-submit-a-support-case-for-streamlit-community-cloud","name":"How to submit a support case for Streamlit Community Cloud","depth":"2","children":[],"category":"Knowledge base / Deployment issues / How to submit a support case for Streamlit Community Cloud","url":"/knowledge-base/deploy/how-to-submit-a-support-case-for-streamlit-community-cloud","visible":false},{"menu_key":"how-to-delete-your-streamlit-community-cloud-account","name":"How to delete your Streamlit Community Cloud account","depth":"2","children":[],"category":"Knowledge base / Deployment issues / How to delete your Streamlit Community Cloud account","url":"/knowledge-base/deploy/how-to-delete-your-streamlit-community-cloud-account","visible":false}],"category":"Knowledge base / Deployment issues","url":"/knowledge-base/deploy"}],"category":"Knowledge base","url":"/knowledge-base","color":"orange-70","icon":"school"}],"gdpr_data":{"data":{"enabled":false,"title":"We value your privacy."},"content":{"compiledSource":"var h=Object.defineProperty,d=Object.defineProperties;var w=Object.getOwnPropertyDescriptors;var r=Object.getOwnPropertySymbols;var s=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;var p=(o,t,e)=\u003et in o?h(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e,n=(o,t)=\u003e{for(var e in t||(t={}))s.call(t,e)\u0026\u0026p(o,e,t[e]);if(r)for(var e of r(t))a.call(t,e)\u0026\u0026p(o,e,t[e]);return o},u=(o,t)=\u003ed(o,w(t));var c=(o,t)=\u003e{var e={};for(var i in o)s.call(o,i)\u0026\u0026t.indexOf(i)\u003c0\u0026\u0026(e[i]=o[i]);if(o!=null\u0026\u0026r)for(var i of r(o))t.indexOf(i)\u003c0\u0026\u0026a.call(o,i)\u0026\u0026(e[i]=o[i]);return e};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(e){var i=e,{components:o}=i,t=c(i,[\"components\"]);return mdx(MDXLayout,u(n(n({},layoutProps),t),{components:o,mdxType:\"MDXLayout\"}),mdx(\"p\",null,\"We would like to use cookies to help us understand how users interact with this website. This is used, for example, to find out which parts of this site should be further improved.\"),mdx(\"p\",null,\"More information can be found in our \",mdx(\"a\",n({parentName:\"p\"},{href:\"www.streamlit.io/privacy-policy\"}),\"Privacy Notice\"),\".\"))}MDXContent.isMDXComponent=!0;\n","scope":{}},"title":"We value your privacy."},"data":{"title":"Caching","slug":"/library/advanced-features/caching"},"filename":"/opt/build/repo/content/library/advanced-features/caching.md","slug":["library","advanced-features","caching"],"source":{"compiledSource":"var p=Object.defineProperty,h=Object.defineProperties;var m=Object.getOwnPropertyDescriptors;var r=Object.getOwnPropertySymbols;var o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;var l=(a,t,n)=\u003et in a?p(a,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[t]=n,e=(a,t)=\u003e{for(var n in t||(t={}))o.call(t,n)\u0026\u0026l(a,n,t[n]);if(r)for(var n of r(t))s.call(t,n)\u0026\u0026l(a,n,t[n]);return a},d=(a,t)=\u003eh(a,m(t));var c=(a,t)=\u003e{var n={};for(var i in a)o.call(a,i)\u0026\u0026t.indexOf(i)\u003c0\u0026\u0026(n[i]=a[i]);if(a!=null\u0026\u0026r)for(var i of r(a))t.indexOf(i)\u003c0\u0026\u0026s.call(a,i)\u0026\u0026(n[i]=a[i]);return n};const makeShortcode=a=\u003efunction(n){return console.warn(\"Component \"+a+\" was not imported, exported, or provided by MDXProvider as global scope\"),mdx(\"div\",e({},n))},Note=makeShortcode(\"Note\"),Collapse=makeShortcode(\"Collapse\"),Image=makeShortcode(\"Image\"),Tip=makeShortcode(\"Tip\"),Warning=makeShortcode(\"Warning\"),layoutProps={},MDXLayout=\"wrapper\";function MDXContent(n){var i=n,{components:a}=i,t=c(i,[\"components\"]);return mdx(MDXLayout,d(e(e({},layoutProps),t),{components:a,mdxType:\"MDXLayout\"}),mdx(Note,{mdxType:\"Note\"},mdx(\"p\",null,\"Documentation for the deprecated \",mdx(\"inlineCode\",{parentName:\"p\"},\"@st.cache\"),\" decorator can be found in \",mdx(\"a\",e({parentName:\"p\"},{href:\"/library/advanced-features/st.cache\"}),\"Optimize performance with st.cache\"),\".\")),mdx(\"h1\",e({},{id:\"caching\"}),mdx(\"a\",e({parentName:\"h1\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#caching\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Caching\"),mdx(\"p\",null,\"Streamlit runs your script from top to bottom at every user interaction or code change. This execution model makes development super easy. But it comes with two major challenges:\"),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},\"Long-running functions run again and again, which slows down your app.\"),mdx(\"li\",{parentName:\"ol\"},\"Objects get recreated again and again, which makes it hard to persist them across reruns or sessions.\")),mdx(\"p\",null,\"But don't worry! Streamlit lets you tackle both issues with its built-in caching mechanism. Caching stores the results of slow function calls, so they only need to run once. This makes your app much faster and helps with persisting objects across reruns.\"),mdx(Collapse,{title:\"Table of contents\",expanded:!0,mdxType:\"Collapse\"},mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},mdx(\"a\",e({parentName:\"li\"},{href:\"#minimal-example\"}),\"Minimal example\")),mdx(\"li\",{parentName:\"ol\"},mdx(\"a\",e({parentName:\"li\"},{href:\"#basic-usage\"}),\"Basic usage\")),mdx(\"li\",{parentName:\"ol\"},mdx(\"a\",e({parentName:\"li\"},{href:\"#advanced-usage\"}),\"Advanced usage\")),mdx(\"li\",{parentName:\"ol\"},mdx(\"a\",e({parentName:\"li\"},{href:\"#migrating-from-stcache\"}),\"Migrating from st.cache\")))),mdx(\"h2\",e({},{id:\"minimal-example\"}),mdx(\"a\",e({parentName:\"h2\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#minimal-example\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Minimal example\"),mdx(\"p\",null,\"To cache a function in Streamlit, you must decorate it with one of two decorators (\",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_data\"),\" or \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_resource\"),\"):\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`@st.cache_data\ndef long_running_function(param1, param2):\n    return \\u2026\n`)),mdx(\"p\",null,\"In this example, decorating \",mdx(\"inlineCode\",{parentName:\"p\"},\"long_running_function\"),\" with \",mdx(\"inlineCode\",{parentName:\"p\"},\"@st.cache_data\"),\" tells Streamlit that whenever the function is called, it checks two things:\"),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},\"The values of the input parameters (in this case, \",mdx(\"inlineCode\",{parentName:\"li\"},\"param1\"),\" and \",mdx(\"inlineCode\",{parentName:\"li\"},\"param2\"),\").\"),mdx(\"li\",{parentName:\"ol\"},\"The code inside the function.\")),mdx(\"p\",null,\"If this is the first time Streamlit sees these parameter values and function code, it runs the function and stores the return value in a cache. The next time the function is called with the same parameters and code (e.g., when a user interacts with the app), Streamlit will skip executing the function altogether and return the cached value instead. During development, the cache updates automatically as the function code changes, ensuring that the latest changes are reflected in the cache.\"),mdx(\"p\",null,\"As mentioned, there are two caching decorators:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"st.cache_data\"),\"\\xA0is the recommended way to cache computations that return data: loading a DataFrame from CSV, transforming a NumPy array, querying an API, or any other function that returns a serializable data object (str, int, float, DataFrame, array, list, \\u2026). It creates a new copy of the data at each function call, making it safe against \",mdx(\"a\",e({parentName:\"li\"},{href:\"#mutation-and-concurrency-issues\"}),\"mutations and race conditions\"),\". The behavior of \",mdx(\"inlineCode\",{parentName:\"li\"},\"st.cache_data\"),\" is what you want in most cases \\u2013 so if you're unsure, start with\\xA0\",mdx(\"inlineCode\",{parentName:\"li\"},\"st.cache_data\"),\"\\xA0and see if it works!\"),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"st.cache_resource\"),\"\\xA0is the recommended way to cache global resources like ML models or database connections \\u2013 unserializable objects that you don't want to load multiple times. Using it, you can share these resources across all reruns and sessions of an app without copying or duplication. Note that any mutations to the cached return value directly mutate the object in the cache (more details below).\")),mdx(Image,{src:\"/images/caching-high-level-diagram.png\",caption:\"Streamlit's two caching decorators and their use cases.\",alt:\"Streamlit's two caching decorators and their use cases. Use st.cache_data for anything you'd store in a database. Use st.cache_resource for anything you can't store in a database, like a connection to a database or a machine learning model.\",mdxType:\"Image\"}),mdx(\"h2\",e({},{id:\"basic-usage\"}),mdx(\"a\",e({parentName:\"h2\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#basic-usage\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Basic usage\"),mdx(\"h3\",e({},{id:\"stcache_data\"}),mdx(\"a\",e({parentName:\"h3\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#stcache_data\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"st.cache_data\"),mdx(\"p\",null,mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_data\"),\" is your go-to command for all functions that return data \\u2013 whether DataFrames, NumPy arrays, str, int, float, or other serializable types. It's the right command for almost all use cases!\"),mdx(\"h4\",e({},{id:\"usage\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#usage\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Usage\"),mdx(\"br\",null),mdx(\"p\",null,\"Let's look at an example of using\\xA0\",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_data\"),\". Suppose your app loads the \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://github.com/plotly/datasets/blob/master/uber-rides-data1.csv\"}),\"Uber ride-sharing dataset\"),\" \\u2013 a CSV file of 50 MB \\u2013 from the internet into a DataFrame:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`def load_data(url):\n    df = pd.read_csv(url)  # \\u{1F448} Download the data\n    return df\n\ndf = load_data(\"https://github.com/plotly/datasets/raw/master/uber-rides-data1.csv\")\nst.dataframe(df)\n\nst.button(\"Rerun\")\n`)),mdx(\"p\",null,\"Running the \",mdx(\"inlineCode\",{parentName:\"p\"},\"load_data\"),\" function takes 2 to 30 seconds, depending on your internet connection. (Tip: if you are on a slow connection, use \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://github.com/plotly/datasets/blob/master/26k-consumer-complaints.csv\"}),\"this 5 MB dataset instead\"),\"). Without caching, the download is rerun each time the app is loaded or with user interaction. Try it yourself by clicking the button we added! Not a great experience\\u2026 \\u{1F615}\"),mdx(\"p\",null,\"Now let's add the\\xA0\",mdx(\"inlineCode\",{parentName:\"p\"},\"@st.cache_data\"),\"\\xA0decorator on \",mdx(\"inlineCode\",{parentName:\"p\"},\"load_data\"),\":\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`@st.cache_data  # \\u{1F448} Add the caching decorator\ndef load_data(url):\n    df = pd.read_csv(url)\n    return df\n\ndf = load_data(\"https://github.com/plotly/datasets/raw/master/uber-rides-data1.csv\")\nst.dataframe(df)\n\nst.button(\"Rerun\")\n`)),mdx(\"p\",null,\"Run the app again. You'll notice that the slow download only happens on the first run. Every subsequent rerun should be almost instant! \\u{1F4A8}\"),mdx(\"h4\",e({},{id:\"behavior\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#behavior\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Behavior\"),mdx(\"br\",null),mdx(\"p\",null,\"How does this work? Let's go through the behavior of \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_data\"),\" step by step:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"On the first run, Streamlit recognizes that it has never called the \",mdx(\"inlineCode\",{parentName:\"li\"},\"load_data\"),\" function with the specified parameter value (the URL of the CSV file) So it runs the function and downloads the data.\"),mdx(\"li\",{parentName:\"ul\"},\"Now our caching mechanism becomes active: the returned DataFrame is serialized (converted to bytes) via\\xA0\",mdx(\"a\",e({parentName:\"li\"},{href:\"https://docs.python.org/3/library/pickle.html\"}),\"pickle\"),\"\\xA0and stored in the cache (together with the value of the \",mdx(\"inlineCode\",{parentName:\"li\"},\"url\"),\" parameter).\"),mdx(\"li\",{parentName:\"ul\"},\"On the next run, Streamlit checks the cache for an entry of \",mdx(\"inlineCode\",{parentName:\"li\"},\"load_data\"),\" with the specific \",mdx(\"inlineCode\",{parentName:\"li\"},\"url\"),\". There is one! So it retrieves the cached object, deserializes it to a DataFrame, and returns it instead of re-running the function and downloading the data again.\")),mdx(\"p\",null,\"This process of serializing and deserializing the cached object creates a copy of our original DataFrame. While this copying behavior may seem unnecessary, it's what we want when caching data objects since it effectively prevents mutation and concurrency issues. Read the section \\u201C\",mdx(\"a\",e({parentName:\"p\"},{href:\"#mutation-and-concurrency-issues\"}),\"Mutation and concurrency issues\"),'\" below to understand this in more detail.'),mdx(\"h4\",e({},{id:\"examples\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#examples\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Examples\"),mdx(\"br\",null),mdx(\"p\",null,mdx(\"strong\",{parentName:\"p\"},\"DataFrame transformations\")),mdx(\"p\",null,\"In the example above, we already showed how to cache loading a DataFrame. It can also be useful to cache DataFrame transformations such as \",mdx(\"inlineCode\",{parentName:\"p\"},\"df.filter\"),\", \",mdx(\"inlineCode\",{parentName:\"p\"},\"df.apply\"),\", or \",mdx(\"inlineCode\",{parentName:\"p\"},\"df.sort_values\"),\". Especially with large DataFrames, these operations can be slow.\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`@st.cache_data\ndef transform(df):\n    df = df.filter(items=['one', 'three'])\n    df = df.apply(np.sum, axis=0)\n    return df\n`)),mdx(\"p\",null,mdx(\"strong\",{parentName:\"p\"},\"Array computations\")),mdx(\"p\",null,\"Similarly, it can make sense to cache computations on NumPy arrays:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`@st.cache_data\ndef add(arr1, arr2):\n    return arr1 + arr2\n`)),mdx(\"p\",null,mdx(\"strong\",{parentName:\"p\"},\"Database queries\")),mdx(\"p\",null,\"You usually make SQL queries to load data into your app when working with databases. Repeatedly running these queries can be slow, cost money, and degrade the performance of your database. We strongly recommend caching any database queries in your app. See also \",mdx(\"a\",e({parentName:\"p\"},{href:\"/knowledge-base/tutorials/databases\"}),\"our guides on connecting Streamlit to different databases\"),\" for in-depth examples.\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`connection = database.connect()\n\n@st.cache_data\ndef query():\n    return pd.read_sql_query(\"SELECT * from table\", connection)\n`)),mdx(Tip,{mdxType:\"Tip\"},mdx(\"p\",null,\"You should set a \",mdx(\"inlineCode\",{parentName:\"p\"},\"ttl\"),\" (time to live) to get new results from your database. If you set \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_data(ttl=3600)\"),\", Streamlit invalidates any cached values after 1 hour (3600 seconds) and runs the cached function again. See details in \",mdx(\"a\",e({parentName:\"p\"},{href:\"#controlling-cache-size-and-duration\"}),\"Controlling cache size and duration\"),\".\")),mdx(\"p\",null,mdx(\"strong\",{parentName:\"p\"},\"API calls\")),mdx(\"p\",null,\"Similarly, it makes sense to cache API calls. Doing so also avoids rate limits.\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`@st.cache_data\ndef api_call():\n    response = requests.get('https://jsonplaceholder.typicode.com/posts/1')\n    return response.json()\n`)),mdx(\"p\",null,mdx(\"strong\",{parentName:\"p\"},\"Running ML models (inference)\")),mdx(\"p\",null,\"Running complex machine learning models can use significant time and memory. To avoid rerunning the same computations over and over, use caching.\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`@st.cache_data\ndef run_model(inputs):\n    return model(inputs)\n`)),mdx(\"h3\",e({},{id:\"stcache_resource\"}),mdx(\"a\",e({parentName:\"h3\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#stcache_resource\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"st.cache_resource\"),mdx(\"p\",null,mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_resource\"),' is the right command to cache \\u201Cresources\" that should be available globally across all users, sessions, and reruns. It has more limited use cases than ',mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_data\"),\", especially for caching database connections and ML models.\"),mdx(\"h4\",e({},{id:\"usage-1\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#usage-1\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Usage\"),mdx(\"p\",null,\"As an example for \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_resource\"),\", let's look at a typical machine learning app. As a first step, we need to load an ML model. We do this with \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://huggingface.co/docs/transformers/index\"}),\"Hugging Face's transformers library\"),\":\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`from transformers import pipeline\nmodel = pipeline(\"sentiment-analysis\")  # \\u{1F448} Load the model\n`)),mdx(\"p\",null,\"If we put this code into a Streamlit app directly, the app will load the model at each rerun or user interaction. Repeatedly loading the model poses two problems:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"Loading the model takes time and slows down the app.\"),mdx(\"li\",{parentName:\"ul\"},\"Each session loads the model from scratch, which takes up a huge amount of memory.\")),mdx(\"p\",null,\"Instead, it would make much more sense to load the model once and use that same object across all users and sessions. That's exactly the use case for \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_resource\"),\"! Let's add it to our app and process some text the user entered:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`from transformers import pipeline\n\n@st.cache_resource  # \\u{1F448} Add the caching decorator\ndef load_model():\n    return pipeline(\"sentiment-analysis\")\n\nmodel = load_model()\n\nquery = st.text_input(\"Your query\", value=\"I love Streamlit! \\u{1F388}\")\nif query:\n    result = model(query)[0]  # \\u{1F448} Classify the query text\n    st.write(result)\n`)),mdx(\"p\",null,\"If you run this app, you'll see that the app calls \",mdx(\"inlineCode\",{parentName:\"p\"},\"load_model\"),\" only once \\u2013 right when the app starts. Subsequent runs will reuse that same model stored in the cache, saving time and memory!\"),mdx(\"h4\",e({},{id:\"behavior-1\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#behavior-1\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Behavior\"),mdx(\"br\",null),mdx(\"p\",null,\"Using \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_resource\"),\" is very similar to using \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_data\"),\". But there are a few important differences in behavior:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\"},mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_resource\"),\" does \",mdx(\"strong\",{parentName:\"p\"},\"not\"),\" create a copy of the cached return value but instead stores the object itself in the cache. All mutations on the function's return value directly affect the object in the cache, so you must ensure that mutations from multiple sessions do not cause problems. In short, the return value must be thread-safe.\"),mdx(Warning,{mdxType:\"Warning\"},mdx(\"p\",{parentName:\"li\"},\"Using \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_resource\"),\" on objects that are not thread-safe might lead to crashes or corrupted data. Learn more below under \",mdx(\"a\",e({parentName:\"p\"},{href:\"#mutation-and-concurrency-issues\"}),\"Mutation and concurrency issues\"),\".\"))),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\"},\"Not creating a copy means there's just one global instance of the cached return object, which saves memory, e.g. when using a large ML model. In computer science terms, we create a \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://en.wikipedia.org/wiki/Singleton_pattern\"}),\"singleton\"),\".\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\"},\"Return values of functions do not need to be serializable. This behavior is great for types not serializable by nature, e.g., database connections, file handles, or threads. Caching these objects with \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_data\"),\" is not possible.\"))),mdx(\"h4\",e({},{id:\"examples-1\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#examples-1\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Examples\"),mdx(\"br\",null),mdx(\"p\",null,mdx(\"strong\",{parentName:\"p\"},\"Database connections\")),mdx(\"p\",null,mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_resource\"),\" is useful for connecting to databases. Usually, you're creating a connection object that you want to reuse globally for every query. Creating a new connection object at each run would be inefficient and might lead to connection errors. That's exactly what \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_resource\"),\" can do, e.g., for a Postgres database:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`@st.cache_resource\ndef init_connection():\n    host = \"hh-pgsql-public.ebi.ac.uk\"\n    database = \"pfmegrnargs\"\n    user = \"reader\"\n    password = \"NWDMCE5xdipIjRrp\"\n    return psycopg2.connect(host=host, database=database, user=user, password=password)\n\nconn = init_connection()\n`)),mdx(\"p\",null,\"Of course, you can do the same for any other database. Have a look at \",mdx(\"a\",e({parentName:\"p\"},{href:\"/knowledge-base/tutorials/databases\"}),\"our guides on how to connect Streamlit to databases\"),\" for in-depth examples.\"),mdx(\"p\",null,mdx(\"strong\",{parentName:\"p\"},\"Loading ML models\")),mdx(\"p\",null,\"Your app should always cache ML models, so they are not loaded into memory again for every new session. See the \",mdx(\"a\",e({parentName:\"p\"},{href:\"#usage-1\"}),\"example\"),\" above for how this works with \\u{1F917}\\xA0Hugging Face models. You can do the same thing for PyTorch, TensorFlow, etc. Here's an example for PyTorch:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`@st.cache_resource\ndef load_model():\n    model = torchvision.models.resnet50(weights=ResNet50_Weights.DEFAULT)\n    model.eval()\n    return model\n\nmodel = load_model()\n`)),mdx(\"h3\",e({},{id:\"deciding-which-caching-decorator-to-use\"}),mdx(\"a\",e({parentName:\"h3\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#deciding-which-caching-decorator-to-use\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Deciding which caching decorator to use\"),mdx(\"br\",null),mdx(\"p\",null,`The sections above showed many common examples for each caching decorator. But there are edge cases for which it's less trivial to decide which caching decorator to use. Eventually, it all comes down to the difference between \\u201Cdata\" and \\u201Cresource\":`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"Data are serializable objects (objects that can be converted to bytes via\\xA0\",mdx(\"a\",e({parentName:\"li\"},{href:\"https://docs.python.org/3/library/pickle.html\"}),\"pickle\"),\") that you could easily save to disk. Imagine all the types you would usually store in a database or on a file system \\u2013 basic types like str, int, and float, but also arrays, DataFrames, images, or combinations of these types (lists, tuples, dicts, and so on).\"),mdx(\"li\",{parentName:\"ul\"},\"Resources are unserializable objects that you usually would not save to disk or a database. They are often more complex, non-permanent objects like database connections, ML models, file handles, threads, etc.\")),mdx(\"p\",null,`From the types listed above, it should be obvious that most objects in Python are \\u201Cdata.\" That's also why `,mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_data\"),\" is the correct command for almost all use cases. \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_resource\"),\" is a more exotic command that you should only use in specific situations.\"),mdx(\"p\",null,\"Or if you're lazy and don't want to think too much, look up your use case or return type in the table below \\u{1F609}:\"),mdx(\"table\",null,mdx(\"thead\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"thead\"},mdx(\"th\",e({parentName:\"tr\"},{align:\"left\"}),\"Use case\"),mdx(\"th\",e({parentName:\"tr\"},{align:\"right\"}),\"Typical return types\"),mdx(\"th\",e({parentName:\"tr\"},{align:\"right\"}),\"Caching decorator\"))),mdx(\"tbody\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:\"left\"}),\"Reading a CSV file with pd.read_csv\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"right\"}),\"pandas.DataFrame\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"right\"}),\"st.cache_data\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:\"left\"}),\"Reading a text file\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"right\"}),\"str, list of str\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"right\"}),\"st.cache_data\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:\"left\"}),\"Transforming pandas dataframes\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"right\"}),\"pandas.DataFrame, pandas.Series\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"right\"}),\"st.cache_data\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:\"left\"}),\"Computing with numpy arrays\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"right\"}),\"numpy.ndarray\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"right\"}),\"st.cache_data\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:\"left\"}),\"Simple computations with basic types\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"right\"}),\"str, int, float, \\u2026\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"right\"}),\"st.cache_data\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:\"left\"}),\"Querying a database\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"right\"}),\"pandas.DataFrame\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"right\"}),\"st.cache_data\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:\"left\"}),\"Querying an API\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"right\"}),\"pandas.DataFrame, str, dict\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"right\"}),\"st.cache_data\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:\"left\"}),\"Running an ML model (inference)\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"right\"}),\"pandas.DataFrame, str, int, dict, list\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"right\"}),\"st.cache_data\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:\"left\"}),\"Creating or processing images\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"right\"}),\"PIL.Image.Image, numpy.ndarray\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"right\"}),\"st.cache_data\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:\"left\"}),\"Creating charts\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"right\"}),\"matplotlib.figure.Figure, plotly.graph_objects.Figure, altair.Chart\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"right\"}),\"st.cache_data (but some libraries require st.cache_resource, since the chart object is not serializable \\u2013 make sure not to mutate the chart after creation!)\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:\"left\"}),\"Loading ML models\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"right\"}),\"transformers.Pipeline, torch.nn.Module, tensorflow.keras.Model\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"right\"}),\"st.cache_resource\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:\"left\"}),\"Initializing database connections\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"right\"}),\"pyodbc.Connection, sqlalchemy.engine.base.Engine, psycopg2.connection, mysql.connector.MySQLConnection, sqlite3.Connection\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"right\"}),\"st.cache_resource\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:\"left\"}),\"Opening persistent file handles\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"right\"}),\"_\",\"io.TextIOWrapper\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"right\"}),\"st.cache_resource\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:\"left\"}),\"Opening persistent threads\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"right\"}),\"threading.thread\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"right\"}),\"st.cache_resource\")))),mdx(\"h2\",e({},{id:\"advanced-usage\"}),mdx(\"a\",e({parentName:\"h2\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#advanced-usage\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Advanced usage\"),mdx(\"h3\",e({},{id:\"controlling-cache-size-and-duration\"}),mdx(\"a\",e({parentName:\"h3\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#controlling-cache-size-and-duration\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Controlling cache size and duration\"),mdx(\"p\",null,\"If your app runs for a long time and constantly caches functions, you might run into two problems:\"),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},\"The app runs out of memory because the cache is too large.\"),mdx(\"li\",{parentName:\"ol\"},\"Objects in the cache become stale, e.g. because you cached old data from a database.\")),mdx(\"p\",null,\"You can combat these problems with the \",mdx(\"inlineCode\",{parentName:\"p\"},\"ttl\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"max_entries\"),\" parameters, which are available for both caching decorators.\"),mdx(\"p\",null,mdx(\"strong\",{parentName:\"p\"},\"The \",mdx(\"inlineCode\",{parentName:\"strong\"},\"ttl\"),\" (time-to-live) parameter\")),mdx(\"p\",null,mdx(\"inlineCode\",{parentName:\"p\"},\"ttl\"),\" sets a time to live on a cached function. If that time is up and you call the function again, the app will discard any old, cached values, and the function will be rerun. The newly computed value will then be stored in the cache. This behavior is useful for preventing stale data (problem 2) and the cache from growing too large (problem 1). Especially when pulling data from a database or API, you should always set a \",mdx(\"inlineCode\",{parentName:\"p\"},\"ttl\"),\" so you are not using old data. Here's an example:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`@st.cache_data(ttl=3600)  # \\u{1F448} Cache data for 1 hour (=3600 seconds)\ndef get_api_data():\n    data = api.get(...)\n    return data\n`)),mdx(Tip,{mdxType:\"Tip\"},mdx(\"p\",null,\"You can also set \",mdx(\"inlineCode\",{parentName:\"p\"},\"ttl\"),\" values using \",mdx(\"inlineCode\",{parentName:\"p\"},\"timedelta\"),\", e.g., \",mdx(\"inlineCode\",{parentName:\"p\"},\"ttl=datetime.timedelta(hours=1)\"),\".\")),mdx(\"p\",null,mdx(\"strong\",{parentName:\"p\"},\"The \",mdx(\"inlineCode\",{parentName:\"strong\"},\"max_entries\"),\" parameter\")),mdx(\"p\",null,mdx(\"inlineCode\",{parentName:\"p\"},\"max_entries\"),\" sets the maximum number of entries in the cache. An upper bound on the number of cache entries is useful for limiting memory (problem 1), especially when caching large objects. The oldest entry will be removed when a new entry is added to a full cache. Here's an example:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`@st.cache_data(max_entries=1000)  # \\u{1F448} Maximum 1000 entries in the cache\ndef get_large_array(seed):\n    np.random.seed(seed)\n    arr = np.random.rand(100000)\n    return arr\n`)),mdx(\"h3\",e({},{id:\"customizing-the-spinner\"}),mdx(\"a\",e({parentName:\"h3\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#customizing-the-spinner\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Customizing the spinner\"),mdx(\"p\",null,\"By default, Streamlit shows a small loading spinner in the app when a cached function is running. You can modify it easily with the \",mdx(\"inlineCode\",{parentName:\"p\"},\"show_spinner\"),\" parameter, which is available for both caching decorators:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`@st.cache_data(show_spinner=False)  # \\u{1F448} Disable the spinner\ndef get_api_data():\n    data = api.get(...)\n    return data\n\n@st.cache_data(show_spinner=\"Fetching data from API...\")  # \\u{1F448} Use custom text for spinner\ndef get_api_data():\n    data = api.get(...)\n    return data\n`)),mdx(\"h3\",e({},{id:\"excluding-input-parameters\"}),mdx(\"a\",e({parentName:\"h3\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#excluding-input-parameters\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Excluding input parameters\"),mdx(\"p\",null,\"In a cached function, all input parameters must be hashable. Let's quickly explain why and what it means. When the function is called, Streamlit looks at its parameter values to determine if it was cached before. Therefore, it needs a reliable way to compare the parameter values across function calls. Trivial for a string or int \\u2013 but complex for arbitrary objects! Streamlit uses \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://en.wikipedia.org/wiki/Hash_function\"}),\"hashing\"),\" to solve that. It converts the parameter to a stable key and stores that key. At the next function call, it hashes the parameter again and compares it with the stored hash key.\"),mdx(\"p\",null,\"Unfortunately, not all parameters are hashable! E.g., you might pass an unhashable database connection or ML model to your cached function. In this case, you can exclude input parameters from caching. Simply prepend the parameter name with an underscore (e.g., \",mdx(\"inlineCode\",{parentName:\"p\"},\"_param1\"),\"), and it will not be used for caching. Even if it changes, Streamlit will return a cached result if all the other parameters match up.\"),mdx(\"p\",null,\"Here's an example:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`@st.cache_data\ndef fetch_data(_db_connection, num_rows):  # \\u{1F448} Don't hash _db_connection\n    data = _db_connection.fetch(num_rows)\n    return data\n\nconnection = init_connection()\nfetch_data(connection, 10)\n`)),mdx(\"p\",null,\"But what if you want to cache a function that takes an unhashable parameter? For example, you might want to cache a function that takes an ML model as input and returns the layer names of that model. Since the model is the only input parameter, you cannot exclude it from caching. In this case you can use the \",mdx(\"inlineCode\",{parentName:\"p\"},\"hash_funcs\"),\" parameter to specify a custom hashing function for the model.\"),mdx(\"h3\",e({},{id:\"the-hash_funcs-parameter\"}),mdx(\"a\",e({parentName:\"h3\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#the-hash_funcs-parameter\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"The \",mdx(\"inlineCode\",{parentName:\"h3\"},\"hash_funcs\"),\" parameter\"),mdx(\"p\",null,`As described above, Streamlit's caching decorators hash the input parameters and cached function's signature to determine whether the function has been run before and has a return value stored (\"cache hit\") or needs to be run (\"cache miss\"). Input parameters that are not hashable by Streamlit's hashing implementation can be ignored by prepending an underscore to their name. But there two rare cases where this is undesirable. i.e. where you want to hash the parameter that Streamlit is unable to hash:`),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},\"When Streamlit's hashing mechanism fails to hash a parameter, resulting in a \",mdx(\"inlineCode\",{parentName:\"li\"},\"UnhashableParamError\"),\" being raised.\"),mdx(\"li\",{parentName:\"ol\"},\"When you want to override Streamlit's default hashing mechanism for a parameter.\")),mdx(\"p\",null,\"Let's discuss each of these cases in turn with examples.\"),mdx(\"h4\",e({},{id:\"example-1-hashing-a-custom-class\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#example-1-hashing-a-custom-class\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Example 1: Hashing a custom class\"),mdx(\"p\",null,\"Streamlit does not know how to hash custom classes. If you pass a custom class to a cached function, Streamlit will raise a \",mdx(\"inlineCode\",{parentName:\"p\"},\"UnhashableParamError\"),\". For example, let's define a custom class \",mdx(\"inlineCode\",{parentName:\"p\"},\"MyCustomClass\"),\" that accepts an initial integer score. Let's also define a cached function \",mdx(\"inlineCode\",{parentName:\"p\"},\"multiply_score\"),\" that multiplies the score by a multiplier:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`import streamlit as st\n\nclass MyCustomClass:\n    def __init__(self, initial_score: int):\n        self.my_score = initial_score\n\n@st.cache_data\ndef multiply_score(obj: MyCustomClass, multiplier: int) -\u003e int:\n    return obj.my_score * multiplier\n\ninitial_score = st.number_input(\"Enter initial score\", value=15)\n\nscore = MyCustomClass(initial_score)\nmultiplier = 2\n\nst.write(multiply_score(score, multiplier))\n`)),mdx(\"p\",null,\"If you run this app, you'll see that Streamlit raises a \",mdx(\"inlineCode\",{parentName:\"p\"},\"UnhashableParamError\"),\" since it does not know how to hash \",mdx(\"inlineCode\",{parentName:\"p\"},\"MyCustomClass\"),\":\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`UnhashableParamError: Cannot hash argument 'obj' (of type __main__.MyCustomClass) in 'multiply_score'.\n`)),mdx(\"p\",null,\"To fix this, we can use the \",mdx(\"inlineCode\",{parentName:\"p\"},\"hash_funcs\"),\" parameter to tell Streamlit how to hash \",mdx(\"inlineCode\",{parentName:\"p\"},\"MyCustomClass\"),\". We do this by passing a dictionary to \",mdx(\"inlineCode\",{parentName:\"p\"},\"hash_funcs\"),\" that maps the name of the parameter to a hash function. The choice of hash function is up to the developer. In this case, let's define a custom hash function \",mdx(\"inlineCode\",{parentName:\"p\"},\"hash_func\"),\" that takes the custom class as input and returns the score. We want the score to be the unique identifier of the object, so we can use it to deterministically hash the object:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`import streamlit as st\n\nclass MyCustomClass:\n    def __init__(self, initial_score: int):\n        self.my_score = initial_score\n\ndef hash_func(obj: MyCustomClass) -\u003e int:\n    return obj.my_score  # or any other value that uniquely identifies the object\n\n@st.cache_data(hash_funcs={MyCustomClass: hash_func})\ndef multiply_score(obj: MyCustomClass, multiplier: int) -\u003e int:\n    return obj.my_score * multiplier\n\ninitial_score = st.number_input(\"Enter initial score\", value=15)\n\nscore = MyCustomClass(initial_score)\nmultiplier = 2\n\nst.write(multiply_score(score, multiplier))\n`)),mdx(\"p\",null,\"Now if you run the app, you'll see that Streamlit no longer raises a \",mdx(\"inlineCode\",{parentName:\"p\"},\"UnhashableParamError\"),\" and the app runs as expected.\"),mdx(\"p\",null,\"Let's now consider the case where \",mdx(\"inlineCode\",{parentName:\"p\"},\"multiply_score\"),\" is an attribute of \",mdx(\"inlineCode\",{parentName:\"p\"},\"MyCustomClass\"),\" and we want to hash the entire object:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`import streamlit as st\n\nclass MyCustomClass:\n    def __init__(self, initial_score: int):\n        self.my_score = initial_score\n\n    @st.cache_data\n    def multiply_score(self, multiplier: int) -\u003e int:\n        return self.my_score * multiplier\n\ninitial_score = st.number_input(\"Enter initial score\", value=15)\n\nscore = MyCustomClass(initial_score)\nmultiplier = 2\n\nst.write(score.multiply_score(multiplier))\n`)),mdx(\"p\",null,\"If you run this app, you'll see that Streamlit raises a \",mdx(\"inlineCode\",{parentName:\"p\"},\"UnhashableParamError\"),\" since it cannot hash the argument \",mdx(\"inlineCode\",{parentName:\"p\"},\"'self' (of type __main__.MyCustomClass) in 'multiply_score'\"),\". A simple fix here could be to use Python's \",mdx(\"inlineCode\",{parentName:\"p\"},\"hash()\"),\" function to hash the object:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`import streamlit as st\n\nclass MyCustomClass:\n    def __init__(self, initial_score: int):\n        self.my_score = initial_score\n\n    @st.cache_data(hash_funcs={\"__main__.MyCustomClass\": lambda x: hash(x.my_score)})\n    def multiply_score(self, multiplier: int) -\u003e int:\n        return self.my_score * multiplier\n\ninitial_score = st.number_input(\"Enter initial score\", value=15)\n\nscore = MyCustomClass(initial_score)\nmultiplier = 2\n\nst.write(score.multiply_score(multiplier))\n`)),mdx(\"p\",null,\"Above, the hash function is defined as \",mdx(\"inlineCode\",{parentName:\"p\"},\"lambda x: hash(x.my_score)\"),\". This creates a hash based on the \",mdx(\"inlineCode\",{parentName:\"p\"},\"my_score\"),\" attribute of the \",mdx(\"inlineCode\",{parentName:\"p\"},\"MyCustomClass\"),\" instance. As long as \",mdx(\"inlineCode\",{parentName:\"p\"},\"my_score\"),\" remains the same, the hash remains the same. Thus, the result of \",mdx(\"inlineCode\",{parentName:\"p\"},\"multiply_score\"),\" can be retrieved from the cache without recomputation.\"),mdx(\"p\",null,\"As an astute Pythonista, you may have been tempted to use Python's \",mdx(\"inlineCode\",{parentName:\"p\"},\"id()\"),\" function to hash the object like so:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`import streamlit as st\n\nclass MyCustomClass:\n    def __init__(self, initial_score: int):\n        self.my_score = initial_score\n\n    @st.cache_data(hash_funcs={\"__main__.MyCustomClass\": id})\n    def multiply_score(self, multiplier: int) -\u003e int:\n        return self.my_score * multiplier\n\ninitial_score = st.number_input(\"Enter initial score\", value=15)\n\nscore = MyCustomClass(initial_score)\nmultiplier = 2\n\nst.write(score.multiply_score(multiplier))\n`)),mdx(\"p\",null,\"If you run the app, you'll notice that Streamlit recomputes \",mdx(\"inlineCode\",{parentName:\"p\"},\"multiply_score\"),\" each time even if \",mdx(\"inlineCode\",{parentName:\"p\"},\"my_score\"),\" hasn't changed! Puzzled? In Python, \",mdx(\"inlineCode\",{parentName:\"p\"},\"id()\"),\" returns the identity of an object, which is unique and constant for the object during its lifetime. This means that even if the \",mdx(\"inlineCode\",{parentName:\"p\"},\"my_score\"),\" value is the same between two instances of \",mdx(\"inlineCode\",{parentName:\"p\"},\"MyCustomClass\"),\", \",mdx(\"inlineCode\",{parentName:\"p\"},\"id()\"),\" will return different values for these two instances, leading to different hash values. As a result, Streamlit considers these two different instances as needing separate cached values, thus it recomputes the \",mdx(\"inlineCode\",{parentName:\"p\"},\"multiply_score\"),\" each time even if \",mdx(\"inlineCode\",{parentName:\"p\"},\"my_score\"),\" hasn't changed.\"),mdx(\"p\",null,\"This is why we discourage using it as hash func, and instead encourage functions that return deterministic, true hash values. That said, if you know what you're doing, you can use \",mdx(\"inlineCode\",{parentName:\"p\"},\"id()\"),\" as a hash function. Just be aware of the consequences. For example, \",mdx(\"inlineCode\",{parentName:\"p\"},\"id\"),\" is often the \",mdx(\"em\",{parentName:\"p\"},\"correct\"),\" hash func when you're passing the result of an \",mdx(\"inlineCode\",{parentName:\"p\"},\"@st.cache_resource\"),\" function as the input param to another cached function. There's a whole class of object types that aren\\u2019t otherwise hashable.\"),mdx(\"h4\",e({},{id:\"example-2-hashing-a-pydantic-model\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#example-2-hashing-a-pydantic-model\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Example 2: Hashing a Pydantic model\"),mdx(\"p\",null,\"Let's consider another example where we want to hash a Pydantic model:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`import streamlit as st\nfrom pydantic import BaseModel\n\nclass Person(BaseModel):\n    name: str\n\n@st.cache_data\ndef identity(person: Person):\n    return person\n\nperson = identity(Person(name=\"Lee\"))\nst.write(f\"The person is {person.name}\")\n`)),mdx(\"p\",null,\"Above, we define a custom class \",mdx(\"inlineCode\",{parentName:\"p\"},\"Person\"),\" using Pydantic's \",mdx(\"inlineCode\",{parentName:\"p\"},\"BaseModel\"),\" with a single attribute name. We also define an \",mdx(\"inlineCode\",{parentName:\"p\"},\"identity\"),\" function which accepts an instance of \",mdx(\"inlineCode\",{parentName:\"p\"},\"Person\"),\" as an arg and returns it without modification. This function is intended to cache the result, therefore, if called multiple times with the same \",mdx(\"inlineCode\",{parentName:\"p\"},\"Person\"),\" instance, it won't recompute but return the cached instance.\"),mdx(\"p\",null,\"If you run the app, however, you'll run into a \",mdx(\"inlineCode\",{parentName:\"p\"},\"UnhashableParamError: Cannot hash argument 'person' (of type __main__.Person) in 'identity'.\"),\" error. This is because Streamlit does not know how to hash the \",mdx(\"inlineCode\",{parentName:\"p\"},\"Person\"),\" class. To fix this, we can use the \",mdx(\"inlineCode\",{parentName:\"p\"},\"hash_funcs\"),\" kwarg to tell Streamlit how to hash \",mdx(\"inlineCode\",{parentName:\"p\"},\"Person\"),\".\"),mdx(\"p\",null,\"In the version below, we define a custom hash function \",mdx(\"inlineCode\",{parentName:\"p\"},\"hash_func\"),\" that takes the \",mdx(\"inlineCode\",{parentName:\"p\"},\"Person\"),\" instance as input and returns the name attribute. We want the name to be the unique identifier of the object, so we can use it to deterministically hash the object:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`import streamlit as st\nfrom pydantic import BaseModel\n\nclass Person(BaseModel):\n    name: str\n\n@st.cache_data(hash_funcs={Person: lambda p: p.name})\ndef identity(person: Person):\n    return person\n\nperson = identity(Person(name=\"Lee\"))\nst.write(f\"The person is {person.name}\")\n`)),mdx(\"h4\",e({},{id:\"example-3-hashing-a-ml-model\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#example-3-hashing-a-ml-model\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Example 3: Hashing a ML model\"),mdx(\"p\",null,\"There may be cases where you want to pass your favorite machine learning model to a cached function. For example, let's say you want to pass a TensorFlow model to a cached function, based on what model the user selects in the app. You might try something like this:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`import streamlit as st\nimport tensorflow as tf\n\n@st.cache_resource\ndef load_base_model(option):\n    if option == 1:\n        return tf.keras.applications.ResNet50(include_top=False, weights=\"imagenet\")\n    else:\n        return tf.keras.applications.MobileNetV2(include_top=False, weights=\"imagenet\")\n\n@st.cache_resource\ndef load_layers(base_model):\n    return [layer.name for layer in base_model.layers]\n\noption = st.radio(\"Model 1 or 2\", [1, 2])\n\nbase_model = load_base_model(option)\n\nlayers = load_layers(base_model)\n\nst.write(layers)\n`)),mdx(\"p\",null,\"In the above app, the user can select one of two models. Based on the selection, the app loads the corresponding model and passes it to \",mdx(\"inlineCode\",{parentName:\"p\"},\"load_layers\"),\". This function then returns the names of the layers in the model. If you run the app, you'll see that Streamlit raises a \",mdx(\"inlineCode\",{parentName:\"p\"},\"UnhashableParamError\"),\" since it cannot hash the argument \",mdx(\"inlineCode\",{parentName:\"p\"},\"'base_model' (of type keras.engine.functional.Functional) in 'load_layers'\"),\".\"),mdx(\"p\",null,\"If you disable hashing for \",mdx(\"inlineCode\",{parentName:\"p\"},\"base_model\"),\" by prepending an underscore to its name, you'll observe that regardless of which base model is chosen, the layers displayed are same. This subtle bug is due to the fact that the \",mdx(\"inlineCode\",{parentName:\"p\"},\"load_layers\"),\" function is not re-run when the base model changes. This is because Streamlit does not hash the \",mdx(\"inlineCode\",{parentName:\"p\"},\"base_model\"),\" argument, so it does not know that the function needs to be re-run when the base model changes.\"),mdx(\"p\",null,\"To fix this, we can use the \",mdx(\"inlineCode\",{parentName:\"p\"},\"hash_funcs\"),\" kwarg to tell Streamlit how to hash the \",mdx(\"inlineCode\",{parentName:\"p\"},\"base_model\"),\" argument. In the version below, we define a custom hash function \",mdx(\"inlineCode\",{parentName:\"p\"},\"hash_func\"),\": \",mdx(\"inlineCode\",{parentName:\"p\"},\"Functional: lambda x: x.name\"),\". Our choice of hash func is informed by our knowledge that the \",mdx(\"inlineCode\",{parentName:\"p\"},\"name\"),\" attribute of a \",mdx(\"inlineCode\",{parentName:\"p\"},\"Functional\"),\" object or model uniquely identifies it. As long as the \",mdx(\"inlineCode\",{parentName:\"p\"},\"name\"),\" attribute remains the same, the hash remains the same. Thus, the result of \",mdx(\"inlineCode\",{parentName:\"p\"},\"load_layers\"),\" can be retrieved from the cache without recomputation.\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`import streamlit as st\nimport tensorflow as tf\nfrom keras.engine.functional import Functional\n\n@st.cache_resource\ndef load_base_model(option):\n    if option == 1:\n        return tf.keras.applications.ResNet50(include_top=False, weights=\"imagenet\")\n    else:\n        return tf.keras.applications.MobileNetV2(include_top=False, weights=\"imagenet\")\n\n@st.cache_resource(hash_funcs={Functional: lambda x: x.name})\ndef load_layers(base_model):\n    return [layer.name for layer in base_model.layers]\n\noption = st.radio(\"Model 1 or 2\", [1, 2])\n\nbase_model = load_base_model(option)\n\nlayers = load_layers(base_model)\n\nst.write(layers)\n`)),mdx(\"p\",null,\"In the above case, we could also have used \",mdx(\"inlineCode\",{parentName:\"p\"},\"hash_funcs={Functional: id}\"),\" as the hash function. This is because \",mdx(\"inlineCode\",{parentName:\"p\"},\"id\"),\" is often the \",mdx(\"em\",{parentName:\"p\"},\"correct\"),\" hash func when you're passing the result of an \",mdx(\"inlineCode\",{parentName:\"p\"},\"@st.cache_resource\"),\" function as the input param to another cached function.\"),mdx(\"h4\",e({},{id:\"example-4-overriding-streamlits-default-hashing-mechanism\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#example-4-overriding-streamlits-default-hashing-mechanism\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Example 4: Overriding Streamlit's default hashing mechanism\"),mdx(\"p\",null,\"Let's consider another example where we want to override Streamlit's default hashing mechanism for a pytz-localized datetime object:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`from datetime import datetime\nimport pytz\nimport streamlit as st\n\ntz = pytz.timezone(\"Europe/Berlin\")\n\n@st.cache_data\ndef load_data(dt):\n    return dt\n\nnow = datetime.now()\nst.text(load_data(dt=now))\n\nnow_tz = tz.localize(datetime.now())\nst.text(load_data(dt=now_tz))\n`)),mdx(\"p\",null,\"It may be surprising to see that although \",mdx(\"inlineCode\",{parentName:\"p\"},\"now\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"now_tz\"),\" are of the same \",mdx(\"inlineCode\",{parentName:\"p\"},\"\u003cclass 'datetime.datetime'\u003e\"),\" type, Streamlit does not how to hash \",mdx(\"inlineCode\",{parentName:\"p\"},\"now_tz\"),\" and raises a \",mdx(\"inlineCode\",{parentName:\"p\"},\"UnhashableParamError\"),\". In this case, we can override Streamlit's default hashing mechanism for \",mdx(\"inlineCode\",{parentName:\"p\"},\"datetime\"),\" objects by passing a custom hash function to the \",mdx(\"inlineCode\",{parentName:\"p\"},\"hash_funcs\"),\" kwarg:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`from datetime import datetime\n\nimport pytz\nimport streamlit as st\n\ntz = pytz.timezone(\"Europe/Berlin\")\n\n@st.cache_data(hash_funcs={datetime: lambda x: x.strftime(\"%a %d %b %Y, %I:%M%p\")})\ndef load_data(dt):\n    return dt\n\nnow = datetime.now()\nst.text(load_data(dt=now))\n\nnow_tz = tz.localize(datetime.now())\nst.text(load_data(dt=now_tz))\n`)),mdx(\"p\",null,\"Let's now consider a case where we want to override Streamlit's default hashing mechanism for NumPy arrays. While Streamlit natively hashes Pandas and NumPy objects, there may be cases where you want to override Streamlit's default hashing mechanism for these objects.\"),mdx(\"p\",null,\"For example, let's say we create a cache-decorated \",mdx(\"inlineCode\",{parentName:\"p\"},\"show_data\"),\" function that accepts a NumPy array and returns it without modification. In the bellow app, \",mdx(\"inlineCode\",{parentName:\"p\"},'data = df[\"str\"].unique()'),\" (which is a NumPy array) is passed to the \",mdx(\"inlineCode\",{parentName:\"p\"},\"show_data\"),\" function.\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`import time\nimport numpy as np\nimport pandas as pd\nimport streamlit as st\n\n@st.cache_data\ndef get_data():\n    df = pd.DataFrame({\"num\": [112, 112, 2, 3], \"str\": [\"be\", \"a\", \"be\", \"c\"]})\n    return df\n\n@st.cache_data\ndef show_data(data):\n    time.sleep(2)  # This makes the function take 2s to run\n    return data\n\ndf = get_data()\ndata = df[\"str\"].unique()\n\nst.dataframe(show_data(data))\nst.button(\"Re-run\")\n`)),mdx(\"p\",null,\"Since \",mdx(\"inlineCode\",{parentName:\"p\"},\"data\"),\" is always the same, we expect the \",mdx(\"inlineCode\",{parentName:\"p\"},\"show_data\"),\" function to return the cached value. However, if you run the app, and click the \",mdx(\"inlineCode\",{parentName:\"p\"},\"Re-run\"),\" button, you'll notice that the \",mdx(\"inlineCode\",{parentName:\"p\"},\"show_data\"),\" function is re-run each time. We can assume this behavior is a consequence of Streamlit's default hashing mechanism for NumPy arrays.\"),mdx(\"p\",null,\"To work around this, let's define a custom hash function \",mdx(\"inlineCode\",{parentName:\"p\"},\"hash_func\"),\" that takes a NumPy array as input and returns a string representation of the array:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`import time\nimport numpy as np\nimport pandas as pd\nimport streamlit as st\n\n@st.cache_data\ndef get_data():\n    df = pd.DataFrame({\"num\": [112, 112, 2, 3], \"str\": [\"be\", \"a\", \"be\", \"c\"]})\n    return df\n\n@st.cache_data(hash_funcs={np.ndarray: str})\ndef show_data(data):\n    time.sleep(2)  # This makes the function take 2s to run\n    return data\n\ndf = get_data()\ndata = df[\"str\"].unique()\n\nst.dataframe(show_data(data))\nst.button(\"Re-run\")\n`)),mdx(\"p\",null,\"Now if you run the app, and click the \",mdx(\"inlineCode\",{parentName:\"p\"},\"Re-run\"),\" button, you'll notice that the \",mdx(\"inlineCode\",{parentName:\"p\"},\"show_data\"),\" function is no longer re-run each time. It's important to note here that our choice of hash function was very naive and not necessarily the best choice. For example, if the NumPy array is large, converting it to a string representation may be expensive. In such cases, it is up to you as the developer to define what a good hash function is for your use case.\"),mdx(\"h4\",e({},{id:\"static-elements\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#static-elements\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Static elements\"),mdx(\"p\",null,\"Since version 1.16.0, cached functions can contain Streamlit commands! For example, you can do this:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`@st.cache_data\ndef get_api_data():\n    data = api.get(...)\n    st.success(\"Fetched data from API!\")  # \\u{1F448} Show a success message\n    return data\n`)),mdx(\"p\",null,\"As we know, Streamlit only runs this function if it hasn't been cached before. On this first run, the \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.success\"),\" message will appear in the app. But what happens on subsequent runs? It still shows up! Streamlit realizes that there is an \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.\"),\" command inside the cached function, saves it during the first run, and replays it on subsequent runs. Replaying static elements works for both caching decorators.\"),mdx(\"p\",null,\"You can also use this functionality to cache entire parts of your UI:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`@st.cache_data\ndef show_data():\n    st.header(\"Data analysis\")\n    data = api.get(...)\n    st.success(\"Fetched data from API!\")\n    st.write(\"Here is a plot of the data:\")\n    st.line_chart(data)\n    st.write(\"And here is the raw data:\")\n    st.dataframe(data)\n`)),mdx(\"h4\",e({},{id:\"input-widgets\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#input-widgets\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Input widgets\"),mdx(\"p\",null,\"You can also use \",mdx(\"a\",e({parentName:\"p\"},{href:\"/library/api-reference/widgets\"}),\"interactive input widgets\"),\" like \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.slider\"),\" or \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.text_input\"),\" in cached functions. Widget replay is an experimental feature at the moment. To enable it, you need to set the \",mdx(\"inlineCode\",{parentName:\"p\"},\"experimental_allow_widgets\"),\" parameter:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`@st.cache_data(experimental_allow_widgets=True)  # \\u{1F448} Set the parameter\ndef get_data():\n    num_rows = st.slider(\"Number of rows to get\")  # \\u{1F448} Add a slider\n    data = api.get(..., num_rows)\n    return data\n`)),mdx(\"p\",null,\"Streamlit treats the slider like an additional input parameter to the cached function. If you change the slider position, Streamlit will see if it has already cached the function for this slider value. If yes, it will return the cached value. If not, it will rerun the function using the new slider value.\"),mdx(\"p\",null,\"Using widgets in cached functions is extremely powerful because it lets you cache entire parts of your app. But it can be dangerous! Since Streamlit treats the widget value as an additional input parameter, it can easily lead to excessive memory usage. Imagine your cached function has five sliders and returns a 100 MB DataFrame. Then we'll add 100 MB to the cache for \",mdx(\"em\",{parentName:\"p\"},\"every permutation\"),\" of these five slider values \\u2013 even if the sliders do not influence the returned data! These additions can make your cache explode very quickly. Please be aware of this limitation if you use widgets in cached functions. We recommend using this feature only for isolated parts of your UI where the widgets directly influence the cached return value.\"),mdx(Warning,{mdxType:\"Warning\"},mdx(\"p\",null,\"Support for widgets in cached functions is experimental. We may change or remove it anytime without warning. Please use it with care!\")),mdx(Note,{mdxType:\"Note\"},mdx(\"p\",null,\"Two widgets are currently not supported in cached functions: \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.file_uploader\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.camera_input\"),\". We may support them in the future. Feel free to \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://github.com/streamlit/streamlit/issues\"}),\"open a GitHub issue\"),\" if you need them!\")),mdx(\"h3\",e({},{id:\"dealing-with-large-data\"}),mdx(\"a\",e({parentName:\"h3\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#dealing-with-large-data\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Dealing with large data\"),mdx(\"p\",null,\"As we explained, you should cache data objects with \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_data\"),\". But this can be slow for extremely large data, e.g., DataFrames or arrays with \u003e100 million rows. That's because of the \",mdx(\"a\",e({parentName:\"p\"},{href:\"#copying-behavior\"}),\"copying behavior\"),\" of \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_data\"),\": on the first run, it serializes the return value to bytes and deserializes it on subsequent runs. Both operations take time.\"),mdx(\"p\",null,\"If you're dealing with extremely large data, it can make sense to use \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_resource\"),\" instead. It does not create a copy of the return value via serialization/deserialization and is almost instant. But watch out: any mutation to the function's return value (such as dropping a column from a DataFrame or setting a value in an array) directly manipulates the object in the cache. You must ensure this doesn't corrupt your data or lead to crashes. See the section on \",mdx(\"a\",e({parentName:\"p\"},{href:\"#mutation-and-concurrency-issues\"}),\"Mutation and concurrency issues\"),\" below.\"),mdx(\"p\",null,\"When benchmarking \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_data\"),\" on pandas DataFrames with four columns, we found that it becomes slow when going beyond 100 million rows. The table shows runtimes for both caching decorators at different numbers of rows (all with four columns):\"),mdx(\"table\",null,mdx(\"thead\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"thead\"},mdx(\"th\",e({parentName:\"tr\"},{align:null})),mdx(\"th\",e({parentName:\"tr\"},{align:null})),mdx(\"th\",e({parentName:\"tr\"},{align:\"center\"}),\"10M rows\"),mdx(\"th\",e({parentName:\"tr\"},{align:\"center\"}),\"50M rows\"),mdx(\"th\",e({parentName:\"tr\"},{align:\"center\"}),\"100M rows\"),mdx(\"th\",e({parentName:\"tr\"},{align:\"center\"}),\"200M rows\"))),mdx(\"tbody\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"st.cache_data\"),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"First run\",\"*\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"center\"}),\"0.4 s\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"center\"}),\"3 s\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"center\"}),\"14 s\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"center\"}),\"28 s\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null})),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"Subsequent runs\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"center\"}),\"0.2 s\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"center\"}),\"1 s\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"center\"}),\"2 s\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"center\"}),\"7 s\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"st.cache_resource\"),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"First run\",\"*\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"center\"}),\"0.01 s\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"center\"}),\"0.1 s\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"center\"}),\"0.2 s\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"center\"}),\"1 s\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null})),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"Subsequent runs\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"center\"}),\"0 s\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"center\"}),\"0 s\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"center\"}),\"0 s\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"center\"}),\"0 s\")))),mdx(\"table\",null,mdx(\"thead\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"thead\"},mdx(\"th\",e({parentName:\"tr\"},{align:\"left\"})))),mdx(\"tbody\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:\"left\"}),mdx(\"em\",{parentName:\"td\"},\"*\",\"For the first run, the table only shows the overhead time of using the caching decorator. It does not include the runtime of the cached function itself.\"))))),mdx(\"h3\",e({},{id:\"mutation-and-concurrency-issues\"}),mdx(\"a\",e({parentName:\"h3\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#mutation-and-concurrency-issues\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Mutation and concurrency issues\"),mdx(\"p\",null,\"In the sections above, we talked a lot about issues when mutating return objects of cached functions. This topic is complicated! But it's central to understanding the behavior differences between \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_data\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_resource\"),\". So let's dive in a bit deeper.\"),mdx(\"p\",null,\"First, we should clearly define what we mean by mutations and concurrency:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\"},\"By \",mdx(\"strong\",{parentName:\"p\"},\"mutations\"),\", we mean any changes made to a cached function's return value \",mdx(\"em\",{parentName:\"p\"},\"after\"),\" that function has been called. I.e. something like this:\"),mdx(\"pre\",{parentName:\"li\"},mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`@st.cache_data\ndef create_list():\n    l = [1, 2, 3]\n\nl = create_list()  # \\u{1F448} Call the function\nl[0] = 2  # \\u{1F448} Mutate its return value\n`))),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\"},\"By \",mdx(\"strong\",{parentName:\"p\"},\"concurrency\"),\", we mean that multiple sessions can cause these mutations at the same time. Streamlit is a web framework that needs to handle many users and sessions connecting to an app. If two people view an app at the same time, they will both cause the Python script to rerun, which may manipulate cached return objects at the same time \\u2013 concurrently.\"))),mdx(\"p\",null,\"Mutating cached return objects can be dangerous. It can lead to exceptions in your app and even corrupt your data (which can be worse than a crashed app!). Below, we'll first explain the copying behavior of \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_data\"),\" and show how it can avoid mutation issues. Then, we'll show how concurrent mutations can lead to data corruption and how to prevent it.\"),mdx(\"h4\",e({},{id:\"copying-behavior\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#copying-behavior\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Copying behavior\"),mdx(\"p\",null,mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_data\"),\" creates a copy of the cached return value each time the function is called. This avoids most mutations and concurrency issues. To understand it in detail, let's go back to the \",mdx(\"a\",e({parentName:\"p\"},{href:\"#usage\"}),\"Uber ridesharing example\"),\" from the section on \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_data\"),\" above. We are making two modifications to it:\"),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},\"We are using \",mdx(\"inlineCode\",{parentName:\"li\"},\"st.cache_resource\"),\" instead of \",mdx(\"inlineCode\",{parentName:\"li\"},\"st.cache_data\"),\". \",mdx(\"inlineCode\",{parentName:\"li\"},\"st.cache_resource\"),\" does \",mdx(\"strong\",{parentName:\"li\"},\"not\"),\" create a copy of the cached object, so we can see what happens without the copying behavior.\"),mdx(\"li\",{parentName:\"ol\"},\"After loading the data, we manipulate the returned DataFrame (in place!) by dropping the column \",mdx(\"inlineCode\",{parentName:\"li\"},'\"Lat\"'),\".\")),mdx(\"p\",null,\"Here's the code:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`@st.cache_resource   # \\u{1F448} Turn off copying behavior\ndef load_data(url):\n    df = pd.read_csv(url)\n    return df\n\ndf = load_data(\"https://raw.githubusercontent.com/plotly/datasets/master/uber-rides-data1.csv\")\nst.dataframe(df)\n\ndf.drop(columns=['Lat'], inplace=True)  # \\u{1F448} Mutate the dataframe inplace\n\nst.button(\"Rerun\")\n`)),mdx(\"p\",null,\"Let's run it and see what happens! The first run should work fine. But in the second run, you see an exception: \",mdx(\"inlineCode\",{parentName:\"p\"},`KeyError: \"['Lat'] not found in axis\"`),\". Why is that happening? Let's go step by step:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"On the first run, Streamlit runs \",mdx(\"inlineCode\",{parentName:\"li\"},\"load_data\"),\" and stores the resulting DataFrame in the cache. Since we're using \",mdx(\"inlineCode\",{parentName:\"li\"},\"st.cache_resource\"),\", it does \",mdx(\"strong\",{parentName:\"li\"},\"not\"),\" create a copy but stores the original DataFrame.\"),mdx(\"li\",{parentName:\"ul\"},\"Then we drop the column \",mdx(\"inlineCode\",{parentName:\"li\"},'\"Lat\"'),\" from the DataFrame. Note that this is dropping the column from the \",mdx(\"em\",{parentName:\"li\"},\"original\"),\" DataFrame stored in the cache. We are manipulating it!\"),mdx(\"li\",{parentName:\"ul\"},\"On the second run, Streamlit returns that exact same manipulated DataFrame from the cache. It does not have the column \",mdx(\"inlineCode\",{parentName:\"li\"},'\"Lat\"'),\" anymore! So our call to \",mdx(\"inlineCode\",{parentName:\"li\"},\"df.drop\"),\" results in an exception. Pandas cannot drop a column that doesn't exist.\")),mdx(\"p\",null,\"The copying behavior of \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_data\"),\" prevents this kind of mutation error. Mutations can only affect a specific copy and not the underlying object in the cache. The next rerun will get its own, unmutated copy of the DataFrame. You can try it yourself, just replace \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_resource\"),\" with \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_data\"),\" above, and you'll see that everything works.\"),mdx(\"p\",null,\"Because of this copying behavior,\\xA0\",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_data\"),\"\\xA0is the recommended way to cache data transforms and computations \\u2013 anything that returns a serializable object.\"),mdx(\"h4\",e({},{id:\"concurrency-issues\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#concurrency-issues\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Concurrency issues\"),mdx(\"p\",null,\"Now let's look at what can happen when multiple users concurrently mutate an object in the cache. Let's say you have a function that returns a list. Again, we are using \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_resource\"),\" to cache it so that we are not creating a copy:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`@st.cache_resource\ndef create_list():\n    l = [1, 2, 3]\n    return l\n\nl = create_list()\nfirst_list_value = l[0]\nl[0] = first_list_value + 1\n\nst.write(\"l[0] is:\", l[0])\n`)),mdx(\"p\",null,\"Let's say user A runs the app. They will see the following output:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`l[0] is: 2\n`)),mdx(\"p\",null,\"Let's say another user, B, visits the app right after. In contrast to user A, they will see the following output:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`l[0] is: 3\n`)),mdx(\"p\",null,\"Now, user A reruns the app immediately after user B. They will see the following output:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`l[0] is: 4\n`)),mdx(\"p\",null,\"What is happening here? Why are all outputs different?\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"When user A visits the app,\\xA0\",mdx(\"inlineCode\",{parentName:\"li\"},\"create_list()\"),\"\\xA0is called, and the list\\xA0\",mdx(\"inlineCode\",{parentName:\"li\"},\"[1, 2, 3]\"),\"\\xA0is stored in the cache. This list is then returned to user A. The first value of the list, \",mdx(\"inlineCode\",{parentName:\"li\"},\"1\"),\", is assigned to \",mdx(\"inlineCode\",{parentName:\"li\"},\"first_list_value\"),\" , and \",mdx(\"inlineCode\",{parentName:\"li\"},\"l[0]\"),\"\\xA0is changed to \",mdx(\"inlineCode\",{parentName:\"li\"},\"2\"),\".\"),mdx(\"li\",{parentName:\"ul\"},\"When user B visits the app,\\xA0\",mdx(\"inlineCode\",{parentName:\"li\"},\"create_list()\"),\"\\xA0returns the mutated list from the cache:\\xA0\",mdx(\"inlineCode\",{parentName:\"li\"},\"[2, 2, 3]\"),\". The first value of the list, \",mdx(\"inlineCode\",{parentName:\"li\"},\"2\"),\", is assigned to \",mdx(\"inlineCode\",{parentName:\"li\"},\"first_list_value\"),\" and \",mdx(\"inlineCode\",{parentName:\"li\"},\"l[0]\"),\"\\xA0is changed to \",mdx(\"inlineCode\",{parentName:\"li\"},\"3\"),\".\"),mdx(\"li\",{parentName:\"ul\"},\"When user A reruns the app,\\xA0\",mdx(\"inlineCode\",{parentName:\"li\"},\"create_list()\"),\"\\xA0returns the mutated list again:\\xA0\",mdx(\"inlineCode\",{parentName:\"li\"},\"[3, 2, 3]\"),\". The first value of the list, \",mdx(\"inlineCode\",{parentName:\"li\"},\"3\"),\", is assigned to \",mdx(\"inlineCode\",{parentName:\"li\"},\"first_list_value,\"),\" and \",mdx(\"inlineCode\",{parentName:\"li\"},\"l[0]\"),\"\\xA0is changed to 4.\")),mdx(\"p\",null,\"If you think about it, this makes sense. Users A and B use the same list object (the one stored in the cache). And since the list object is mutated, user A's change to the list object is also reflected in user B's app.\"),mdx(\"p\",null,\"This is why you must be careful about mutating objects cached with \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_resource\"),\", especially when multiple users access the app concurrently. If we had used\\xA0\",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_data\"),\"\\xA0instead of\\xA0\",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache_resource\"),\", the app would have copied the list object for each user, and the above example would have worked as expected \\u2013 users A and B would have both seen:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`l[0] is: 2\n`)),mdx(Note,{mdxType:\"Note\"},mdx(\"p\",null,\"This toy example might seem benign. But data corruption can be extremely dangerous! Imagine we had worked with the financial records of a large bank here. You surely don't want to wake up with less money on your account just because someone used the wrong caching decorator \\u{1F609}\")),mdx(\"h2\",e({},{id:\"migrating-from-stcache\"}),mdx(\"a\",e({parentName:\"h2\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#migrating-from-stcache\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Migrating from st.cache\"),mdx(\"p\",null,\"We introduced the caching commands described above in Streamlit 1.18.0. Before that, we had one catch-all command \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache\"),\". Using it was often confusing, resulted in weird exceptions, and was slow. That's why we replaced \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache\"),\" with the new commands in 1.18.0 (read more in this \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://blog.streamlit.io/introducing-two-new-caching-commands-to-replace-st-cache/\"}),\"blog post\"),\"). The new commands provide a more intuitive and efficient way to cache your data and resources and are intended to replace \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache\"),\" in all new development.\"),mdx(\"p\",null,\"If your app is still using \",mdx(\"inlineCode\",{parentName:\"p\"},\"st.cache\"),\", don't despair! Here are a few notes on migrating:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"st.cache\"),\" is deprecated. \\u2022 New versions of Streamlit will show a deprecation warning if your app uses it.\"),mdx(\"li\",{parentName:\"ul\"},\"We will not remove \",mdx(\"inlineCode\",{parentName:\"li\"},\"st.cache\"),\" soon, so you don't need to worry about your 2-year-old app breaking. But we encourage you to try the new commands going forward \\u2013 they will be way less annoying!\"),mdx(\"li\",{parentName:\"ul\"},\"Switching code to the new commands should be easy in most cases. To decide whether to use \",mdx(\"inlineCode\",{parentName:\"li\"},\"st.cache_data\"),\" or \",mdx(\"inlineCode\",{parentName:\"li\"},\"st.cache_resource\"),\", read \",mdx(\"a\",e({parentName:\"li\"},{href:\"#deciding-which-caching-decorator-to-use\"}),\"Deciding which caching decorator to use\"),\". Streamlit will also recognize common use cases and show hints right in the deprecation warnings.\"),mdx(\"li\",{parentName:\"ul\"},\"Most parameters from \",mdx(\"inlineCode\",{parentName:\"li\"},\"st.cache\"),\" are also present in the new commands, with a few exceptions:\",mdx(\"ul\",{parentName:\"li\"},mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"allow_output_mutation\"),\" does not exist anymore. You can safely delete it. Just make sure you use the right caching command for your use case.\"),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"suppress_st_warning\"),\" does not exist anymore. You can safely delete it. Cached functions can now contain Streamlit commands and will replay them. If you want to use widgets inside cached functions, set \",mdx(\"inlineCode\",{parentName:\"li\"},\"experimental_allow_widgets=True\"),\". See \",mdx(\"a\",e({parentName:\"li\"},{href:\"#using-streamlit-commands-in-cached-functions\"}),\"here\"),\".\"),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"hash_funcs\"),\" does not exist anymore. You can exclude parameters from caching (and being hashed) by prepending them with an underscore: \",mdx(\"inlineCode\",{parentName:\"li\"},\"_excluded_param\"),\". See \",mdx(\"a\",e({parentName:\"li\"},{href:\"#excluding-input-parameters\"}),\"here\"),\".\")))),mdx(\"p\",null,\"If you have any questions or issues during the migration process, please contact us on the \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://discuss.streamlit.io/\"}),\"forum\"),\", and we will be happy to assist you. \\u{1F388}\"))}MDXContent.isMDXComponent=!0;\n","scope":{"title":"Caching","slug":"/library/advanced-features/caching"}},"currMenuItem":{"name":"Caching","url":"/library/advanced-features/caching","isVersioned":false},"prevMenuItem":{"menu_key":"button-behavior-and-examples","name":"Button behavior and examples","depth":"2","children":[],"category":"Streamlit library / Advanced features/ Button behavior and examples","url":"/library/advanced-features/button-behavior-and-examples"},"nextMenuItem":{"menu_key":"command-line-options","name":"Command-line options","depth":"2","children":[],"category":"Streamlit library / Advanced features/ Command-line options","url":"/library/advanced-features/cli"}},"__N_SSG":true},"page":"/[...slug]","query":{"slug":["library","advanced-features","caching"]},"buildId":"t8wfB6M0Aybn18P6aNrje","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body>
<!-- Mirrored from docs.streamlit.io/library/advanced-features/caching by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 29 Aug 2023 12:31:13 GMT -->
</html>